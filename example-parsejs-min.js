/*

 JavaScript analysis tools based on JSParsec

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.

 This is a port of the WebBits library (BrownPLT.JavaScript):
 http://hackage.haskell.org/package/WebBits-2.0
 Copyright (c) 2007-2009 Arjun Guha, Claudiu Saftoiu, and Spiridon Eliopoulos

 ------------------------------------------------------------


 JSParsec - A parser combinator library for JavaScript

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.


 The initial implementation of some combinators,
 and the memoization technique is derived from:
 http://www.bluishcoder.co.nz/2007/10/javascript-parser-combinators.html

 Most functions should behave like their counterparts in Parsec 3:
 http://www.haskell.org/haskellwiki/Parsec

 ------------------------------------------------------------


 JSHaskell - Some Haskell language features for JavaScript

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.

 ------------------------------------------------------------

*/
(function(){(function(){function z(a,e){return ha[a]=e||{}}function Ya(a,e){for(var i=ha[a],l=0,s=e.length;l<s;++l){var G=ha[a+"_"+e[l]];for(var K in G)i[K]=G[K]}}function S(a){return ea.call(a)=="[object Array]"}function X(a){return a!==la}function J(a,e){return a===e}function fa(a,e){return a!==e}function lb(a,e){return a<e}function za(a,e){return a<=e}function D(a,e){return a>e}function va(a,e){return a>=e}function o(a){return-a}function N(a){return a===true?false:a===false?true:ra(N)}function Ka(a){var e=
a.constructor;if(e)return e;a=typeof a;return a=="string"?String:a=="number"?Number:a=="boolean"?Boolean:a=="function"?Function:la}function mb(a){function e(){var i=wa(arguments);return i.length>=(a._length===la?a.length:a._length)?a.apply(null,i):function(){return e.apply(null,i.concat(wa(arguments)))}}return e}function Za(a){return function(){return a}}function $a(a){var e=wa(arguments,1);return function(){return a.apply(null,e)}}function xb(){function a(e){return!e?[]:[[e.name||e._name||e,e.arguments]].concat(a(e.caller))}
return a(arguments.callee.caller)}function ra(a){a=(a instanceof Function?a.name||a._name:null)||a||"Unspecified error";var e=new Error(a);try{e.stackTrace=xb()}catch(i){}e.message=a;throw e;}function yb(a,e){for(var i in e)a[i]=e[i];return a}function Ha(a,e){if(e.indexOf)return e.indexOf(a);var i=e.length;if(!i)return-1;for(var l=0;l<i;l++)if(e[l]===a)return l;return-1}function zb(a,e){if(e.lastIndexOf)return e.lastIndexOf(a);var i=e.length;if(!i)return-1;for(i=i-1;i>-1;--i)if(e[i]===a)return i;
return-1}function V(a){if(a.sort)return a.sort();return wa(a).sort().join("")}function Ab(a,e){for(var i=[],l=0,s=e.length;l<s;++l)i[l]=a(e[l]);return i}function sb(a,e){for(var i=[],l=0,s=e.length;l<s;++l)a(e[l])&&i.push(e[l]);return i}function Bb(a,e){return function(){return a(e.apply(null,arguments))}}function ab(a,e){return function(i){var l=wa(arguments,1);l.unshift(e(i));return a.apply(null,l)}}function nb(a){return function(e,i){return a(i,e)}}function Kb(a,e){if(typeof a=="string"&&typeof e==
"string")return a+e;return[a].concat(e)}function Cb(a,e){if(typeof a=="string"&&typeof e=="string")return a+e;return a+e.join("")}function La(a){return!a.length}function bb(a,e){var i=e.constructor==Array;return a.constructor==Array?a.concat(i?e:e.split("")):a.concat(i?e.join(""):e)}function W(a,e){return(e.indexOf?e.indexOf(a):Ha(a,e))!=-1}function cb(a){return parseInt(a.join?a.join(""):a,16)}function Ma(a){return parseInt(a.join?a.join(""):a,8)}function db(a){a=parseInt(a,16);return isNaN(a)?ra(db):
a}function Y(a,e){return{indexOf:function(i){return i>=a&&i<=e?true:-1},toString:function(){return"range("+a+", "+e+")"}}}function Aa(a,e){function i(){try{var s=e;do a=a()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()();while(--s);setTimeout(i,1)}catch(G){}}if(!e||e==Infinity){try{for(;a=a()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()(););
}catch(l){}return a}i()}function Ra(a){return["l",a]}function E(a){return["r",a]}function tb(a){return["x",a]}function Db(a){if(a)if(!a._String){var e=ma[a];if(a._Op&&!e)return"l";return e&&(e.fixity[0]||"l")}}function Eb(a){if(a)if(!a._String){var e=ma[a];if(a._Op&&!e)return 9;return e&&(X(e.fixity[1])?e.fixity[1]:9)}}function eb(){}function fb(a,e,i){var l;if(a[e]._Op){delete a[e]._Op;l=a[e]}else l=ma[a[e]].func;l=l(a[e-1],a[e+1]);a.splice(e-1,3,l);return Q(a,i)}function Lb(a){if(typeof a=="string"){a=
new String(a);a._String=true;return a}else{a._Array=true;return a}}function Va(a){a._Op=true;return a}function Q(a,e){a=Ba(function(T){if(!T)return T;if(T._Array){delete T._Array;return T}return T.constructor==Array?Q(T,e):T.CallStream?T.resolve(e):T},a);if(e)a=Ba(function(T){return T instanceof eb?e:T},a);for(var i=[],l=[],s=0,G=a.length;s<G;++s){var K=a[s],ia=false;if(ma[K])ia=true;if(K&&K._String){ia=false;K=K.toString()}if(K&&K._Op)ia=true;if(!ia&&s!=G-1)i.push(K);else{s==G-1&&i.push(K);i=i.length>
1?i[0].apply(null,i.slice(1)):i[0];l.push(i);s!=G-1&&l.push(K);i=[]}}a=l;l=Ba(Db,a);G=Ba(Eb,a);K=ob(X,G).sort().pop();s=Ha(K,G);G=zb(K,G);return l[s]=="l"?fb(a,s,e):l[G]=="r"?fb(a,G,e):l[s]=="x"?fb(a,s,e):a[0]}function xa(a){return function(){function e(){return s.apply(null,arguments)}function i(){return(G?s:i.resolve()).apply(null,arguments)}var l=arguments,s,G;i.resolve=function(K){if(G)return s;s=Q(l,K||e);l=null;G=true;return s};i.CallStream=true;i.constructor=a;return i}}function ca(){return Q(wa(arguments))}
function B(a){this.scope=a}function Mb(a){return function(){function e(){return s.apply(null,arguments)}function i(K){if(G||K instanceof B)return(G?s:i.resolve()).apply(null,arguments);l.push(Q(arguments,e));return i}var l=[],s,G;l.push(Q(arguments,e));i.resolve=function(){if(G)return s;s=a.do_.apply(null,l);G=true;l=null;return s};i.CallStream=true;i.constructor=a._type;return i}}function Ca(){this.keys=[];this.values=[]}function sa(a,e){var i={};i._context=[];i._name=a;i._dict=new Ca;i.context=
function(){this._context=wa(arguments);delete i.context;return this};i.types=function(l){this._fnTypes=l;delete i.types;return this};i.impl=function(l){this._default=l;for(var s in i._fnTypes)(function(G,K){i[G]=K!==la&&K.constructor!=Array?(typeof l=="function"?l():l)[G]:function(){var ia=arguments,T;if(K===la||K===Sa)ra("There's no type signature for "+i._name+"."+G+", it can be accessed only by: getInstance("+i._name+", SomeType)."+G);var na,gb=ob(function(oa,Wa){Wa=K[Wa];if(na||Wa==Sa)return na=
true;oa=Ka(oa);if(Wa==e){T=T||oa;return T==oa}else return oa==Wa},ia);!na&&gb.length!=K.length-1&&ra("Type error in "+i._name+"."+G);(gb=i._dict.get(T))||ra("No "+i._name+" instance for "+(T.name||T._name));return gb[G].apply(null,ia)}})(s,i._fnTypes[s]);delete i.impl;return this};return i}function r(a,e,i){Ba(function(K){if(!K._dict.get(e))throw"No "+(K._name||"")+" instance for "+(e.name||e._name);},a._context);var l={};l._type=e;a._dict.put(e,l);i=typeof i=="function"?i(l):i||{};var s=a._default;
s=typeof s=="function"?s(l):s;for(var G in a._fnTypes)l[G]=i[G]||s[G];return l}function Na(a,e){return a._dict.get(e)}function H(a,e,i){return a._dict.get(Ka(i))[e]}function d(a,e){return e?e[a]:function(i){return i[a]}}function c(){}function j(){}function A(a){return function(){var e=[],i=this._recordset;if(i&&i.constructor!=Array){for(var l in i){var s=a?i[l].name||i[l]:this[l];if(!a&&s instanceof Function)s=s.constructor!=Function?s.constructor.name:"Function("+s.name+")";e.push(l+(a?" :: ":" = ")+
s)}i=replicate(this._dataConstructor.length+2," ").join("");e="{"+e.join("\n"+i+",")+"\n"+i+"}"}else{for(l=0;l in this;l++)e.push(a?i[l].name||i[l]:this[l]);e=e.join(" ")}return"("+this._dataConstructor+(e?" ":"")+e+")"}}function ba(a,e,i,l,s){ra("Type error: expecting "+a.name+" instead of "+e.name+" in the argument '"+i+"' of "+l+"."+s)}function P(a,e){function i(T,na){function gb(Vb,Ia){var k=Vb instanceof c,pa=new a,da,ta;pa.constructor=a;pa._recordset=oa&&na[0]||na;pa._dataConstructor=T;pa[T]=
true;if(k)for(var Da in Ia){k=Ia[Da];oa||ra("Records are not defined for "+l+"."+T);Da in Wa||ra("The accessor '"+Da+"' is not defined for "+l+"."+T);ta=Wa[Da];if(typeof ta!="string"){da=Ka(k);da!=ta&&ba(ta,da,Da,l,T)}pa[Da]=k;pa[hb[Da]]=k}else{Da=arguments;for(var ga=0,Oa=Da.length;ga<Oa;++ga){k=Da[ga];ta=na[ga];if(typeof ta!="string"){da=Ka(k);da!=ta&&ba(ta,da,ga,l,T)}pa[ga]=k;if(oa)pa[Fb[ga]]=k}}pa.update=function(qa){var Gb={};for(var ib in Wa)Gb[ib]=ib in qa?qa[ib]:this[ib];return gb(pb,Gb)};
return pa}var oa=na&&typeof na[0]=="object",Wa=oa&&na[0];if(oa){var qb=0,Ta,hb={},Fb={};for(Ta in Wa){var Hb=Ta.charAt(0);if(Hb=="_"||Hb==Hb.toUpperCase())throw l+"."+ia+"."+Ta+": record names can't start with underscore or uppercase letters";if(Ta in{update:1})throw l+"."+ia+"."+Ta+": record name is invalid";hb[Ta]=qb;Fb[qb]=Ta;qb++}}return gb}var l=a.name;if(a._constructors)throw"Type constructor has been already defined: '"+l+"'";a._constructors=e;a.prototype=new j;for(var s=0,G=e.length;s<G;++s){var K=
typeof e[s]!="object",ia=K?e[s]:e[s][0];if(ia in a)throw"The name of the data constructor ("+l+"."+ia+") is invalid!";a[ia]=K?i(ia)():i(ia,wa(e[s],1));if(!K)a[ia]._length=e[s].length-1}}var $=function(){return this}()||window,ha=$.NS||($.NS={}),la,ea={}.toString,Ea=[].slice,Fa=[].map,ub=[].filter;(function(){return this}).toString().indexOf("this");(function(){var a={9:1,d:1,b:1,0:1,a:1,c:1},e=[9,"d","b",0,"a","c"],i=0;for(var l in a)if(l!=e[i++])return false;return true})();$.global=$;$.namespace=
z;$.importSubmodules=Ya;$=function(a){return a};var jb=mb(function(a,e){return a(e)}),wa="a"[0]?function(a,e){return Ea.call(a,e||0)}:function(a,e){if(typeof a=="string"){a=a.split("");if(!e)return a}return Ea.call(a,e||0)},Ba=Fa?function(a,e){return Fa.call(e,a)}:function(a,e){for(var i=[],l=0,s=e.length;l<s;++l)i[l]=a(e[l],l,e);return i},ob=ub?function(a,e){return ub.call(e,a)}:function(a,e){for(var i=[],l=0,s=e.length;l<s;++l)a(e[l],l,e)&&i.push(e[l]);return i};z("Haskell_Main",{curry:mb,const_:Za,
isArray:S,isDefined:X,slice:wa,map:Ab,imap:Ba,filter:sb,ifilter:ob,indexOf:Ha,lastIndexOf:zb,isort:V,compose:Bb,compose1:ab,call:jb,id:$,flip:nb,cons:Kb,consJoin:Cb,negate:o,null_:La,elem:W,digitToInt:db,range:Y,extend:yb,namespace:z,toInteger:parseInt,fromInteger:$,fromIntegral:$,readHex:cb,readOct:Ma,chr:String.fromCharCode,round:Math.round,typeOf:Ka,strictEq:J,strictNe:fa,lt:lb,le:za,gt:D,ge:va,not:N,negate:o,evalThunks:Aa});var ma={$:{func:jb,fixity:E(0)},".":{func:ab,fixity:E(9)},":":{func:Kb,
fixity:E(5)},"++":{func:bb,fixity:E(5)}};$=new eb;z("Haskell_Expression",{operators:ma,infix:tb,infixl:Ra,infixr:E,op:Va,no:Lb,resolve:Q,recurse:$,Recurse:eb,exl:xa,exs:ca});z("Haskell_Do",{createDo:Mb,Scope:B});Ca.prototype.put=function(a,e){this.keys.push(a);this.values.push(e)};Ca.prototype.get=function(a){a=Ha(a,this.keys);if(a!=-1)return this.values[a]};var Sa={};z("Haskell_TypeClass",{typeclass:sa,VARARG:Sa,instance:r,getInstance:Na,asTypeOf:H});var pb=new c;j.prototype.toString=A();j.prototype.dataConstructorToString=
A(true);j.prototype.update=$a(ra);z("Haskell_DataType",{data:P,ADT:j,record:pb,accessor:d,accessors:{}})})();(function(){namespace("Haskell");importSubmodules("Haskell",["Main","DataType","TypeClass","Expression","Do"])})();(function(){function z(d){d.constructor=sa["Tuple"+d.length];return d}function Ya(){}function S(){}function X(){}function J(){}function fa(d){var c=stringAsArray||typeof arr!="string"?d[0]:d.charAt(0);d=cb(d,1);var j=[c,d];j.head=c;j.tail=d;j.constructor=sa.Tuple2;return j}function lb(d,
c){var j=c.length;if(!j)return S.Nothing;for(var A=B(r,E(c[0])),ba=0;ba<j;++ba)if(A.eq(c[ba],d))return S.Just(ba);return S.Nothing}function za(d,c){var j=c.length;if(!j)return S.Nothing;for(var A=0;A<j;++A)if(c[A][0]===d)return S.Just(c[A][1]);return S.Nothing}function D(d){function c(j,A){j=Na.compare(j,A);return j.LT?-1:j.GT?1:j.EQ?0:error(D)}if(d.sort)return d.sort(c);return cb(d).sort(c).join("")}function va(d){function c(j,A){var ba=j.constructor==Array;x=ba?j[0]:j.charAt(0);xs=ba?j.slice(1):
j.substr(1);return!j.length?[]:Aa(x,A)?c(xs,A):Y(x,c(xs,Y(x,A)))}return c(d,[])}function o(d,c,j){if(j.Nothing)return d;if(j.Just)return c(j[0])}function N(d,c){return d===c?X.EQ:d<=c?X.LT:X.GT}function Ka(d,c){if(c.length)if(d(c[0])){d=Ka(d,cb(c,1));c=[Y(c[0],d[0]),d[1]]}else c=[[],c];else c=[c,c];c.constructor=sa.Tuple2;return c}function mb(d){return d[0]}function Za(d){return d[1]}function $a(d){return function(c){return d(c[0],c[1])}}function xb(d,c,j){return d(j)?j:xb(d,c,c(j))}function ra(d){return function(){return rhs(ra(d))}}
function yb(d){return function(c){return c(c)}(function(c){return function(){return d(c(c)).apply(null,arguments)}})}function Ha(d){return/^\s$/.test(d)}function zb(d){return d.toUpperCase()==d}function V(d){return d.toLowerCase()==d}function Ab(d){return/^\w$/.test(d)}function sb(d){return/^\w$/.test(d)&&/^\D$/.test(d)}function Bb(d){return/^\d$/.test(d)}function ab(d){return/^[0-9A-Fa-f]$/.test(d)}function nb(d){return/^[0-7]$/.test(d)}function Kb(d,c,j){for(var A=0,ba=j.length;A<ba;++A)c=d(c,j[A]);
return c}function Cb(d,c,j){for(var A=j.length-1;A>-1;--A)c=d(j[A],c);return c}function La(d,c){for(var j=[],A=0,ba=Math.min(d.length,c.length);A<ba;++A)j[A]=[d[A],c[A]];return j}function bb(d,c){for(var j=[],A=0;A<d;++A)j[A]=c;return j}var W=NS.Haskell.const_,cb=NS.Haskell.slice,Ma=NS.Haskell.map,db=NS.Haskell.imap,Y=NS.Haskell.cons,Aa=NS.Haskell.elem,Ra=NS.Haskell.namespace,E=NS.Haskell.typeOf,tb=NS.Haskell.strictEq,Db=NS.Haskell.strictNe,Eb=NS.Haskell.lt,eb=NS.Haskell.le,fb=NS.Haskell.gt,Lb=NS.Haskell.ge,
Va=NS.Haskell.data,Q=NS.Haskell.typeclass,xa=NS.Haskell.VARARG,ca=NS.Haskell.instance,B=NS.Haskell.getInstance,Mb=NS.Haskell.createDo,Ca=NS.Haskell.Scope,sa={};db(function(d){var c="Tuple"+d;sa[c]=function(){};sa[c]._name=c;sa["tuple"+d]=function(j){j.constructor=sa[c];return j}},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]);sa.tuple=z;Va(Ya,["Unit"]);Va(S,[["Just","a"],"Nothing"]);Va(X,["LT","EQ","GT"]);Va(J,[["Left","a"],["Right","b"]]);var r=Q("Eq","a").types({eq:["a","a",Boolean],ne:["a","a",Boolean]}).impl(function(d){return{eq:function(c,
j){return!d.ne(c,j)},ne:function(c,j){return!d.eq(c,j)}}});ca(r,Number,{eq:tb,ne:Db});ca(r,String,{eq:tb,ne:Db});ca(r,Boolean,{eq:tb,ne:Db});ca(r,RegExp,{eq:function(d,c){return d.source===c.source&&d.global===c.global&&d.ignoreCase===c.ignoreCase&&d.multiline===c.multiline}});ca(r,Array,{eq:function(d,c){var j=d.length;if(j!=c.length)return false;for(var A=0;A<j;++A)if(!r.eq(d[A],c[A]))return false;return true}});ca(r,Object,{eq:function(d,c){var j,A={};for(j in d)A[j]=true;for(j in c)A[j]=true;
for(j in A)if(!r.eq(d[j],c[j]))return false;return true}});ca(r,X,{eq:function(d,c){return d.EQ&&c.EQ?true:d.LT&&c.LT?true:d.GT&&c.GT?true:false}});var Na=Q("Ord","a").context(r).types({compare:["a","a",X],"<":["a","a",Boolean],"<=":["a","a",Boolean],">":["a","a",Boolean],">=":["a","a",Boolean],max:["a","a","a"],min:["a","a","a"]}).impl(function(d){return{compare:function(c,j){return r.eq(c,j)?X.EQ:d["<="](c,j)?X.LT:X.GT},"<":function(c,j){return d.compare(c,j).LT?true:false},"<=":function(c,j){return d.compare(c,
j).GT?false:true},">":function(c,j){return d.compare(c,j).GT?true:false},">=":function(c,j){return d.compare(c,j).LT?false:true},max:function(c,j){return d["<="](c,j)?j:c},min:function(c,j){return d["<="](c,j)?c:j}}});ca(Na,Boolean,{compare:function(d,c){return d===true&&c===false?X.LT:d===false&&c===true?X.GT:X.EQ}});ca(Na,Number,{compare:function(d,c){return d===c?X.EQ:d<=c?X.LT:X.GT},"<":Eb,"<=":eb,">":fb,">=":Lb,max:function(d,c){return d<=c?c:d},min:function(d,c){return d<=c?d:c}});ca(Na,X,{"<=":function(d,
c){return d.LT?true:c.LT?false:d.EQ?true:c.EQ?false:d.GT&&c.GT?true:error()}});db=Q("Functor","f").types({fmap:[Function,"f","f"],"<$":["a","f","f"]}).impl(function(d){return{"<$":function(c,j){return d.fmap(W(c),j)}}});xa=Q("Monad","m").types({">>=":["m",Function,"m"],">>":["m","m","m"],return_:["a","m"],fail:[String,"m"],do_:xa,do$:xa,run:xa}).impl(function(d){return{">>":function(c,j){c=d[">>="](c,W(j));c.constructor=d._type;return c},fail:function(c){return error(c)},do_:function(){function c(ba){for(var P=
new Ca(ba),$=1,ha=j.length,la=j[0];$<ha;++$)la=A(la,j[$]);$=_slice.call(arguments,1);$.unshift(P);return la.apply(null,$)}var j=arguments,A=d[">>"];c.constructor=d._type;return c},run:function(c){var j=cb(arguments,1);j.unshift(new Ca);return c.apply(null,j)},do$:Mb(d)}});var H=Q("Show","a").types({show:["a",String]}).impl({show:function(d){return d.toString()}});ca(H,Number);ca(H,Boolean);ca(H,RegExp);ca(H,Function,{show:function(d){var c=d.name||d._name||"\u03bb";if(d.constructor)return c+" :: "+
d.constructor.name;d=(d=d.toString().match(/\([^\)]*\)/))&&d[0]||"";return c+d}});ca(H,String,{show:function(d){return'"'+d.toString()+'"'}});ca(H,Array,{show:function(d){return typeof d[0]==String?'"'+d.join("")+'"':"["+Ma(H.show,d).join(", ")+"]"}});ca(H,Object,{show:function(d){var c=[];for(var j in d)c.push("  "+j+": "+H.show(d[j]));return"{\n"+d.join(",\n")+"\n}"}});Ra("Prelude",{Unit:Ya,Tuple:sa,Maybe:S,Ordering:X,Either:J,Eq:r,Ord:Na,Functor:db,Monad:xa,Show:H,foldl:Kb,foldr:Cb,zip:La,replicate:bb,
sort:D,nub:va,maybe:o,lookup:za,span:Ka,elemIndex:lb,uncons:fa,compare:N,fst:mb,snd:Za,uncurry:$a,until:xb,fix:yb,fix_:ra,isSpace:Ha,isUpper:zb,isLower:V,isAlpha:sb,isAlphaNum:Ab,isDigit:Bb,isHexDigit:ab,isOctDigit:nb})})();(function(){function z(b,f){this.input=b;this.index=f||0;this.length=b.length-this.index;this.cache={};return this}function Ya(b){return new z(b)}function S(b){return function(f,h,q){return q({ast:null,success:false,expecting:{unexpected:b}})}}function X(b){return function(f,h,
q){return q({success:false,expecting:b})}}function J(b,f,h){return h({success:false})}function fa(b){return typeof b=="string"?R(b):A(b)?oa(b):b}function lb(b,f,h,q,u){var v=f instanceof z?f:Ya(f);i(function(){return b(new Ta,v,function(t){t.state=v;delete t.index;delete t.length;if(t.success){delete t.error;delete t.expecting}else{t.error=za(t.expecting,t.state);q&&q(t.error)}h(t)})},u)}function za(b,f,h,q){h=h===undefined?f.index:h;if(typeof b=="string"){var u=f.input.split("\n"),v=u.length,t=f.input.substr(h).split("\n").length;
v=v-t+1;u=h-u.splice(0,v-1).join("\n").length;f=q||f.input.substr(h,b.length).substr(0,6);return'Unexpected "'+(f.length?f:"end of input")+(q?"":'", expecting "'+b)+'" at line '+v+" char "+u}if(A(b)){b=P(function(y){return typeof y=="object"?y.expecting:y},b);return za(b.join('" or "'),f)}else if(typeof b=="object")return za(b.expecting,f,b.at,b.unexpected)}function D(){}function va(b,f){return function(h,q,u){return function(){return b(h,q,function(v){return v.success?function(){return f(v.ast)(h,
q,u)}:u(v)})}}}function o(b,f){if(b=="scope")throw"Can't use 'scope' as an identifier!";return function(h,q,u){return function(){return f(h,q,function(v){if(v.success)h[b]=v.ast;return u(v)})}}}function N(b,f){f&&ba(arguments);return function(h,q,u){return function(){return function(){var v;if(typeof b=="string"){if(!(b in h))throw'Not in scope: "'+b+'"';v=h[b]}else v=b(h);return u({ast:v,success:true})}}}}function Ka(b){var f=ba(arguments,1);return function(h){return b.apply(null,P(function(q){return h[q]},
f))}}function mb(b,f,h){return h({ast:f.index,success:true})}function Za(b){var f=typeof b;return function(h,q,u){q.scrollTo(f=="string"?h[b]:b);return u({success:true})}}function $a(b){return function(f,h,q){return q({ast:b,success:true})}}function xb(b,f){return C(o("a",b),o("b",f),N(function(h){return h.a(h.b)}))}function ra(b,f){return C(o("x1",f),Pa(b,"x1"))}function yb(b,f,h){return C(o("x1",f),o("x2",h),Pa(b,"x1","x2"))}function Ha(b,f,h,q){return C(o("x1",f),o("x2",h),o("x3",q),Pa(b,"x1",
"x2","x3"))}function zb(b,f){return C(o("a",b),f,N("a"))}function V(b,f){function h(q,u,v){return function(){return b(q,u,function(t){function y(O){var aa=O.expecting;if(aa)if(aa.constructor==Array)U=U.concat(aa);else U.push(aa);O.expecting=O.success?ja:U}var U=[];y(t);return t.ast!==ja?function(){return v(t)}:function(){return f(q,u,function(O){y(O);return v(O)})}})}}h.constructor=D;return h}function Ab(){var b=P(fa,arguments);return function(f,h,q){for(var u=1,v=b.length,t=b[0];u<v;++u)t=V(t,b[u]);
return t(f,h,q)}}function sb(b){return function(f,h,q){function u(U){return function(O,aa,Qa){return function(){return U(O,aa,function(ua){v++;if(!ua.success)return Qa(ua);ua.ast!==ja&&t.push(ua.ast);return v<y?u(b[v])(O,aa,Qa):Qa(ua)})}}}var v=0,t=[],y=b.length;return function(){return u(b[v])(f,h,function(U){var O=U.success;return q({ast:t,success:O,expecting:O?ja:U.expecting})})}}}function Bb(b){return function(f){return function(h,q,u){function v(U){return function(O,aa,Qa){return function(){return U(O,
aa,function(ua){if(!ua.success)return Qa(ua);t=true;ua.ast!==ja&&y.push(ua.ast);return v(U)(O,aa,Qa)})}}}var t=false,y=[];return function(){return v(f)(h,q,function(U){var O=!b||t&&b;return u({ast:O?y:ja,success:O,expecting:O?ja:U.expecting})})}}}}function ab(b){return function(f){var h=ic++,q=function(u,v,t){u=v.index;var y=v.getCached(h);if(y!==ja)return t(y);y=b(f,v,u);v.putCached(h,u,y);return t(y)};q.constructor=D;return q}}function nb(b){return function(f,h){var q=ic++,u=function(v,t,y){var U=
t.index,O=t.getCached(q);if(O!==ja)return y(O);return function(){return f(v,t,function(aa){aa=b(h,aa,t,U);t.putCached(q,U,aa);return y(aa)})}};u.constructor=D;return u}}function Kb(b){return function(f,h,q){return b(f)(f,h,q)}}function Cb(b){function f(h,q){return C(o("x",h),o("xs",q),N(Ka(Fa,"x","xs")))}return Ia(f,L([]),b)}function La(b){return Ia(V,Pb,b)}function bb(b,f){return V(f,L(b))}function W(b){return bb(hb.Nothing,ra(hb.Just,b))}function cb(b){return V(C(b,L(null)),L(null))}function Ma(b,
f,h){return C(b,o("x",h),f,N("x"))}function db(b){return C(b,w(b))}function Y(b,f){return V(Aa(b,f),L([]))}function Aa(b,f){return C(o("x",b),o("xs",Ib(C(f,b))),Pa(Fa,"x","xs"))}function Ra(b,f){return C(o("x",b),V(C(f,o("xs",function(h,q,u){return E(b,f)(h,q,u)}),N(function(h){return Fa(h.scope.x,h.xs)})),N(function(h){return[h.x]})))}function E(b,f){return V(Ra(b,f),L([]))}function tb(b,f){return g(C(o("x",b),f,N("x")))}function Db(b,f){return Ib(C(o("x",b),f,N("x")))}function Eb(b,f){return b<=
0?L([]):Cb(pa(b,f))}function eb(b,f,h){return V(Va(b,f),L(h))}function fb(b,f,h){return V(Lb(b,f),L(h))}function Lb(b,f){function h(q){var u=C(o("f",f),o("y",b),function(v,t,y){return h(v.f(q,v.y))(v,t,y)});return V(u,L(q))}return va(b,h)}function Va(b,f){function h(u){var v=C(o("f",f),o("y",q),N(function(t){return t.f(u,t.y)}));return V(v,L(u))}var q=va(b,h);return q}function Q(b,f,h){b=f.at(0);if(b.length){f.scroll(1);return h(make_result(b))}return h(_fail("anyToken"))}function xa(b,f,h){return h(make_result(ja,
!f.length,f.length?"end of input":ja))}function ca(b){return n(V(va(n(b),S),L(null)))}function B(b,f){function h(u,v,t){return q(u,v,t)}var q=V(C(f,L([])),C(o("x",b),o("xs",h),Pa(Fa,"x","xs")));return q}function Mb(b){return C(o("state",jc),o("x",b),kc("state"),N("x"))}function Ca(){}function sa(){}function r(b,f){function h(t,y){return function(U,O,aa){return t(U[y])(U,O,aa)}}function q(t,y){var U=t[0],O=y[0],aa=y[1],Qa=y[2],ua=y[3];y=y[4];if(t.Infix){var Ua=t[1];if(Ua.AssocNone)return[O,aa,Fa(U,
Qa),ua,y];if(Ua.AssocLeft)return[O,Fa(U,aa),Qa,ua,y];if(Ua.AssocRight)return[Fa(U,O),aa,Qa,ua,y]}if(t.Prefix)return[O,aa,Qa,Fa(U,ua),y];if(t.Postfix)return[O,aa,Qa,ua,Fa(U,y)]}function u(t,y){return n(C(y,lc("ambiguous use of a "+t+" associative operator")))}function v(t,y){function U(Ja){return I(M("f","<-",mc)("y","<-",M("z","<-",Wb)(h,O,"z"))(N,function(rb){return rb.f(Ja,rb.y)}),"<|>",Zb,"<|>",$b)}function O(Ja){return V(U(Ja),L(Ja))}function aa(Ja){return I(M("f","<-",nc)("y","<-",Wb)(function(rb,
oc,rc){return Qa(rb.f(Ja,rb.y))(rb,oc,rc)}),"<|>",ac,"<|>",$b)}function Qa(Ja){return V(aa(Ja),L(Ja))}function ua(Ja){return M("f","<-",bc)("y","<-",Wb)(ac,"<|>",Zb,"<|>",$b,"<|>",N,function(rb){return rb.f(Ja,rb.y)})}var Ua=Ia(q,[[],[],[],[],[]],y),sc=Ua[1],tc=Ua[2],Qb=Ua[3];y=Ua[4];var mc=La(Ua[0]),nc=La(sc),bc=La(tc);Ua=Ga(La(Qb),"");y=Ga(La(y),"");var ac=u("right",mc),Zb=u("left",nc),$b=u("non",bc);y=V(y,L(ea));Ua=V(Ua,L(ea));var Wb=M("pre","<-",Ua)("x","<-",t)("post","<-",y)(N,function(Ja){return Ja.post(Ja.pre(Ja.x))});
return M("x","<-",Wb)(h,U,"x","<|>",h,aa,"x","<|>",h,ua,"x","<|>",N,"x","<?>","operator").resolve()}return Vb(v,f,b)}function Na(){}function H(){}function d(b){function f(m){return h(R(m))}function h(m){return C(o("x",m),Fc,N("x"))}function q(m,Z,ka){return Gc(m,Z,ka)}function u(m,Z,ka){return Hc(m,Z,ka)}function v(m,Z,ka){return uc(m,Z,ka)}function t(m){return Ma(f("("),f(")"),m)}function y(m){return Ma(f("{"),f("}"),m)}function U(m){return Ma(f("<"),f(">"),m)}function O(m){return Ma(f("["),f("]"),
m)}function aa(m){return Y(m,vc)}function Qa(m){return Y(m,wc)}function ua(m){return Aa(m,vc)}function Ua(m){return Aa(m,wc)}function sc(m){return C(p(m[0]),L(m[1]))}function tc(m){return n(C(R(m[0]),L(m[1])))}function Qb(m,Z){return M("digits","<-",g,Z)(N,function(ka){return Vb(function(Xa,cc){return m*Xa+pb(ob(cc))},0,ka.digits)})}function mc(m,Z,ka){return Rb(m,Z,ka)}function nc(m,Z){return(Z+e(ob(m)))/10}function bc(m){return m<0?1/bc(-m):a(Math.pow(10,m))}function ac(m){return I(M("fract","<-",
Nc)("expo","<-",bb,1,Ic)(N,function(Z){return a(m+Z.fract)*Z.expo}),"<|>",M("expo","<-",Ic)(N,function(Z){return a(m)*Z.expo}))}function Zb(m){return M("f","<-",ac,m)(Pa,Fb.Right,"f")}function $b(m){return I(h,"$",n,M(R(m))(ca,b.opLetter,"<?>","end of "+m))}function Wb(m){return oc($(b.reservedOpNames),m)}function Ja(m){function Z(Xa){return!Xa.length?L(null):C(Ga(ka(Xa[0]),""+m),Z(ba(Xa,1)))}function ka(Xa){return Gb(Xa)?V(p(Xa.toLowerCase()),p(Xa.toUpperCase())):p(Xa)}return b.caseSensitive?R(m):
C(Z(m),L(m))}function rb(m){return I(h,"$",n,M(Ja(m))(ca,b.identLetter,"<?>","end of "+m))}function oc(m,Z){function ka(Xa){if(!Xa.length)return false;var cc=Da(Xa[0],Z);return cc.LT?ka(ba(Xa,1)):cc.EQ?true:cc.GT?false:null}return ka(m)}function rc(m){m=b.caseSensitive?m:m.toLowerCase();return oc(Oc,m)}if(!b.LanguageDef)throw"Type error: unexpected '"+b.constructor.name+"', expecting 'GenLanguageDef.LanguageDef'";var Xb=db(F(ga)),pc=M(n(R(b.commentLine)))(w,F(function(m){return m!="\n"}))(L,null),
ya=da(ba(b.commentEnd+b.commentStart)),Gc=I(C(n(R(b.commentEnd)),L(null)),"<|>",C(db(xc(ya)),q),"<|>",C(vb(ya),q),"<?>","end of comment"),Hc=I(C(n(R(b.commentEnd)),L(null)),"<|>",C(v,u),"<|>",C(db(xc(ya)),u),"<|>",C(vb(ya),u),"<?>","end of comment");ya=b.nestedComments?Hc:Gc;var uc=C(n(R(b.commentStart)),ya);ya=wa(b.commentLine);var wb=wa(b.commentStart),Fc=oa(ya&&wb?[w,[Xb,"<?>",""]]:ya?[w,[Xb,"<|>",uc,"<?>",""]]:wb?[w,[Xb,"<|>",pc,"<?>",""]]:[w,[Xb,"<|>",pc,"<|>",uc,"<?>",""]]),wc=f(";"),vc=f(",");
Xb=f(".");pc=f(":");ya=k(ba("abfnrtv\\\"'"),ba("a\u0008\u000c\n\r\t\u000b\\\"'"));wb=k(["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","SUB","ESC","DEL"].concat(["BS","HT","LF","VT","FF","CR","SO","SI","EM","FS","GS","RS","US","SP"]),["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","SUB","ESC","DEL"].concat(["BS","HT","LF","VT","FF","CR","SO","SI","EM","FS","GS","RS","US","SP"]));ya=La(P(sc,
ya));var Jb=La(P(tc,wb));wb=F(function(m){return m!='"'&&m!="\\"&&m>"\u0016"});var Sb=p("&"),dc=M(g,yc)(p("\\"),"<?>","end of string gap"),Tb=M("code","<-",mc,"<|>",C(p("o"),Qb(8,zc)),"<|>",C(p("x"),Qb(16,Ac)))(N(function(m){return toEnum(a(m.code))})),Nb=M(p("^"))("code","<-",Jc)(N(function(m){return toEnum(fromEnum(m.code)-fromEnum("A"))}));Jb=I(ya,"<|>",Tb,"<|>",Jb,"<|>",Nb,"<?>","escape code");ya=C(p("\\"),Jb);Tb=F(function(m){return m!="'"&&m!="\\"&&m>"\u0016"});ya=I(Tb,"<|>",ya,"<?>","literal character");
ya=I(h,[Ma,p("'"),[p("'"),"<?>","end of character"],ya],"<?>","character");Sb=M(p("\\"))(C(dc,L(hb.Nothing)),"<|>",C(Sb,L(hb.Nothing)),"<|>",M("esc","<-",Jb)(Pa,hb.Just,"esc"));wb=I(M("c","<-",wb)(Pa,hb.Just,"c"),"<|>",Sb,"<?>","string character");wb=I(h,[M("str","<-",Ma,p('"'),[p('"'),"<?>","end of string"],[Ib,wb])(N,function(m){return Ia(c(ta)(ea,c(Fa)),"",m.str)}),"<?>","literal string"]);var Rb=Qb(10,Bc);Sb=M(vb,"xX")(Qb,16,Ac);dc=M(vb,"oO")(Qb,8,zc);var Nc=I(M(p("."))("digits","<-",g,Bc,"<?>",
"fraction")(N,function(m){return Ia(nc,0,m.digits)}),"<?>","fraction");Jb=I([p("-"),">>",L,jb],"<|>",[p("+"),">>",L,ea],"<|>",L,ea);var Ic=I(M(vb,"eE")("f","<-",Jb)("e","<-",Rb,"<?>","exponent")(Pa,bc,"f","e"),"<?>","exponent");Tb=M("n","<-",Rb)(function(m,Z,ka){return ac(m.n)(m,Z,ka)});Nb=M("n","<-",Rb)(function(m,Z,ka){return bb(Fb.Left(m.n),Zb(m.n))(m,Z,ka)});var Ob=I(M("n","<-",Sb,"<|>",dc)(Pa,Fb.Left,"n"),"<|>",Nb,"<|>",Zb(0),"<|>",L,Fb.Left(0));Nb=I(C(p("0"),Ob),"<|>",Nb);Ob=I(M(p,"0")(Sb,"<|>",
dc,"<|>",Rb,"<|>",L,0),"<?>","");Ob=V(Ob,Rb);var ec=M("f","<-",h,Jb)("n","<-",Ob)(N,function(m){return m.f(m.n)});Jb=I(h,Nb,"<?>","number").resolve();Tb=I(h,Tb,"<?>","float").resolve();Nb=I(h,ec,"<?>","integer").resolve();Ob=I(h,Ob,"<?>","natural").resolve();ec=I(M("c","<-",b.opStart)("cs","<-",Ib,b.opLetter)(Pa,ub,"c","cs"),"<?>","operator");ec=I(h,"$",n,M("name","<-",ec)(function(m,Z,ka){return(Wb(m.name)?S("reserved operator "+m.name):L(m.name))(m,Z,ka)}));var Cc=I(M("c","<-",b.identStart)("cs",
"<-",Ib,b.identLetter)(Pa,ub,"c","cs"),"<?>","identifier");Cc=I(h,"$",n,M("name","<-",Cc)(function(m,Z,ka){return(rc(m.name)?S("reserved word "+m.name):L(m.name))(m,Z,ka)}));var Kc=$(b.reservedNames),Oc=b.caseSensitive?Kc:P(function(m){return m.toLowerCase()},Kc);return H.TokenParser(s,{identifier:Cc,reserved:rb,operator:ec,reservedOp:$b,charLiteral:ya,stringLiteral:wb,natural:Ob,integer:Nb,float_:Tb,naturalOrFloat:Jb,decimal:Rb,hexadecimal:Sb,octal:dc,symbol:f,lexeme:h,whiteSpace:Fc,parens:t,braces:y,
angles:U,brackets:O,squares:O,semi:wc,comma:vc,colon:pc,dot:Xb,semiSep:Qa,semiSep1:Ua,commaSep:aa,commaSep1:ua})}var c=NS.Haskell.curry,j=NS.Haskell.const_,A=NS.Haskell.isArray,ba=NS.Haskell.slice,P=NS.Haskell.map,$=NS.Haskell.isort,ha=NS.Haskell.compose,la=NS.Haskell.call,ea=NS.Haskell.id,Ea=NS.Haskell.flip,Fa=NS.Haskell.cons,ub=NS.Haskell.consJoin,jb=NS.Haskell.negate,wa=NS.Haskell.null_,Ba=NS.Haskell.elem,ob=NS.Haskell.digitToInt,ma=NS.Haskell.extend,Sa=NS.Haskell.namespace,pb=NS.Haskell.toInteger,
a=NS.Haskell.fromInteger,e=NS.Haskell.fromIntegral,i=NS.Haskell.evalThunks,l=NS.Haskell.data,s=NS.Haskell.record,G=NS.Haskell.instance,K=NS.Haskell.getInstance,ia=NS.Haskell.operators,T=NS.Haskell.infix,na=NS.Haskell.infixl,gb=NS.Haskell.infixr,oa=NS.Haskell.resolve,Wa=NS.Haskell.exl,qb=NS.Haskell.exs,Ta=NS.Haskell.Scope,hb=NS.Prelude.Maybe,Fb=NS.Prelude.Either,Hb=NS.Prelude.Monad,Vb=NS.Prelude.foldl,Ia=NS.Prelude.foldr,k=NS.Prelude.zip,pa=NS.Prelude.replicate,da=NS.Prelude.nub,ta=NS.Prelude.maybe,
Da=NS.Prelude.compare,ga=NS.Prelude.isSpace,Oa=NS.Prelude.isUpper,qa=NS.Prelude.isLower,Gb=NS.Prelude.isAlpha,ib=NS.Prelude.isAlphaNum,kb=NS.Prelude.isDigit,Ub=NS.Prelude.isHexDigit,fc=NS.Prelude.isOctDigit,ja;z.prototype={memoize:false,scrollTo:function(b){this.index=b;this.length=this.input.length-b;return this},scroll:function(b){this.index+=b;this.length-=b;return this},dropped:0,at:function(b){return this.input.charAt(this.index+b)},substring:function(b,f){return this.input.substring(b+this.index,
(f||this.length)+this.index)},substr:function(b,f){return this.input.substring(b+this.index,f||this.length)},toString:function(){var b=this.substring(0);return"PS at "+this.index+" "+(b.length?'"'+b+'"':"Empty")},getCached:function(b){if(this.memoize)if(b=this.cache[b])if(b=b[this.index]){this.index=b.index;this.length=b.length;return b}},putCached:function(b,f,h){if(!this.memoize)return false;h.index=this.index;h.length=this.length;var q=this.cache[b];q||(q=this.cache[b]={});q[f]=h},sourceLine:function(b){return(b=
this.input.substring(0,b).match(/(\r\n)|\r|\n/g))?b.length:0}};var lc=X,Pb=J,Dc=Pb,ic=0,Yb=function(b,f){function h(q,u,v){return function(){return b(q,u,function(t){return t.success?f(q,u,v):v(t)})}}h.constructor=D;return h},C=function(){function b(h,q,u){h=new Ta(h);for(var v=1,t=f.length,y=f[0];v<t;++v)y=Yb(y,f[v]);return y(h,q,u)}var f=P(fa,arguments);b.constructor=D;return b},Pa=ha(N,Ka),jc=mb,kc=Za,L=$a,gc=L;ha=ra;var hc=Yb,qc=V,Ib=Bb(false),g=Bb(true),n=nb(function(b,f,h,q){if(f.success)return f;
h.scrollTo(q);return{ast:ja,success:false,expecting:f.expecting}}),w=function(b){return nb(function(f,h){return{ast:ja,success:h.success,expecting:h.expecting}})(Ib(b),null)},p=ab(function(b,f){if(f.length>0&&f.at(0)==b){f.scroll(1);return{ast:b,success:true}}return{success:false,expecting:b}}),F=ab(function(b,f){var h=f.at(0);if(f.length>0&&b(h)){f.scroll(1);return{ast:h,success:true}}return{success:false,expecting:h}}),R=function(b){return nb(function(f,h,q,u){f=h.ast.join("");return{ast:f.length?
f:ja,success:h.success,expecting:h.success?ja:{at:u,expecting:b}}})(sb(P(p,b)),null)},Ga=nb(function(b,f,h,q){return f.success?f:{ast:f.ast,success:false,expecting:{at:q,expecting:b}}}),Ec=ab(function(b,f){if(typeof b=="string")if(f.substring(0,b.length)==b){f.scroll(b.length);return{ast:b,success:true}}else return{success:false,expecting:b};else if(b.exec){var h=new RegExp("^"+b.source),q=f.substring(0);h=(h=(h=h.exec(q))&&h[0])&&h.length;q=q.substr(0,h);if(h){f.scroll(h);return{ast:q,success:true}}else return{success:false,
expecting:b.source}}});ma(ia,{"<-":{func:o,fixity:gb(-1)},">>=":{func:va,fixity:na(1)},"=<<":{func:Ea(va),fixity:gb(1)},">>":{func:hc,fixity:na(1)},"*>":{func:hc,fixity:na(4)},"<*":{func:zb,fixity:na(4)},"<$>":{func:ha,fixity:na(4)},"<*>":{func:xb,fixity:na(4)},"<**>":{func:c(yb)(Ea(la)),fixity:na(4)},"<$":{func:function(b,f){return zb(gc(value),f)},fixity:na(4)},"<|>":{func:V,fixity:gb(1)},"<?>":{func:Ga,fixity:T(0)}});G(Hb,D,function(){return{">>=":va,">>":Yb,do_:C,return_:$a,fail:X,run:lb,do$:function(){function b(v,
t,y){return q(v,t,y)}function f(v,t,y){if(u||v instanceof Ta)return(u?q:f.resolve())(v,t,y);h.push(oa(arguments,b));return f}var h=[],q,u;h.push(oa(arguments,b));f.resolve=function(){if(u)return q;q=C.apply(null,h);u=true;h=null;return q};f.CallStream=true;f.constructor=D;return f}}});var M=K(Hb,D).do$,I=Wa(D);Sa("Text_Parsec_Prim",{sequence:Cb,run:lb,Parser:D,ParseState:z,ps:Ya,toParser:fa,unexpected:S,parsecMap:ha,fmap:ha,liftM:ra,liftM2:yb,liftM3:Ha,liftA:ha,liftA2:yb,liftA3:Ha,ap:xb,parserBind:va,
parserReturn:$a,return_:L,pure:gc,parserFail:X,fail:lc,parserZero:J,mzero:Pb,empty:Dc,parserPlus:V,parserPlusN:Ab,mplus:qc,do_:C,do$:M,do2:Yb,bind:o,ret:N,withBound:Ka,returnCall:Pa,getPosition:mb,setPosition:Za,getParserState:jc,setParserState:kc,tokens:sb,many:Ib,many1:g,string:R,char_:p,satisfy:F,label:Ga,try_:n,skipMany:w,match:Ec,withScope:Kb,ex:I});Sa("Text_Parsec_Combinator",{choice:La,count:Eb,between:Ma,option:bb,optionMaybe:W,optional:cb,skipMany1:db,sepBy:Y,sepBy1:Aa,endBy:Db,endBy1:tb,
sepEndBy:E,sepEndBy1:Ra,chainl:fb,chainl1:Lb,chainr:eb,chainr1:Va,eof:xa,notFollowedBy:ca,manyTill:B,lookAhead:Mb,anyToken:Q});l(Ca,["AssocNone","AssocLeft","AssocRight"]);l(sa,[["Infix",D,Ca],["Prefix",D],["Postfix",D]]);Sa("Text_Parsec_Expr",{Assoc:Ca,Operator:sa,buildExpressionParser:r});var vb=function(b){return Ga(F(function(f){return Ba(f,b)}),"oneOf("+b+")")},xc=function(b){return Ga(F(function(f){return!Ba(f,b)}),"noneOf("+b+")")},yc=I(F,ga,"<?>","space").resolve();la=I(w,yc,"<?>","white space").resolve();
Ea=I(p,"\n","<?>","new-line").resolve();ma=I(p,"\t","<?>","tab").resolve();var Jc=I(F,Oa,"<?>","uppercase letter").resolve();qa=I(F,qa,"<?>","lowercase letter").resolve();ib=I(F,ib,"<?>","letter or digit").resolve();Oa=I(F,Gb,"<?>","letter").resolve();var Bc=I(F,kb,"<?>","digit").resolve(),Ac=I(F,Ub,"<?>","hexadecimal digit").resolve(),zc=I(F,fc,"<?>","octal digit").resolve();j=I(F,j(true)).resolve();Sa("Text_Parsec_Char",{oneOf:vb,noneOf:xc,space:yc,spaces:la,newline:Ea,tab:ma,upper:Jc,lower:qa,
alphaNum:ib,letter:Oa,digit:Bc,hexDigit:Ac,octDigit:zc,anyChar:j});l(Na,[["LanguageDef",{commentStart:String,commentEnd:String,commentLine:String,nestedComments:Boolean,identStart:D,identLetter:D,opStart:D,opLetter:D,reservedNames:Array,reservedOpNames:Array,caseSensitive:Boolean}]]);l(H,[["TokenParser",{identifier:D,reserved:Function,operator:D,reservedOp:Function,charLiteral:D,stringLiteral:D,natural:D,integer:D,float_:D,naturalOrFloat:D,decimal:D,hexadecimal:D,octal:D,symbol:Function,lexeme:Function,
whiteSpace:D,parens:Function,braces:Function,angles:Function,brackets:Function,squares:Function,semi:D,comma:D,colon:D,dot:D,semiSep:Function,semiSep1:Function,commaSep:Function,commaSep1:Function}]]);Sa("Text_Parsec_Token",{GenLanguageDef:Na,GenTokenParser:H,makeTokenParser:d});kb=vb(":!#$%&*+./<=>?@\\^|-~");l=Na.LanguageDef(s,{commentStart:"",commentEnd:"",commentLine:"",nestedComments:true,identStart:qb(Oa,"<|>",p("_")),identLetter:qb(ib,"<|>",vb("_'")),opStart:kb,opLetter:kb,reservedOpNames:[],
reservedNames:[],caseSensitive:true});j=Na.LanguageDef(s,{commentStart:"{-",commentEnd:"-}",commentLine:"--",nestedComments:true,identStart:Oa,identLetter:I(ib,"<|>",vb,"_'").resolve(),opStart:kb,opLetter:kb,reservedOpNames:[],reservedNames:[],caseSensitive:true});kb=Na.LanguageDef(s,{commentStart:"/*",commentEnd:"*/",commentLine:"//",nestedComments:true,identStart:Oa,identLetter:qb(ib,"<|>",vb,"_'"),opStart:kb,opLetter:kb,reservedOpNames:[],reservedNames:[],caseSensitive:false});Ub=j.update({reservedOpNames:["::",
"..","=","\\","|","<-","->","@","~","=>"],reservedNames:["let","in","case","of","if","then","else","data","type","class","default","deriving","do","import","infix","infixl","infixr","instance","module","newtype","where","primitive"]});var Lc=Ub.update({identLetter:qb(Ub.identLetter,"<|>",p("#")),reservedNames:Ub.reservedNames.concat(["foreign","import","export","primitive","_ccall_","_casm_","forall"])}),Mc=kb.update({reservedNames:["case","class","default","extends","import","in","let","new","of",
"package"],caseSensitive:true});Sa("Text_Parsec_Language",{emptyDef:l,haskellStyle:j,javaStyle:kb,haskellDef:Lc,mondrianDef:Mc,getHaskell:function(){return d(Lc)},getMondrian:function(){return d(Mc)}})})();(function(){namespace("Text_Parsec");importSubmodules("Text_Parsec",["Prim","Char","Combinator","Token","Language","Expr"])})();(function(){function z(){}function Ya(){}function S(){}function X(g){if(!(g instanceof S))throw"Type error: expecting type of 'Id' instead of "+g.constructor;return g.Id?
g[1]:null}function J(){}function fa(){}function lb(){}function za(){}function D(){}function va(){}function o(){}function N(){}function Ka(){}function mb(){}function Za(){}function $a(){}function xb(g,n){for(var w=!!n.charAt,p=0,F=n.length;p<F;++p)if(!g(w?n.charAt(p):n[p]))break;return T(n,p)}function ra(g,n,w){return function(p,F,R){return(F.sourceLine(p[g])==F.sourceLine(p[n])?Ca(Q(E.Just,w),B(E.Nothing)):B(E.Nothing))(p,F,R)}}function yb(g,n,w){return function(p,F,R){return(F.sourceLine(p[g])==
F.sourceLine(p[n])?w:Lb("end of line"))(p,F,R)}}function Ha(g,n,w){var p=n.input.substring(0,n.index-n.dropped).match(/\s*$/);p=p&&/\n|\r/.test(p[0]);var F;if(!p){var R=n.at(0);if(R==""||R=="}")p=true;else if(R==";")F=p=true}return(p?F?k.semi:B(null):Mb("end of statement"))(g,n,w)}function zb(g){return g==" "||g=="\t"}function V(g){return function(n,w,p){return Ab(g)(n,w,p)}}function Ab(g){return ea([P(g),">>",B,""],"<|>",[r(ha,[ba,"\\'"])("cs","<-",V(g))(H,function(n){return"'"+n.cs})],"<|>",[r(P("\\"))("c",
"<-",jc,"<|>",kc,"<|>",L,"<|>",P("\r"),"<|>",P("\n"))("cs","<-",V(g))(H,function(n){return n.c=="\r"||n.c=="\n"?oa(n.c,xb(zb,n.cs)):oa(n.c,n.cs)})],"<|>",[xa,oa,ob,V(g)])}function sb(g,n,w){return n>=1?sb(g,n/10,w):(g+n)*Math.pow(10,w)}function Bb(g){return ea(g,">>=",[B,".",E.Just])}function ab(g,n){return sa(Na("pos",c),Na("e",n),H(function(w){return g(w.pos,w.e)}))}function nb(g){function n(w,p){return o.DotRef(w,g,p)}return ea([k.reservedOp("."),">>",ab,n,qa],"<?>","property.ref")}function Kb(g){function n(w,
p){return o.CallExpr(w,g,p)}return ea([k.parens,"$",ab,n,[ga,Ia(pb),k.comma]],"<?>","(function application)")}function Cb(g){function n(w,p){return o.BracketRef(w,g,p)}return ea([k.brackets,"$",ab,n,ga],"<?>","[property-ref]")}function La(g){if(g.Just){g=g[0];return ea(r("e_","<-",nb(g),"<|>",Cb(g))(function(n,w,p){return La(E.Just(n.e_))(n,w,p)}),"<|>",B(g))}if(g.Nothing)return r("e","<-",Da,"<?>","expression (3)")(function(n,w,p){return La(E.Just(n.e))(n,w,p)})}function bb(g){if(g.Just){g=g[0];
return ea(r("e_","<-",nb(g),"<|>",Kb(g),"<|>",Cb(g))(function(n,w,p){return bb(E.Just(n.e_))(n,w,p)}),"<|>",B(g))}if(g.Nothing)return r("e","<-",Da,"<?>","expression (3)")(function(n,w,p){return bb(E.Just(n.e))(n,w,p)})}function W(g,n){g=r("pos","<-",c)(k.reservedOp(g))(H,function(w){return function(p,F){return o.InfixExpr(w.pos,n,p,F)}});return K.Infix(g,G.AssocLeft)}function cb(g,n){if(n.VarRef)if(n[1].Id)return B(va.LVar(n[0],n[1][1]));if(n.DotRef)if(n[2].Id)return B(va.LDot(n[0],n[1],n[2][1]));
if(n.BracketRef)return B(va.LBracket(n[0],n[1],n[2]));return Mb("expeceted l-value at "+g)}function Ma(g,n){return function(w){return o.UnaryAssignExpr(g,lb[n],w)}}function db(g,n){return function(w,p,F){var R=p.substring(0,2);if(R=="--"||R=="++"){R=p.input.substring(0,p.index-p.dropped).match(/\s*$/);return(R&&/\n|\r/.test(R[0])?n:g)(w,p,F)}else return n(w,p,F)}}var Y=NS.Haskell_DataType.data,Aa=NS.Haskell_DataType.ADT;Aa=NS.Haskell_DataType.record;var Ra=NS.Haskell_DataType.accessor;Ra=NS.Haskell_DataType.accessors;
var E=NS.Prelude.Maybe,tb=NS.Prelude.maybe,Db=NS.Prelude.lookup,Eb=NS.Prelude.fst,eb=NS.Prelude.uncurry,fb=NS.Text_Parsec.sequence,Lb=NS.Text_Parsec.unexpected,Va=NS.Text_Parsec.fmap,Q=NS.Text_Parsec.liftM,xa=NS.Text_Parsec.liftM2,ca=NS.Text_Parsec.parserBind,B=NS.Text_Parsec.return_,Mb=NS.Text_Parsec.fail,Ca=NS.Text_Parsec.parserPlus,sa=NS.Text_Parsec.do_,r=NS.Text_Parsec.do$,Na=NS.Text_Parsec.bind,H=NS.Text_Parsec.ret,d=NS.Text_Parsec.returnCall,c=NS.Text_Parsec.getPosition,j=NS.Text_Parsec.many,
A=NS.Text_Parsec.many1,ba=NS.Text_Parsec.string,P=NS.Text_Parsec.char_,$=NS.Text_Parsec.label,ha=NS.Text_Parsec.try_,la=NS.Text_Parsec.withScope,ea=NS.Text_Parsec.ex,Ea=NS.Text_Parsec.oneOf,Fa=NS.Text_Parsec.noneOf,ub=NS.Text_Parsec.spaces,jb=NS.Text_Parsec.alphaNum,wa=NS.Text_Parsec.letter,Ba=NS.Text_Parsec.hexDigit,ob=NS.Text_Parsec.anyChar,ma=NS.Text_Parsec.option,Sa=NS.Text_Parsec.optionMaybe,pb=NS.Text_Parsec.sepBy,a=NS.Text_Parsec.sepBy1,e=NS.Text_Parsec.sepEndBy,i=NS.Text_Parsec.notFollowedBy,
l=NS.Text_Parsec.GenLanguageDef,s=NS.Text_Parsec.makeTokenParser,G=NS.Text_Parsec.Assoc,K=NS.Text_Parsec.Operator,ia=NS.Text_Parsec.buildExpressionParser,T=NS.Haskell.slice,na=NS.Haskell.map,gb=NS.Haskell.id,oa=NS.Haskell.cons,Wa=NS.Haskell.negate,qb=NS.Haskell.elem,Ta=NS.Haskell.namespace,hb=NS.Haskell.readHex,Fb=NS.Haskell.readOct,Hb=NS.Haskell.chr,Vb=NS.Haskell.round;Y=NS.Haskell.data;Aa=NS.Haskell.ADT;Aa=NS.Haskell.record;Ra=NS.Haskell.accessor;Ra=NS.Haskell.accessors;var Ia=NS.Haskell.op;Y(Ya,
[["Script","a",Array]]);Y(S,[["Id","a",String]]);Y(J,["OpLT","OpLEq","OpGT","OpGEq","OpIn","OpInstanceof","OpEq","OpNEq","OpStrictEq","OpStrictNEq","OpLAnd","OpLOr","OpMul","OpDiv","OpMod","OpSub","OpLShift","OpSpRShift","OpZfRShift","OpBAnd","OpBXor","OpBOr","OpAdd"]);Y(fa,["OpAssign","OpAssignAdd","OpAssignSub","OpAssignMul","OpAssignDiv","OpAssignMod","OpAssignLShift","OpAssignSpRShift","OpAssignZfRShift","OpAssignBAnd","OpAssignBXor","OpAssignBOr"]);Y(lb,["PrefixInc","PrefixDec","PostfixInc",
"PostfixDec"]);Y(za,["PrefixLNot","PrefixBNot","PrefixPlus","PrefixMinus","PrefixTypeof","PrefixVoid","PrefixDelete"]);Y(D,[["PropId","a",S],["PropString","a",String],["PropNum","a",Number]]);Y(va,[["LVar","a",String],["LDot","a",o,String],["LBracket","a",o,o]]);Y(o,[["StringLit","a",String],["RegexpLit","a",String,Boolean,Boolean],["NumLit","a",Number],["IntLit","a",Number],["BoolLit","a",Boolean],["NullLit","a"],["ArrayLit","a",Array],["ObjectLit","a",Array],["ThisRef","a"],["VarRef","a",S],["DotRef",
"a",o,S],["BracketRef","a",o,o],["NewExpr","a",o,Array],["PrefixExpr","a",za,o],["UnaryAssignExpr","a",lb,va],["InfixExpr","a",J,o,o],["CondExpr","a",o,o,o],["AssignExpr","a",fa,va,o],["ParenExpr","a",o],["ListExpr","a",Array],["CallExpr","a",o,Array],["FuncExpr","a",E,Array,z]]);Y(N,[["CaseClause","a",o,Array],["CaseDefault","a",Array]]);Y(Ka,[["CatchClause","a",S,z]]);Y(mb,[["VarDecl","a",S,E]]);Y(Za,["NoInit",["VarInit",Array],["ExprInit",o]]);Y($a,[["ForInVar",S],["ForInNoVar",S]]);Y(z,[["BlockStmt",
"a",Array],["EmptyStmt","a"],["ExprStmt","a",o],["IfStmt","a",o,z,z],["IfSingleStmt","a",o,z],["SwitchStmt","a",o,Array],["WhileStmt","a",o,z],["DoWhileStmt","a",z,o],["BreakStmt","a",E],["ContinueStmt","a",E],["LabelledStmt","a",S,z],["ForInStmt","a",$a,o,z],["ForStmt","a",Za,E,E,z],["TryStmt","a",z,Array,E],["ThrowStmt","a",o],["ReturnStmt","a",E],["WithStmt","a",o,z],["VarDeclStmt","a",Array],["FunctionStmt","a",S,Array,z]]);Ta("BrownPLT_JavaScript_Syntax",{Expression:o,CaseClause:N,Statement:z,
InfixOp:J,CatchClause:Ka,VarDecl:mb,JavaScript:Ya,AssignOp:fa,Id:S,PrefixOp:za,Prop:D,ForInit:Za,ForInInit:$a,unId:X,UnaryAssignOp:lb,LValue:va});Y=Ca(wa,Ea("$_"));jb=l.LanguageDef(Aa,{commentStart:"/*",commentEnd:"*/",commentLine:"//",nestedComments:false,identStart:Y,identLetter:Ca(jb,Ea("$_")),opStart:Ea("{}<>()~.,?:|&^=!+-*/%!"),opLetter:Ea("=<>|&+"),reservedOpNames:["|=","^=","&=","<<=",">>=",">>>=","+=","-=","*=","/=","%=","=",";",",","?",":","||","&&","|","^","&","===","==","=","!==","!=",
"<<","<=","<",">>>",">>",">=",">","++","--","+","-","*","/","%","!","~",".","[","]","{","}","(",")","instanceof","in"],reservedNames:["break","case","catch","const","continue","debugger","default","delete","do","else","enum","false","finally","for","function","if","instanceof","in","let","new","null","return","switch","this","throw","true","try","typeof","var","void","while","with"],caseSensitive:true});var k=s(jb);Ta("BrownPLT_JavaScript_Lexer",{lex:k});var pa=la(function(){return pa}),da=la(function(){return da}),
ta=la(function(){return ta}),Da=la(function(){return Da}),ga=la(function(){return ga}),Oa=ga,qa=xa(S.Id,c,k.identifier);jb=r("pos","<-",c)(k.reserved,"if")("test","<-",ta,"<?>","parenthesized test-expression in if statement")("consequent","<-",da,"<?>","true-branch of if statement")(r(k.reserved,"else")("alternate","<-",da)(H,function(g){return z.IfStmt(g.scope.pos,g.scope.test,g.scope.consequent,g.alternate)}),"<|>",d(z.IfSingleStmt,"pos","test","consequent"));s=r("pos","<-",c)(k.reserved,"default")(k.colon)("statements",
"<-",j,da)(d,N.CaseDefault,"pos","statements");l=r("pos","<-",c)(k.reserved,"case")("condition","<-",pa)(k.colon)("actions","<-",j,da)(d,N.CaseClause,"pos","condition","actions");l=r("pos","<-",c)(k.reserved,"switch")("test","<-",ta)("clauses","<-",k.braces,"$",j,"$",s,"<|>",l)(d,z.SwitchStmt,"pos","test","clauses");Aa=r("pos","<-",c)(k.reserved,"while")("test","<-",ta,"<?>","parenthesized test-expression in while loop")("body","<-",da)(d,z.WhileStmt,"pos","test","body");s=r("pos","<-",c)("statements",
"<-",k.braces,[j,da])(d,z.BlockStmt,"pos","statements");wa=r("pos","<-",c)(k.reserved,"do")("body","<-",s)(k.reserved,"while","<?>","while at the end of a do block")("test","<-",ta,"<?>","parenthesized test-expression in do loop")(Ha)(d,z.DoWhileStmt,"pos","body","test");Ra=r("pos","<-",c)(k.reserved,"continue")("pos_","<-",c)("id","<-",ra,"pos","pos_",qa)(Ha)(d,z.ContinueStmt,"pos","id");var Gb=r("pos","<-",c)(k.reserved,"break")("pos_","<-",c)("id","<-",ra,"pos","pos_",qa)(Ha)(d,z.BreakStmt,"pos",
"id"),ib=r("pos","<-",c)(k.semi)(d,z.EmptyStmt,"pos"),kb=r("pos","<-",c)("label","<-",ha,r("label","<-",qa)(k.colon)(H,"label"))("statement","<-",da)(d,z.LabelledStmt,"pos","label","statement"),Ub=r("pos","<-",c)("expr","<-",pa)(Ha)(d,z.ExprStmt,"pos","expr"),fc=ea([k.reserved,"var",">>",Q,$a.ForInVar,qa],"<|>",[Q,$a.ForInNoVar,qa]);fc=r("pos","<-",c)("init_expr","<-",ha,r(k.reserved,"for")(k.parens,r("init","<-",fc)(k.reserved,"in")("expr","<-",ga)(H,function(g){return[g.init,g.expr]})))("body",
"<-",da)(H,function(g){return z.ForInStmt(g.pos,g.init_expr[0],g.init_expr[1],g.body)});var ja=r("pos","<-",c)("id","<-",qa)("init","<-",[k.reservedOp("="),">>",Q,E.Just,ga],"<|>",B(E.Nothing))(d,mb.VarDecl,"pos","id","init"),lc=r("pos","<-",c)(k.reserved,"var")("decls","<-",ja,Ia(pb),k.comma)(Ha)(d,z.VarDeclStmt,"pos","decls");ja=ea([k.reserved,"var",">>",Q,Za.VarInit,[ja,Ia(pb),k.comma]],"<|>",[Q,Za.ExprInit,pa],"<|>",B(Za.NoInit));ja=r("pos","<-",c)(k.reserved,"for")(k.reservedOp("("))("init",
"<-",ja)(k.semi)("test","<-",[Q,E.Just,ga],"<|>",B(E.Nothing))(k.semi)("iter","<-",[Q,E.Just,pa],"<|>",B(E.Nothing))(k.reservedOp(")"),"<?>","closing paren")("stmt","<-",da)(d,z.ForStmt,"pos","init","test","iter","stmt");var Pb=r("pos","<-",c)(k.reserved,"catch")("id","<-",k.parens,qa)("stmt","<-",da)(d,Ka.CatchClause,"pos","id","stmt");Pb=r(k.reserved,"try")("pos","<-",c)("guarded","<-",da)("catches","<-",j,Pb)("finally","<-",[k.reserved,"finally",">>",Q,E.Just,da],"<|>",B(E.Nothing))(d,z.TryStmt,
"pos","guarded","catches","finally");var Dc=r("pos","<-",c)(k.reserved,"throw")("pos_","<-",c)("expr","<-",yb,"pos","pos_",ga)(Ha)(d,z.ThrowStmt,"pos","expr"),ic=r("pos","<-",c)(k.reserved,"return")("pos_","<-",c)("expr","<-",ra,"pos","pos_",pa)(Ha)(d,z.ReturnStmt,"pos","expr"),Yb=r("pos","<-",c)(k.reserved,"with")("context","<-",ta)("stmt","<-",da)(d,z.WithStmt,"pos","context","stmt"),C=r("pos","<-",c)("name","<-",ha,[k.reserved,"function",">>",qa])("args","<-",k.parens,[qa,Ia(pb),k.comma])("body",
"<-",s,"<?>","function body in { ... }")(d,z.FunctionStmt,"pos","name","args","body");da=ea(jb,"<|>",l,"<|>",Aa,"<|>",wa,"<|>",Ra,"<|>",Gb,"<|>",s,"<|>",ib,"<|>",fc,"<|>",ja,"<|>",Pb,"<|>",Dc,"<|>",ic,"<|>",Yb,"<|>",lc,"<|>",C,"<|>",kb,"<|>",Ub,"<?>","statement");jb=r("pos","<-",c)(k.reserved,"this")(d,o.ThisRef,"pos");l=r("pos","<-",c)(k.reserved,"null")(d,o.NullLit,"pos");Aa=r("pos","<-",c)("true","<-",B,true)("false","<-",B,false)([k.reserved,"true",">>",d(o.BoolLit,"pos","true")],"<|>",[k.reserved,
"false",">>",d(o.BoolLit,"pos","false")]);wa=xa(o.VarRef,c,qa);Ra=xa(o.ArrayLit,c,k.squares(e(ga,k.comma)));Gb=r("pos","<-",c)(k.reserved,"function")("name","<-",[qa,">>=",B,".",E.Just],"<|>",B,E.Nothing)("args","<-",k.parens,[qa,Ia(pb),k.comma])("body","<-",s)(d,o.FuncExpr,"pos","name","args","body");var Pa=[["'","'"],['"','"'],["\\","\\"],["b","\u0008"],["f","\u000c"],["n","\n"],["r","\r"],["t","\t"],["v","\u000b"],["/","/"],[" "," "],["0","\u0000"]];Eb=na(Eb,Pa);var jc=r("c","<-",Ea(Eb))(H,function(g){return Db(g.c,
Pa)[0]}),kc=r(P,"x")("d1","<-",Ba)("d2","<-",Ba)(H,function(g){return Hb(hb(""+g.d1+g.d2))}),L=r(P,"u")(Q,[Hb,".",hb],fb([Ba,Ba,Ba,Ba]));fb=r("pos","<-",c)("str","<-",k.lexeme,"$",[P("'"),">>=",Ab],"<|>",[P('"'),">>=",Ab])(d,o.StringLit,"pos","str");Ba=r("flags","<-",j,Ea("mgi"))(H,function(g){return function(n){return n(qb("g",g.flags),qb("i",g.flags))}});ea(P("\\"),">>",ob).resolve();Fa("/");Fa=function(g,n,w){return gc(g,n,w)};var gc=ea([P("/"),">>",B,""],"<|>",r(P("\\"))("ch","<-",ob)("rest",
"<-",Fa)(H,function(g){return"\\"+g.ch+g.rest}),"<|>",[xa,oa,ob,Fa]);ub=r("pos","<-",c)(P("/"))("pat","<-",gc)("flags","<-",Ba)(ub)(H,function(g){return g.flags(function(n,w){return o.RegexpLit(g.pos,g.pat,n,w)})});eb=r("name","<-",[Q,eb(D.PropString),[Q,function(g){return[g[0],g[1]]},fb]],"<|>",[xa,D.PropId,c,qa],"<|>",[xa,D.PropNum,c,k.decimal])(k.colon)("val","<-",Oa)(H,function(g){return[g.name,g.val]});e=r("pos","<-",c)("props","<-",k.braces,[eb,Ia(e),k.comma],"<?>","object literal")(d,o.ObjectLit,
"pos","props");eb=r(ha,ba("0x"))("digits","<-",A,Ea("0123456789abcdefABCDEF"))("hex","<-",d,hb,"digits")(H,function(g){return[true,g.hex]});A=r("digits","<-",ha,"$",[P("0"),">>",[A,Ea("01234567"),"<|>",B("0")]],"<*",i,Ea(".89"))("oct","<-",d,Fb,"digits")(H,function(g){return[true,g.oct]});Va=r(Ea,"eE")([P("+"),">>",k.decimal],"<|>",[P("-"),">>",Wa,Ia(Va),k.decimal],"<|>",k.decimal);ma=ea(r("whole","<-",k.decimal)("mfrac","<-",ma,E.Nothing,[Bb,[P("."),">>",k.decimal]])("mexp","<-",ma,E.Nothing,[Bb,
Va])(H,function(g){return g.mfrac==E.Nothing&&g.mexp==E.Nothing?[true,g.whole]:[false,sb(g.whole,tb(0,gb,g.mfrac),tb(0,gb,g.mexp))]}),"<|>",r("frac","<-",P("."),">>",k.decimal)("exp","<-",ma,0,Va)(H,function(g){return[false,sb(0,g.frac,g.exp)]}));ma=r("pos","<-",c)("isint_num","<-",k.lexeme,"$",eb,"<|>",A,"<|>",ma)(i,Y,"<?>","whitespace")(H,function(g){var n=g.isint_num[1];return g.isint_num[0]?o.IntLit(g.pos,Vb(n)):o.NumLit(g.pos,n)});ta=ab(o.ParenExpr,k.parens(pa));ea(jb,"<|>",l,"<|>",Aa,"<|>",
fb,"<|>",Ra,"<|>",ta,"<|>",Da,"<|>",ma,"<|>",ub,"<|>",e,"<|>",wa);ma=ea(jb,"<|>",l,"<|>",Aa,"<|>",fb,"<|>",Ra,"<|>",ta,"<|>",Gb,"<|>",ma,"<|>",ub,"<|>",e,"<|>",wa);Da=ea(r("pos","<-",c)(k.reserved,"new")("constructor_","<-",La,E.Nothing)("arguments","<-",[ha,[k.parens,[ga,Ia(pb),k.comma]]],"<|>",B([]))(d,o.NewExpr,"pos","constructor_","arguments"),"<|>",ma);var hc=r("pos","<-",c)("op","<-",Sa,"$",[k.reservedOp("!"),">>",B,za.PrefixLNot],"<|>",[k.reservedOp("~"),">>",B,za.PrefixBNot],"<|>",[ha,[k.lexeme,
"$",P("-"),">>",i,P("-")],">>",B,za.PrefixMinus],"<|>",[ha,[k.lexeme,"$",P("+"),">>",i,P("+")],">>",B,za.PrefixPlus],"<|>",[k.reserved,"typeof",">>",B,za.PrefixTypeof],"<|>",[k.reserved,"void",">>",B,za.PrefixVoid],"<|>",[k.reserved,"delete",">>",B,za.PrefixDelete])(function(g,n,w){var p=g.op,F;if(p.Nothing)F=Ib;if(p.Just)F=r("innerExpr","<-",hc)(H,function(R){return o.PrefixExpr(g.pos,p[0],R.innerExpr)});return F(g,n,w)});i=[[W("*",J.OpMul),W("/",J.OpDiv),W("%",J.OpMod)],[W("+",J.OpAdd),W("-",J.OpSub)],
[W("<<",J.OpLShift),W(">>",J.OpSpRShift),W(">>>",J.OpZfRShift)],[W("<",J.OpLT),W("<=",J.OpLEq),W(">",J.OpGT),W(">=",J.OpGEq),W("instanceof",J.OpInstanceof),W("in",J.OpIn)],[W("&",J.OpBAnd)],[W("^",J.OpBXor)],[W("|",J.OpBOr)],[W("&&",J.OpLAnd)],[W("||",J.OpLOr)],[W("==",J.OpEq),W("!=",J.OpNEq),W("===",J.OpStrictEq),W("!==",J.OpStrictNEq)]].reverse();$=$(ia(i,hc),"simple expression");var qc=r("p","<-",c)("e","<-",bb,E.Nothing)(function(g,n,w){return cb(g.p,g.e)(g,n,w)}),Ib=ca(c,function(g){function n(Ga){return sa(k.reservedOp("++"),
Q(Ma(g,"PostfixInc"),cb(g,Ga)))}function w(Ga){return sa(k.reservedOp("--"),Q(Ma(g,"PostfixDec"),cb(g,Ga)))}var p=sa(k.reservedOp("++"),Q(Ma(g,"PrefixInc"),qc)),F=sa(k.reservedOp("--"),Q(Ma(g,"PrefixDec"),qc)),R=ca(bb(E.Nothing),function(Ga){return db(Ca(n(Ga),Ca(w(Ga),B(Ga))),B(Ga))});return Ca(p,Ca(F,R))});ia=r(k.reservedOp("?"))("l","<-",Oa)(k.colon)("r","<-",Oa)(H,function(g){return[g.l,g.r]});Sa=r("e","<-",$)("e_","<-",Sa,ia)(function(g,n,w){var p=g.e_,F=g.e,R;if(p.Nothing)R=B(g.e);if(p.Just){var Ga=
p[0][0],Ec=p[0][1];R=r("p","<-",c)(H,function(M){return o.CondExpr(M.p,F,Ga,Ec)})}return R(g,n,w)});$=ea([k.reservedOp("="),">>",B,fa.OpAssign],"<|>",[k.reservedOp("+="),">>",B,fa.OpAssignAdd],"<|>",[k.reservedOp("-="),">>",B,fa.OpAssignSub],"<|>",[k.reservedOp("*="),">>",B,fa.OpAssignMul],"<|>",[k.reservedOp("/="),">>",B,fa.OpAssignDiv],"<|>",[k.reservedOp("%="),">>",B,fa.OpAssignMod],"<|>",[k.reservedOp("<<="),">>",B,fa.OpAssignLShift],"<|>",[k.reservedOp(">>="),">>",B,fa.OpAssignSpRShift],"<|>",
[k.reservedOp(">>>="),">>",B,fa.OpAssignZfRShift],"<|>",[k.reservedOp("&="),">>",B,fa.OpAssignBAnd],"<|>",[k.reservedOp("^="),">>",B,fa.OpAssignBXor],"<|>",[k.reservedOp("|="),">>",B,fa.OpAssignBOr]);ga=Oa=r("p","<-",c)("lhs","<-",Sa)(r("op","<-",$)("lhs","<-",la,function(g){g.p=g.scope.p;return cb(g.scope.p,g.scope.lhs)})("rhs","<-",la,function(){return Oa})(d,o.AssignExpr,"p","op","lhs","rhs"),"<|>",H,"lhs");pa=xa(o.ListExpr,c,a(Oa,k.comma));d=r(k.whiteSpace)(xa,Ya.Script,c,j(da));Ta("BrownPLT_JavaScript_Parser",
{parseScript:d,parseExpression:ga,parseSimpleExpr_:ma,parseBlockStmt:s,parseStatement:da,assignExpr:Oa})})();(function(){namespace("BrownPLT_JavaScript");importSubmodules("BrownPLT_JavaScript",["Lexer","Syntax","Parser"])})();(function(){function z(){Ya(S,z.toString(),function(J){X(J.state.length?"failed":"ok");typeof console!="undefined"&&console.log(J.ast)})}var Ya=NS.Text_Parsec_Prim.run,S=NS.BrownPLT_JavaScript.parseScript,X=typeof console!="undefined"?console.log:typeof print!="undefined"?print:
function(J){alert(J)};z()})()})();
