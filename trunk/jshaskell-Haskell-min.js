/*

 JSHaskell - Some Haskell language features for JavaScript

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.

 ------------------------------------------------------------

*/
(function(){(function(){function s(a,b){return F[a]=b||{}}function da(a,b){for(var c=F[a],d=0,e=b.length;d<e;++d){var f=F[a+"_"+b[d]];for(var g in f)c[g]=f[g]}}function ea(a){return fa.call(a)=="[object Array]"}function G(a){return a!==A}function ga(a,b){return a===b}function ha(a,b){return a!==b}function ia(a,b){return a+b}function ja(a,b){return a-b}function ka(a,b){return a*b}function la(a,b){return a/b}function ma(a,b){return a<b}function na(a,b){return a<=b}function oa(a,b){return a>b}function pa(a,
b){return a>=b}function qa(a){return-a}function B(a){var b=a.constructor;if(b)return b;a=typeof a;return a=="string"?String:a=="number"?Number:a=="boolean"?Boolean:a=="function"?Function:A}function ra(a){function b(){var c=t(arguments);return c.length>=(a._length===A?a.length:a._length)?a.apply(null,c):function(){return b.apply(null,c.concat(t(arguments)))}}return b}function sa(a){var b=t(arguments,1);return function(){return a.apply(null,b)}}function ta(){function a(b){return!b?[]:[[b.name||b._name||
b,b.arguments]].concat(a(b.caller))}return a(arguments.callee.caller)}function p(a){a=(a instanceof Function?a.name||a._name:null)||a||"Unspecified error";var b=new Error(a);try{b.stackTrace=ta()}catch(c){}b.message=a;throw b;}function ua(a,b){for(var c in b)a[c]=b[c];return a}function H(a,b){if(b.indexOf)return b.indexOf(a);var c=b.length;if(!c)return-1;for(var d=0;d<c;d++)if(b[d]===a)return d;return-1}function Q(a,b){if(b.lastIndexOf)return b.lastIndexOf(a);var c=b.length;if(!c)return-1;for(c=c-
1;c>-1;--c)if(b[c]===a)return c;return-1}function va(a){var b=a.charAt;a=R(a);a.sort();return b?a.join(""):a}function R(a){if(!a.charAt)return I.call(a,0);for(var b=[],c=0,d=a.length;c<d;++c)b.push(a.charAt(c));return b}function wa(a,b){return{indexOf:function(c){return c>=a&&c<=b?true:-1},toString:function(){return"range("+a+", "+b+")"}}}function xa(a,b){function c(){try{var e=b;do a=a()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()();
while(--e);setTimeout(c,1)}catch(f){}}if(!b||b==Infinity){try{for(;a=a()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()(););}catch(d){}return a}c()}function ya(a){return["l",a]}function za(a){return["r",a]}function Aa(a){return["x",a]}function Ba(a){if(a)if(!a._String){var b=C[a];if(a._Op&&!b)return"l";return b&&(b.fixity[0]||"l")}}function Ca(a){if(a)if(!a._String){var b=
C[a];if(a._Op&&!b)return 9;return b&&(G(b.fixity[1])?b.fixity[1]:9)}}function J(){}function K(a,b,c){var d;if(a[b]._Op){delete a[b]._Op;d=a[b]}else d=C[a[b]].func;d=d(a[b-1],a[b+1]);a.splice(b-1,3,d);return u(a,c)}function Da(a){if(typeof a=="string"){a=new String(a);a._String=true;return a}else{a._Array=true;return a}}function Ea(a){a._Op=true;return a}function u(a,b){a=x(function(h){if(!h)return h;if(h._Array){delete h._Array;return h}return h.constructor==Array?u(h,b):h.CallStream?h.resolve(b):
h},a);if(b)a=x(function(h){return h instanceof J?b:h},a);for(var c=[],d=[],e=0,f=a.length;e<f;++e){var g=a[e],i=false;if(C[g])i=true;if(g&&g._String){i=false;g=g.toString()}if(g&&g._Op)i=true;if(!i&&e!=f-1)c.push(g);else{e==f-1&&c.push(g);c=c.length>1?c[0].apply(null,c.slice(1)):c[0];d.push(c);e!=f-1&&d.push(g);c=[]}}a=d;d=x(Ba,a);f=x(Ca,a);g=L(G,f).sort().pop();e=H(g,f);f=Q(g,f);return d[e]=="l"?K(a,e,b):d[f]=="r"?K(a,f,b):d[e]=="x"?K(a,e,b):a[0]}function Fa(a){return function(){function b(){return e.apply(null,
arguments)}function c(){return(f?e:c.resolve()).apply(null,arguments)}var d=arguments,e,f;c.resolve=function(g){if(f)return e;e=u(d,g||b);d=null;f=true;return e};c.CallStream=true;c.constructor=a;return c}}function Ga(){return u(t(arguments))}function S(a){this.scope=a}function Ha(a){return function(){function b(){return e.apply(null,arguments)}function c(g){if(f||g instanceof S)return(f?e:c.resolve()).apply(null,arguments);d.push(u(arguments,b));return c}var d=[],e,f;d.push(u(arguments,b));c.resolve=
function(){if(f)return e;e=a.do_.apply(null,d);f=true;d=null;return e};c.CallStream=true;c.constructor=a._type;return c}}function M(){this.keys=[];this.values=[]}function Ia(a,b){var c={};c._context=[];c._name=a;c._dict=new M;c.context=function(){this._context=t(arguments);delete c.context;return this};c.types=function(d){this._fnTypes=d;delete c.types;return this};c.impl=function(d){this._default=d;for(var e in c._fnTypes)(function(f,g){c[f]=g!==A&&g.constructor!=Array?(typeof d=="function"?d():
d)[f]:function(){var i=arguments,h;if(g===A||g===N)p("There's no type signature for "+c._name+"."+f+", it can be accessed only by: getInstance("+c._name+", SomeType)."+f);var k,y=L(function(j,l){l=g[l];if(k||l==N)return k=true;j=B(j);if(l==b){h=h||j;return h==j}else return j==l},i);!k&&y.length!=g.length-1&&p("Type error in "+c._name+"."+f);(y=c._dict.get(h))||p("No "+c._name+" instance for "+(h.name||h._name));return y[f].apply(null,i)}})(e,c._fnTypes[e]);delete c.impl;return this};return c}function Ja(a,
b,c){x(function(g){if(!g._dict.get(b))throw"No "+(g._name||"")+" instance for "+(b.name||b._name);},a._context);var d={};d._type=b;a._dict.put(b,d);c=typeof c=="function"?c(d):c||{};var e=a._default;e=typeof e=="function"?e(d):e;for(var f in a._fnTypes)d[f]=c[f]||e[f];return d}function Ka(a,b){return a._dict.get(b)}function La(a,b,c){return a._dict.get(B(c))[b]}function Ma(a,b){return b?b[a]:function(c){return c[a]}}function T(){}function D(){}function U(a){return function(){var b=[],c=this._recordset;
if(c&&c.constructor!=Array){for(var d in c){var e=a?c[d].name||c[d]:this[d];if(!a&&e instanceof Function)e=e.constructor!=Function?e.constructor.name:"Function("+e.name+")";b.push(d+(a?" :: ":" = ")+e)}c=replicate(this._dataConstructor.length+2," ").join("");b="{"+b.join("\n"+c+",")+"\n"+c+"}"}else{for(d=0;d in this;d++)b.push(a?c[d].name||c[d]:this[d]);b=b.join(" ")}return"("+this._dataConstructor+(b?" ":"")+b+")"}}function V(a,b,c,d,e){p("Type error: expecting "+a.name+" instead of "+b.name+" in the argument '"+
c+"' of "+d+"."+e)}function Na(a,b){function c(h,k){function y(Oa,W){var o=Oa instanceof T,m=new a,z,q;m.constructor=a;m._recordset=j&&k[0]||k;m._dataConstructor=h;m[h]=true;if(o)for(var n in W){o=W[n];j||p("Records are not defined for "+d+"."+h);n in l||p("The accessor '"+n+"' is not defined for "+d+"."+h);q=l[n];if(typeof q!="string"){z=B(o);z!=q&&V(q,z,n,d,h)}m[n]=o;m[X[n]]=o}else{n=arguments;for(var v=0,Pa=n.length;v<Pa;++v){o=n[v];q=k[v];if(typeof q!="string"){z=B(o);z!=q&&V(q,z,v,d,h)}m[v]=
o;if(j)m[Y[v]]=o}}m.update=function(Z){var $={};for(var E in l)$[E]=E in Z?Z[E]:this[E];return y(aa,$)};return m}var j=k&&typeof k[0]=="object",l=j&&k[0];if(j){var O=0,w,X={},Y={};for(w in l){var P=w.charAt(0);if(P=="_"||P==P.toUpperCase())throw d+"."+i+"."+w+": record names can't start with underscore or uppercase letters";if(w in{update:1})throw d+"."+i+"."+w+": record name is invalid";X[w]=O;Y[O]=w;O++}}return y}var d=a.name;if(a._constructors)throw"Type constructor has been already defined: '"+
d+"'";a._constructors=b;a.prototype=new D;for(var e=0,f=b.length;e<f;++e){var g=typeof b[e]!="object",i=g?b[e]:b[e][0];if(i in a)throw"The name of the data constructor ("+d+"."+i+") is invalid!";a[i]=g?c(i)():c(i,t(b[e],1));if(!g)a[i]._length=b[e].length-1}}var r=function(){return this}()||window,F=r.NS||(r.NS={}),A,fa={}.toString,I=[].slice,ba=[].map,ca=[].filter;(function(){return this}).toString().indexOf("this");(function(){var a={9:1,d:1,b:1,0:1,a:1,c:1},b=[9,"d","b",0,"a","c"],c=0;for(var d in a)if(d!=
b[c++])return false;return true})();r.global=r;r.namespace=s;r.importSubmodules=da;var t="a"[0]?function(a,b){return I.call(a,b||0)}:function(a,b){if(typeof a=="string"){a=a.split("");if(!b)return a}return I.call(a,b||0)},x=ba?function(a,b){return ba.call(b,a)}:function(a,b){for(var c=[],d=0,e=b.length;d<e;++d)c[d]=a(b[d],d,b);return c},L=ca?function(a,b){return ca.call(b,a)}:function(a,b){for(var c=[],d=0,e=b.length;d<e;++d)a(b[d],d,b)&&c.push(b[d]);return c};s("Haskell_Main",{Bool:Boolean,isArray:ea,
isDefined:G,slice:t,imap:x,ifilter:L,indexOf:H,lastIndexOf:Q,isort:va,range:wa,extend:ua,namespace:s,typeOf:B,strictEq:ga,strictNe:ha,unsafeAdd:ia,unsafeSub:ja,unsafeMul:ka,unsafeDiv:la,lt:ma,le:na,gt:oa,ge:pa,negate:qa,evalThunks:xa,toArray:R,curry:ra,error:p});var C={};r=new J;s("Haskell_Expression",{operators:C,infix:Aa,infixl:ya,infixr:za,op:Ea,no:Da,resolve:u,recurse:r,Recurse:J,exl:Fa,exs:Ga});s("Haskell_Do",{createDo:Ha,Scope:S});M.prototype.put=function(a,b){this.keys.push(a);this.values.push(b)};
M.prototype.get=function(a){a=H(a,this.keys);if(a!=-1)return this.values[a]};var N={};s("Haskell_TypeClass",{typeclass:Ia,VARARG:N,instance:Ja,getInstance:Ka,asTypeOf:La});var aa=new T;D.prototype.toString=U();D.prototype.dataConstructorToString=U(true);D.prototype.update=sa(p);s("Haskell_DataType",{data:Na,ADT:D,record:aa,accessor:Ma,accessors:{}})})();(function(){namespace("Haskell");importSubmodules("Haskell",["Main","DataType","TypeClass","Expression","Do"])})()})();
