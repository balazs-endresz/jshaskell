/*

 JSHaskell - Some Haskell language features for JavaScript

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.

 ------------------------------------------------------------

*/
(function(){(function(){function t(a,b){return H[a]=b||{}}function ka(a,b){for(var c=H[a],d=0,e=b.length;d<e;++d){var f=H[a+"_"+b[d]];for(var g in f)c[g]=f[g]}}function la(a){return ma.call(a)=="[object Array]"}function I(a){return a!==A}function na(a,b){return a===b}function oa(a,b){return a!==b}function pa(a,b){return a<b}function qa(a,b){return a<=b}function ra(a,b){return a>b}function sa(a,b){return a>=b}function Q(a){return-a}function R(a){return a===true?false:a===false?true:p(R)}function B(a){var b=
a.constructor;if(b)return b;a=typeof a;return a=="string"?String:a=="number"?Number:a=="boolean"?Boolean:a=="function"?Function:A}function S(a){function b(){var c=q(arguments);return c.length>=(a._length===A?a.length:a._length)?a.apply(null,c):function(){return b.apply(null,c.concat(q(arguments)))}}return b}function ta(a){return function(){return a}}function ua(a){var b=q(arguments,1);return function(){return a.apply(null,b)}}function va(){function a(b){return!b?[]:[[b.name||b._name||b,b.arguments]].concat(a(b.caller))}
return a(arguments.callee.caller)}function p(a){a=(a instanceof Function?a.name||a._name:null)||a||"Unspecified error";var b=new Error(a);try{b.stackTrace=va()}catch(c){}b.message=a;throw b;}function wa(a,b){for(var c in b)a[c]=b[c];return a}function F(a,b){if(b.indexOf)return b.indexOf(a);var c=b.length;if(!c)return-1;for(var d=0;d<c;d++)if(b[d]===a)return d;return-1}function T(a,b){if(b.lastIndexOf)return b.lastIndexOf(a);var c=b.length;if(!c)return-1;for(c=c-1;c>-1;--c)if(b[c]===a)return c;return-1}
function xa(a){if(a.sort)return a.sort();return q(a).sort().join("")}function ya(a,b){for(var c=[],d=0,e=b.length;d<e;++d)c[d]=a(b[d]);return c}function za(a,b){for(var c=[],d=0,e=b.length;d<e;++d)a(b[d])&&c.push(b[d]);return c}function Aa(a,b){return function(){return a(b.apply(null,arguments))}}function U(a,b){return function(c){var d=q(arguments,1);d.unshift(b(c));return a.apply(null,d)}}function Ba(a){return function(b,c){return a(c,b)}}function V(a,b){if(typeof a=="string"&&typeof b=="string")return a+
b;return[a].concat(b)}function Ca(a,b){if(typeof a=="string"&&typeof b=="string")return a+b;return a+b.join("")}function Da(a){return!a.length}function Ea(a,b){var c=b.constructor==Array;return a.constructor==Array?a.concat(c?b:b.split("")):a.concat(c?b.join(""):b)}function Fa(a,b){return(b.indexOf?b.indexOf(a):F(a,b))!=-1}function Ga(a){return parseInt(a.join?a.join(""):a,16)}function Ha(a){return parseInt(a.join?a.join(""):a,8)}function W(a){a=parseInt(a,16);return isNaN(a)?p(W):a}function Ia(a,
b){return{indexOf:function(c){return c>=a&&c<=b?true:-1},toString:function(){return"range("+a+", "+b+")"}}}function Ja(a,b){function c(){try{var e=b;do a=a()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()();while(--e);setTimeout(c,1)}catch(f){}}if(!b||b==Infinity){try{for(;a=a()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()(););
}catch(d){}return a}c()}function Ka(a){return["l",a]}function C(a){return["r",a]}function La(a){return["x",a]}function Ma(a){if(a)if(!a._String){var b=D[a];if(a._Op&&!b)return"l";return b&&(b.fixity[0]||"l")}}function Na(a){if(a)if(!a._String){var b=D[a];if(a._Op&&!b)return 9;return b&&(I(b.fixity[1])?b.fixity[1]:9)}}function J(){}function K(a,b,c){var d;if(a[b]._Op){delete a[b]._Op;d=a[b]}else d=D[a[b]].func;d=d(a[b-1],a[b+1]);a.splice(b-1,3,d);return u(a,c)}function Oa(a){if(typeof a=="string"){a=
new String(a);a._String=true;return a}else{a._Array=true;return a}}function Pa(a){a._Op=true;return a}function u(a,b){a=x(function(h){if(!h)return h;if(h._Array){delete h._Array;return h}return h.constructor==Array?u(h,b):h.CallStream?h.resolve(b):h},a);if(b)a=x(function(h){return h instanceof J?b:h},a);for(var c=[],d=[],e=0,f=a.length;e<f;++e){var g=a[e],i=false;if(D[g])i=true;if(g&&g._String){i=false;g=g.toString()}if(g&&g._Op)i=true;if(!i&&e!=f-1)c.push(g);else{e==f-1&&c.push(g);c=c.length>1?c[0].apply(null,
c.slice(1)):c[0];d.push(c);e!=f-1&&d.push(g);c=[]}}a=d;d=x(Ma,a);f=x(Na,a);g=L(I,f).sort().pop();e=F(g,f);f=T(g,f);return d[e]=="l"?K(a,e,b):d[f]=="r"?K(a,f,b):d[e]=="x"?K(a,e,b):a[0]}function Qa(a){return function(){function b(){return e.apply(null,arguments)}function c(){return(f?e:c.resolve()).apply(null,arguments)}var d=arguments,e,f;c.resolve=function(g){if(f)return e;e=u(d,g||b);d=null;f=true;return e};c.CallStream=true;c.constructor=a;return c}}function Ra(){return u(q(arguments))}function X(a){this.scope=
a}function Sa(a){return function(){function b(){return e.apply(null,arguments)}function c(g){if(f||g instanceof X)return(f?e:c.resolve()).apply(null,arguments);d.push(u(arguments,b));return c}var d=[],e,f;d.push(u(arguments,b));c.resolve=function(){if(f)return e;e=a.do_.apply(null,d);f=true;d=null;return e};c.CallStream=true;c.constructor=a._type;return c}}function M(){this.keys=[];this.values=[]}function Ta(a,b){var c={};c._context=[];c._name=a;c._dict=new M;c.context=function(){this._context=q(arguments);
delete c.context;return this};c.types=function(d){this._fnTypes=d;delete c.types;return this};c.impl=function(d){this._default=d;for(var e in c._fnTypes)(function(f,g){c[f]=g!==A&&g.constructor!=Array?(typeof d=="function"?d():d)[f]:function(){var i=arguments,h;if(g===A||g===N)p("There's no type signature for "+c._name+"."+f+", it can be accessed only by: getInstance("+c._name+", SomeType)."+f);var l,y=L(function(k,m){m=g[m];if(l||m==N)return l=true;k=B(k);if(m==b){h=h||k;return h==k}else return k==
m},i);!l&&y.length!=g.length-1&&p("Type error in "+c._name+"."+f);(y=c._dict.get(h))||p("No "+c._name+" instance for "+(h.name||h._name));return y[f].apply(null,i)}})(e,c._fnTypes[e]);delete c.impl;return this};return c}function Ua(a,b,c){x(function(g){if(!g._dict.get(b))throw"No "+(g._name||"")+" instance for "+(b.name||b._name);},a._context);var d={};d._type=b;a._dict.put(b,d);c=typeof c=="function"?c(d):c||{};var e=a._default;e=typeof e=="function"?e(d):e;for(var f in a._fnTypes)d[f]=c[f]||e[f];
return d}function Va(a,b){return a._dict.get(b)}function Wa(a,b,c){return a._dict.get(B(c))[b]}function Xa(a,b){return b?b[a]:function(c){return c[a]}}function Y(){}function E(){}function Z(a){return function(){var b=[],c=this._recordset;if(c&&c.constructor!=Array){for(var d in c){var e=a?c[d].name||c[d]:this[d];if(!a&&e instanceof Function)e=e.constructor!=Function?e.constructor.name:"Function("+e.name+")";b.push(d+(a?" :: ":" = ")+e)}c=replicate(this._dataConstructor.length+2," ").join("");b="{"+
b.join("\n"+c+",")+"\n"+c+"}"}else{for(d=0;d in this;d++)b.push(a?c[d].name||c[d]:this[d]);b=b.join(" ")}return"("+this._dataConstructor+(b?" ":"")+b+")"}}function $(a,b,c,d,e){p("Type error: expecting "+a.name+" instead of "+b.name+" in the argument '"+c+"' of "+d+"."+e)}function Ya(a,b){function c(h,l){function y(Za,aa){var r=Za instanceof Y,n=new a,z,s;n.constructor=a;n._recordset=k&&l[0]||l;n._dataConstructor=h;n[h]=true;if(r)for(var o in aa){r=aa[o];k||p("Records are not defined for "+d+"."+
h);o in m||p("The accessor '"+o+"' is not defined for "+d+"."+h);s=m[o];if(typeof s!="string"){z=B(r);z!=s&&$(s,z,o,d,h)}n[o]=r;n[ba[o]]=r}else{o=arguments;for(var v=0,$a=o.length;v<$a;++v){r=o[v];s=l[v];if(typeof s!="string"){z=B(r);z!=s&&$(s,z,v,d,h)}n[v]=r;if(k)n[ca[v]]=r}}n.update=function(da){var ea={};for(var G in m)ea[G]=G in da?da[G]:this[G];return y(fa,ea)};return n}var k=l&&typeof l[0]=="object",m=k&&l[0];if(k){var O=0,w,ba={},ca={};for(w in m){var P=w.charAt(0);if(P=="_"||P==P.toUpperCase())throw d+
"."+i+"."+w+": record names can't start with underscore or uppercase letters";if(w in{update:1})throw d+"."+i+"."+w+": record name is invalid";ba[w]=O;ca[O]=w;O++}}return y}var d=a.name;if(a._constructors)throw"Type constructor has been already defined: '"+d+"'";a._constructors=b;a.prototype=new E;for(var e=0,f=b.length;e<f;++e){var g=typeof b[e]!="object",i=g?b[e]:b[e][0];if(i in a)throw"The name of the data constructor ("+d+"."+i+") is invalid!";a[i]=g?c(i)():c(i,q(b[e],1));if(!g)a[i]._length=b[e].length-
1}}var j=function(){return this}()||window,H=j.NS||(j.NS={}),A,ma={}.toString,ga=[].slice,ha=[].map,ia=[].filter;(function(){return this}).toString().indexOf("this");(function(){var a={9:1,d:1,b:1,0:1,a:1,c:1},b=[9,"d","b",0,"a","c"],c=0;for(var d in a)if(d!=b[c++])return false;return true})();j.global=j;j.namespace=t;j.importSubmodules=ka;j=function(a){return a};var ja=S(function(a,b){return a(b)}),q="a"[0]?function(a,b){return ga.call(a,b||0)}:function(a,b){if(typeof a=="string"){a=a.split("");
if(!b)return a}return ga.call(a,b||0)},x=ha?function(a,b){return ha.call(b,a)}:function(a,b){for(var c=[],d=0,e=b.length;d<e;++d)c[d]=a(b[d],d,b);return c},L=ia?function(a,b){return ia.call(b,a)}:function(a,b){for(var c=[],d=0,e=b.length;d<e;++d)a(b[d],d,b)&&c.push(b[d]);return c};t("Haskell_Main",{curry:S,const_:ta,isArray:la,isDefined:I,slice:q,map:ya,imap:x,filter:za,ifilter:L,indexOf:F,lastIndexOf:T,isort:xa,compose:Aa,compose1:U,call:ja,id:j,flip:Ba,cons:V,consJoin:Ca,negate:Q,null_:Da,elem:Fa,
digitToInt:W,range:Ia,extend:wa,namespace:t,toInteger:parseInt,fromInteger:j,fromIntegral:j,readHex:Ga,readOct:Ha,chr:String.fromCharCode,round:Math.round,typeOf:B,strictEq:na,strictNe:oa,lt:pa,le:qa,gt:ra,ge:sa,not:R,negate:Q,evalThunks:Ja});var D={$:{func:ja,fixity:C(0)},".":{func:U,fixity:C(9)},":":{func:V,fixity:C(5)},"++":{func:Ea,fixity:C(5)}};j=new J;t("Haskell_Expression",{operators:D,infix:La,infixl:Ka,infixr:C,op:Pa,no:Oa,resolve:u,recurse:j,Recurse:J,exl:Qa,exs:Ra});t("Haskell_Do",{createDo:Sa,
Scope:X});M.prototype.put=function(a,b){this.keys.push(a);this.values.push(b)};M.prototype.get=function(a){a=F(a,this.keys);if(a!=-1)return this.values[a]};var N={};t("Haskell_TypeClass",{typeclass:Ta,VARARG:N,instance:Ua,getInstance:Va,asTypeOf:Wa});var fa=new Y;E.prototype.toString=Z();E.prototype.dataConstructorToString=Z(true);E.prototype.update=ua(p);t("Haskell_DataType",{data:Ya,ADT:E,record:fa,accessor:Xa,accessors:{}})})();(function(){namespace("Haskell");importSubmodules("Haskell",["Main",
"DataType","TypeClass","Expression","Do"])})()})();
