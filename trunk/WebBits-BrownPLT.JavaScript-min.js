/*

 JavaScript analysis tools based on JSParsec

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.

 This is a port of the WebBits library (BrownPLT.JavaScript):
 http://hackage.haskell.org/package/WebBits-2.0
 Copyright (c) 2007-2009 Arjun Guha, Claudiu Saftoiu, and Spiridon Eliopoulos

 ------------------------------------------------------------


 JSParsec - A parser combinator library for JavaScript

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.


 The initial implementation of some combinators,
 and the memoization technique is derived from:
 http://www.bluishcoder.co.nz/2007/10/javascript-parser-combinators.html

 Most functions should behave like their counterparts in Parsec 3:
 http://www.haskell.org/haskellwiki/Parsec

 ------------------------------------------------------------


 JSHaskell - Some Haskell language features for JavaScript

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.

 ------------------------------------------------------------

*/
(function(){(function(){function B(a,e){return ha[a]=e||{}}function kb(a,e){for(var i=ha[a],l=0,s=e.length;l<s;++l){var G=ha[a+"_"+e[l]];for(var J in G)i[J]=G[J]}}function W(a){return ea.call(a)=="[object Array]"}function aa(a){return a!==la}function O(a,e){return a===e}function fa(a,e){return a!==e}function lb(a,e){return a<e}function za(a,e){return a<=e}function D(a,e){return a>e}function va(a,e){return a>=e}function o(a){return-a}function M(a){return a===true?false:a===false?true:ra(M)}function Ka(a){var e=
a.constructor;if(e)return e;a=typeof a;return a=="string"?String:a=="number"?Number:a=="boolean"?Boolean:a=="function"?Function:la}function mb(a){function e(){var i=wa(arguments);return i.length>=(a._length===la?a.length:a._length)?a.apply(null,i):function(){return e.apply(null,i.concat(wa(arguments)))}}return e}function Ya(a){return function(){return a}}function Za(a){var e=wa(arguments,1);return function(){return a.apply(null,e)}}function xb(){function a(e){return!e?[]:[[e.name||e._name||e,e.arguments]].concat(a(e.caller))}
return a(arguments.callee.caller)}function ra(a){a=(a instanceof Function?a.name||a._name:null)||a||"Unspecified error";var e=new Error(a);try{e.stackTrace=xb()}catch(i){}e.message=a;throw e;}function yb(a,e){for(var i in e)a[i]=e[i];return a}function Ha(a,e){if(e.indexOf)return e.indexOf(a);var i=e.length;if(!i)return-1;for(var l=0;l<i;l++)if(e[l]===a)return l;return-1}function zb(a,e){if(e.lastIndexOf)return e.lastIndexOf(a);var i=e.length;if(!i)return-1;for(i=i-1;i>-1;--i)if(e[i]===a)return i;
return-1}function U(a){if(a.sort)return a.sort();return wa(a).sort().join("")}function Ab(a,e){for(var i=[],l=0,s=e.length;l<s;++l)i[l]=a(e[l]);return i}function sb(a,e){for(var i=[],l=0,s=e.length;l<s;++l)a(e[l])&&i.push(e[l]);return i}function Bb(a,e){return function(){return a(e.apply(null,arguments))}}function $a(a,e){return function(i){var l=wa(arguments,1);l.unshift(e(i));return a.apply(null,l)}}function nb(a){return function(e,i){return a(i,e)}}function Kb(a,e){if(typeof a=="string"&&typeof e==
"string")return a+e;return[a].concat(e)}function Cb(a,e){if(typeof a=="string"&&typeof e=="string")return a+e;return a+e.join("")}function La(a){return!a.length}function ab(a,e){var i=e.constructor==Array;return a.constructor==Array?a.concat(i?e:e.split("")):a.concat(i?e.join(""):e)}function V(a,e){return(e.indexOf?e.indexOf(a):Ha(a,e))!=-1}function bb(a){return parseInt(a.join?a.join(""):a,16)}function Ma(a){return parseInt(a.join?a.join(""):a,8)}function cb(a){a=parseInt(a,16);return isNaN(a)?ra(cb):
a}function X(a,e){return{indexOf:function(i){return i>=a&&i<=e?true:-1},toString:function(){return"range("+a+", "+e+")"}}}function Aa(a,e){function i(){try{var s=e;do a=a()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()();while(--s);setTimeout(i,1)}catch(G){}}if(!e||e==Infinity){try{for(;a=a()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()(););
}catch(l){}return a}i()}function Ra(a){return["l",a]}function E(a){return["r",a]}function tb(a){return["x",a]}function Db(a){if(a)if(!a._String){var e=ma[a];if(a._Op&&!e)return"l";return e&&(e.fixity[0]||"l")}}function Eb(a){if(a)if(!a._String){var e=ma[a];if(a._Op&&!e)return 9;return e&&(aa(e.fixity[1])?e.fixity[1]:9)}}function db(){}function eb(a,e,i){var l;if(a[e]._Op){delete a[e]._Op;l=a[e]}else l=ma[a[e]].func;l=l(a[e-1],a[e+1]);a.splice(e-1,3,l);return Q(a,i)}function Lb(a){if(typeof a=="string"){a=
new String(a);a._String=true;return a}else{a._Array=true;return a}}function Va(a){a._Op=true;return a}function Q(a,e){a=Ba(function(S){if(!S)return S;if(S._Array){delete S._Array;return S}return S.constructor==Array?Q(S,e):S.CallStream?S.resolve(e):S},a);if(e)a=Ba(function(S){return S instanceof db?e:S},a);for(var i=[],l=[],s=0,G=a.length;s<G;++s){var J=a[s],ia=false;if(ma[J])ia=true;if(J&&J._String){ia=false;J=J.toString()}if(J&&J._Op)ia=true;if(!ia&&s!=G-1)i.push(J);else{s==G-1&&i.push(J);i=i.length>
1?i[0].apply(null,i.slice(1)):i[0];l.push(i);s!=G-1&&l.push(J);i=[]}}a=l;l=Ba(Db,a);G=Ba(Eb,a);J=ob(aa,G).sort().pop();s=Ha(J,G);G=zb(J,G);return l[s]=="l"?eb(a,s,e):l[G]=="r"?eb(a,G,e):l[s]=="x"?eb(a,s,e):a[0]}function xa(a){return function(){function e(){return s.apply(null,arguments)}function i(){return(G?s:i.resolve()).apply(null,arguments)}var l=arguments,s,G;i.resolve=function(J){if(G)return s;s=Q(l,J||e);l=null;G=true;return s};i.CallStream=true;i.constructor=a;return i}}function ca(){return Q(wa(arguments))}
function A(a){this.scope=a}function Mb(a){return function(){function e(){return s.apply(null,arguments)}function i(J){if(G||J instanceof A)return(G?s:i.resolve()).apply(null,arguments);l.push(Q(arguments,e));return i}var l=[],s,G;l.push(Q(arguments,e));i.resolve=function(){if(G)return s;s=a.do_.apply(null,l);G=true;l=null;return s};i.CallStream=true;i.constructor=a._type;return i}}function Ca(){this.keys=[];this.values=[]}function sa(a,e){var i={};i._context=[];i._name=a;i._dict=new Ca;i.context=
function(){this._context=wa(arguments);delete i.context;return this};i.types=function(l){this._fnTypes=l;delete i.types;return this};i.impl=function(l){this._default=l;for(var s in i._fnTypes)(function(G,J){i[G]=J!==la&&J.constructor!=Array?(typeof l=="function"?l():l)[G]:function(){var ia=arguments,S;if(J===la||J===Sa)ra("There's no type signature for "+i._name+"."+G+", it can be accessed only by: getInstance("+i._name+", SomeType)."+G);var na,fb=ob(function(oa,Wa){Wa=J[Wa];if(na||Wa==Sa)return na=
true;oa=Ka(oa);if(Wa==e){S=S||oa;return S==oa}else return oa==Wa},ia);!na&&fb.length!=J.length-1&&ra("Type error in "+i._name+"."+G);(fb=i._dict.get(S))||ra("No "+i._name+" instance for "+(S.name||S._name));return fb[G].apply(null,ia)}})(s,i._fnTypes[s]);delete i.impl;return this};return i}function r(a,e,i){Ba(function(J){if(!J._dict.get(e))throw"No "+(J._name||"")+" instance for "+(e.name||e._name);},a._context);var l={};l._type=e;a._dict.put(e,l);i=typeof i=="function"?i(l):i||{};var s=a._default;
s=typeof s=="function"?s(l):s;for(var G in a._fnTypes)l[G]=i[G]||s[G];return l}function Na(a,e){return a._dict.get(e)}function H(a,e,i){return a._dict.get(Ka(i))[e]}function d(a,e){return e?e[a]:function(i){return i[a]}}function c(){}function j(){}function z(a){return function(){var e=[],i=this._recordset;if(i&&i.constructor!=Array){for(var l in i){var s=a?i[l].name||i[l]:this[l];if(!a&&s instanceof Function)s=s.constructor!=Function?s.constructor.name:"Function("+s.name+")";e.push(l+(a?" :: ":" = ")+
s)}i=replicate(this._dataConstructor.length+2," ").join("");e="{"+e.join("\n"+i+",")+"\n"+i+"}"}else{for(l=0;l in this;l++)e.push(a?i[l].name||i[l]:this[l]);e=e.join(" ")}return"("+this._dataConstructor+(e?" ":"")+e+")"}}function ba(a,e,i,l,s){ra("Type error: expecting "+a.name+" instead of "+e.name+" in the argument '"+i+"' of "+l+"."+s)}function P(a,e){function i(S,na){function fb(Vb,Ia){var k=Vb instanceof c,pa=new a,da,ta;pa.constructor=a;pa._recordset=oa&&na[0]||na;pa._dataConstructor=S;pa[S]=
true;if(k)for(var Da in Ia){k=Ia[Da];oa||ra("Records are not defined for "+l+"."+S);Da in Wa||ra("The accessor '"+Da+"' is not defined for "+l+"."+S);ta=Wa[Da];if(typeof ta!="string"){da=Ka(k);da!=ta&&ba(ta,da,Da,l,S)}pa[Da]=k;pa[gb[Da]]=k}else{Da=arguments;for(var ga=0,Oa=Da.length;ga<Oa;++ga){k=Da[ga];ta=na[ga];if(typeof ta!="string"){da=Ka(k);da!=ta&&ba(ta,da,ga,l,S)}pa[ga]=k;if(oa)pa[Fb[ga]]=k}}pa.update=function(qa){var Gb={};for(var hb in Wa)Gb[hb]=hb in qa?qa[hb]:this[hb];return fb(pb,Gb)};
return pa}var oa=na&&typeof na[0]=="object",Wa=oa&&na[0];if(oa){var qb=0,Ta,gb={},Fb={};for(Ta in Wa){var Hb=Ta.charAt(0);if(Hb=="_"||Hb==Hb.toUpperCase())throw l+"."+ia+"."+Ta+": record names can't start with underscore or uppercase letters";if(Ta in{update:1})throw l+"."+ia+"."+Ta+": record name is invalid";gb[Ta]=qb;Fb[qb]=Ta;qb++}}return fb}var l=a.name;if(a._constructors)throw"Type constructor has been already defined: '"+l+"'";a._constructors=e;a.prototype=new j;for(var s=0,G=e.length;s<G;++s){var J=
typeof e[s]!="object",ia=J?e[s]:e[s][0];if(ia in a)throw"The name of the data constructor ("+l+"."+ia+") is invalid!";a[ia]=J?i(ia)():i(ia,wa(e[s],1));if(!J)a[ia]._length=e[s].length-1}}var Z=function(){return this}()||window,ha=Z.NS||(Z.NS={}),la,ea={}.toString,Ea=[].slice,Fa=[].map,ub=[].filter;(function(){return this}).toString().indexOf("this");(function(){var a={9:1,d:1,b:1,0:1,a:1,c:1},e=[9,"d","b",0,"a","c"],i=0;for(var l in a)if(l!=e[i++])return false;return true})();Z.global=Z;Z.namespace=
B;Z.importSubmodules=kb;Z=function(a){return a};var ib=mb(function(a,e){return a(e)}),wa="a"[0]?function(a,e){return Ea.call(a,e||0)}:function(a,e){if(typeof a=="string"){a=a.split("");if(!e)return a}return Ea.call(a,e||0)},Ba=Fa?function(a,e){return Fa.call(e,a)}:function(a,e){for(var i=[],l=0,s=e.length;l<s;++l)i[l]=a(e[l],l,e);return i},ob=ub?function(a,e){return ub.call(e,a)}:function(a,e){for(var i=[],l=0,s=e.length;l<s;++l)a(e[l],l,e)&&i.push(e[l]);return i};B("Haskell_Main",{curry:mb,const_:Ya,
isArray:W,isDefined:aa,slice:wa,map:Ab,imap:Ba,filter:sb,ifilter:ob,indexOf:Ha,lastIndexOf:zb,isort:U,compose:Bb,compose1:$a,call:ib,id:Z,flip:nb,cons:Kb,consJoin:Cb,negate:o,null_:La,elem:V,digitToInt:cb,range:X,extend:yb,namespace:B,toInteger:parseInt,fromInteger:Z,fromIntegral:Z,readHex:bb,readOct:Ma,chr:String.fromCharCode,round:Math.round,typeOf:Ka,strictEq:O,strictNe:fa,lt:lb,le:za,gt:D,ge:va,not:M,negate:o,evalThunks:Aa});var ma={$:{func:ib,fixity:E(0)},".":{func:$a,fixity:E(9)},":":{func:Kb,
fixity:E(5)},"++":{func:ab,fixity:E(5)}};Z=new db;B("Haskell_Expression",{operators:ma,infix:tb,infixl:Ra,infixr:E,op:Va,no:Lb,resolve:Q,recurse:Z,Recurse:db,exl:xa,exs:ca});B("Haskell_Do",{createDo:Mb,Scope:A});Ca.prototype.put=function(a,e){this.keys.push(a);this.values.push(e)};Ca.prototype.get=function(a){a=Ha(a,this.keys);if(a!=-1)return this.values[a]};var Sa={};B("Haskell_TypeClass",{typeclass:sa,VARARG:Sa,instance:r,getInstance:Na,asTypeOf:H});var pb=new c;j.prototype.toString=z();j.prototype.dataConstructorToString=
z(true);j.prototype.update=Za(ra);B("Haskell_DataType",{data:P,ADT:j,record:pb,accessor:d,accessors:{}})})();(function(){namespace("Haskell");importSubmodules("Haskell",["Main","DataType","TypeClass","Expression","Do"])})();(function(){function B(d){d.constructor=sa["Tuple"+d.length];return d}function kb(){}function W(){}function aa(){}function O(){}function fa(d){var c=stringAsArray||typeof arr!="string"?d[0]:d.charAt(0);d=bb(d,1);var j=[c,d];j.head=c;j.tail=d;j.constructor=sa.Tuple2;return j}function lb(d,
c){var j=c.length;if(!j)return W.Nothing;for(var z=A(r,E(c[0])),ba=0;ba<j;++ba)if(z.eq(c[ba],d))return W.Just(ba);return W.Nothing}function za(d,c){var j=c.length;if(!j)return W.Nothing;for(var z=0;z<j;++z)if(c[z][0]===d)return W.Just(c[z][1]);return W.Nothing}function D(d){function c(j,z){j=Na.compare(j,z);return j.LT?-1:j.GT?1:j.EQ?0:error(D)}if(d.sort)return d.sort(c);return bb(d).sort(c).join("")}function va(d){function c(j,z){var ba=j.constructor==Array;x=ba?j[0]:j.charAt(0);xs=ba?j.slice(1):
j.substr(1);return!j.length?[]:Aa(x,z)?c(xs,z):X(x,c(xs,X(x,z)))}return c(d,[])}function o(d,c,j){if(j.Nothing)return d;if(j.Just)return c(j[0])}function M(d,c){return d===c?aa.EQ:d<=c?aa.LT:aa.GT}function Ka(d,c){if(c.length)if(d(c[0])){d=Ka(d,bb(c,1));c=[X(c[0],d[0]),d[1]]}else c=[[],c];else c=[c,c];c.constructor=sa.Tuple2;return c}function mb(d){return d[0]}function Ya(d){return d[1]}function Za(d){return function(c){return d(c[0],c[1])}}function xb(d,c,j){return d(j)?j:xb(d,c,c(j))}function ra(d){return function(){return rhs(ra(d))}}
function yb(d){return function(c){return c(c)}(function(c){return function(){return d(c(c)).apply(null,arguments)}})}function Ha(d){return/^\s$/.test(d)}function zb(d){return d.toUpperCase()==d}function U(d){return d.toLowerCase()==d}function Ab(d){return/^\w$/.test(d)}function sb(d){return/^\w$/.test(d)&&/^\D$/.test(d)}function Bb(d){return/^\d$/.test(d)}function $a(d){return/^[0-9A-Fa-f]$/.test(d)}function nb(d){return/^[0-7]$/.test(d)}function Kb(d,c,j){for(var z=0,ba=j.length;z<ba;++z)c=d(c,j[z]);
return c}function Cb(d,c,j){for(var z=j.length-1;z>-1;--z)c=d(j[z],c);return c}function La(d,c){for(var j=[],z=0,ba=Math.min(d.length,c.length);z<ba;++z)j[z]=[d[z],c[z]];return j}function ab(d,c){for(var j=[],z=0;z<d;++z)j[z]=c;return j}var V=NS.Haskell.const_,bb=NS.Haskell.slice,Ma=NS.Haskell.map,cb=NS.Haskell.imap,X=NS.Haskell.cons,Aa=NS.Haskell.elem,Ra=NS.Haskell.namespace,E=NS.Haskell.typeOf,tb=NS.Haskell.strictEq,Db=NS.Haskell.strictNe,Eb=NS.Haskell.lt,db=NS.Haskell.le,eb=NS.Haskell.gt,Lb=NS.Haskell.ge,
Va=NS.Haskell.data,Q=NS.Haskell.typeclass,xa=NS.Haskell.VARARG,ca=NS.Haskell.instance,A=NS.Haskell.getInstance,Mb=NS.Haskell.createDo,Ca=NS.Haskell.Scope,sa={};cb(function(d){var c="Tuple"+d;sa[c]=function(){};sa[c]._name=c;sa["tuple"+d]=function(j){j.constructor=sa[c];return j}},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]);sa.tuple=B;Va(kb,["Unit"]);Va(W,[["Just","a"],"Nothing"]);Va(aa,["LT","EQ","GT"]);Va(O,[["Left","a"],["Right","b"]]);var r=Q("Eq","a").types({eq:["a","a",Boolean],ne:["a","a",Boolean]}).impl(function(d){return{eq:function(c,
j){return!d.ne(c,j)},ne:function(c,j){return!d.eq(c,j)}}});ca(r,Number,{eq:tb,ne:Db});ca(r,String,{eq:tb,ne:Db});ca(r,Boolean,{eq:tb,ne:Db});ca(r,RegExp,{eq:function(d,c){return d.source===c.source&&d.global===c.global&&d.ignoreCase===c.ignoreCase&&d.multiline===c.multiline}});ca(r,Array,{eq:function(d,c){var j=d.length;if(j!=c.length)return false;for(var z=0;z<j;++z)if(!r.eq(d[z],c[z]))return false;return true}});ca(r,Object,{eq:function(d,c){var j,z={};for(j in d)z[j]=true;for(j in c)z[j]=true;
for(j in z)if(!r.eq(d[j],c[j]))return false;return true}});ca(r,aa,{eq:function(d,c){return d.EQ&&c.EQ?true:d.LT&&c.LT?true:d.GT&&c.GT?true:false}});var Na=Q("Ord","a").context(r).types({compare:["a","a",aa],"<":["a","a",Boolean],"<=":["a","a",Boolean],">":["a","a",Boolean],">=":["a","a",Boolean],max:["a","a","a"],min:["a","a","a"]}).impl(function(d){return{compare:function(c,j){return r.eq(c,j)?aa.EQ:d["<="](c,j)?aa.LT:aa.GT},"<":function(c,j){return d.compare(c,j).LT?true:false},"<=":function(c,
j){return d.compare(c,j).GT?false:true},">":function(c,j){return d.compare(c,j).GT?true:false},">=":function(c,j){return d.compare(c,j).LT?false:true},max:function(c,j){return d["<="](c,j)?j:c},min:function(c,j){return d["<="](c,j)?c:j}}});ca(Na,Boolean,{compare:function(d,c){return d===true&&c===false?aa.LT:d===false&&c===true?aa.GT:aa.EQ}});ca(Na,Number,{compare:function(d,c){return d===c?aa.EQ:d<=c?aa.LT:aa.GT},"<":Eb,"<=":db,">":eb,">=":Lb,max:function(d,c){return d<=c?c:d},min:function(d,c){return d<=
c?d:c}});ca(Na,aa,{"<=":function(d,c){return d.LT?true:c.LT?false:d.EQ?true:c.EQ?false:d.GT&&c.GT?true:error()}});cb=Q("Functor","f").types({fmap:[Function,"f","f"],"<$":["a","f","f"]}).impl(function(d){return{"<$":function(c,j){return d.fmap(V(c),j)}}});xa=Q("Monad","m").types({">>=":["m",Function,"m"],">>":["m","m","m"],return_:["a","m"],fail:[String,"m"],do_:xa,do$:xa,run:xa}).impl(function(d){return{">>":function(c,j){c=d[">>="](c,V(j));c.constructor=d._type;return c},fail:function(c){return error(c)},
do_:function(){function c(ba){for(var P=new Ca(ba),Z=1,ha=j.length,la=j[0];Z<ha;++Z)la=z(la,j[Z]);Z=_slice.call(arguments,1);Z.unshift(P);return la.apply(null,Z)}var j=arguments,z=d[">>"];c.constructor=d._type;return c},run:function(c){var j=bb(arguments,1);j.unshift(new Ca);return c.apply(null,j)},do$:Mb(d)}});var H=Q("Show","a").types({show:["a",String]}).impl({show:function(d){return d.toString()}});ca(H,Number);ca(H,Boolean);ca(H,RegExp);ca(H,Function,{show:function(d){var c=d.name||d._name||
"\u03bb";if(d.constructor)return c+" :: "+d.constructor.name;d=(d=d.toString().match(/\([^\)]*\)/))&&d[0]||"";return c+d}});ca(H,String,{show:function(d){return'"'+d.toString()+'"'}});ca(H,Array,{show:function(d){return typeof d[0]==String?'"'+d.join("")+'"':"["+Ma(H.show,d).join(", ")+"]"}});ca(H,Object,{show:function(d){var c=[];for(var j in d)c.push("  "+j+": "+H.show(d[j]));return"{\n"+d.join(",\n")+"\n}"}});Ra("Prelude",{Unit:kb,Tuple:sa,Maybe:W,Ordering:aa,Either:O,Eq:r,Ord:Na,Functor:cb,Monad:xa,
Show:H,foldl:Kb,foldr:Cb,zip:La,replicate:ab,sort:D,nub:va,maybe:o,lookup:za,span:Ka,elemIndex:lb,uncons:fa,compare:M,fst:mb,snd:Ya,uncurry:Za,until:xb,fix:yb,fix_:ra,isSpace:Ha,isUpper:zb,isLower:U,isAlpha:sb,isAlphaNum:Ab,isDigit:Bb,isHexDigit:$a,isOctDigit:nb})})();(function(){function B(b,f){this.input=b;this.index=f||0;this.length=b.length-this.index;this.cache={};return this}function kb(b){return new B(b)}function W(b){return function(f,h,q){return q({ast:null,success:false,expecting:{unexpected:b}})}}
function aa(b){return function(f,h,q){return q({success:false,expecting:b})}}function O(b,f,h){return h({success:false})}function fa(b){return typeof b=="string"?R(b):z(b)?oa(b):b}function lb(b,f,h,q,u){var v=f instanceof B?f:kb(f);i(function(){return b(new Ta,v,function(t){t.state=v;delete t.index;delete t.length;if(t.success){delete t.error;delete t.expecting}else{t.error=za(t.expecting,t.state);q&&q(t.error)}h(t)})},u)}function za(b,f,h,q){h=h===undefined?f.index:h;if(typeof b=="string"){var u=
f.input.split("\n"),v=u.length,t=f.input.substr(h).split("\n").length;v=v-t+1;u=h-u.splice(0,v-1).join("\n").length;f=q||f.input.substr(h,b.length).substr(0,6);return'Unexpected "'+(f.length?f:"end of input")+(q?"":'", expecting "'+b)+'" at line '+v+" char "+u}if(z(b)){b=P(function(y){return typeof y=="object"?y.expecting:y},b);return za(b.join('" or "'),f)}else if(typeof b=="object")return za(b.expecting,f,b.at,b.unexpected)}function D(){}function va(b,f){return function(h,q,u){return function(){return b(h,
q,function(v){return v.success?function(){return f(v.ast)(h,q,u)}:u(v)})}}}function o(b,f){if(b=="scope")throw"Can't use 'scope' as an identifier!";return function(h,q,u){return function(){return f(h,q,function(v){if(v.success)h[b]=v.ast;return u(v)})}}}function M(b,f){f&&ba(arguments);return function(h,q,u){return function(){return function(){var v;if(typeof b=="string"){if(!(b in h))throw'Not in scope: "'+b+'"';v=h[b]}else v=b(h);return u({ast:v,success:true})}}}}function Ka(b){var f=ba(arguments,
1);return function(h){return b.apply(null,P(function(q){return h[q]},f))}}function mb(b,f,h){return h({ast:f.index,success:true})}function Ya(b){var f=typeof b;return function(h,q,u){q.scrollTo(f=="string"?h[b]:b);return u({success:true})}}function Za(b){return function(f,h,q){return q({ast:b,success:true})}}function xb(b,f){return C(o("a",b),o("b",f),M(function(h){return h.a(h.b)}))}function ra(b,f){return C(o("x1",f),Pa(b,"x1"))}function yb(b,f,h){return C(o("x1",f),o("x2",h),Pa(b,"x1","x2"))}function Ha(b,
f,h,q){return C(o("x1",f),o("x2",h),o("x3",q),Pa(b,"x1","x2","x3"))}function zb(b,f){return C(o("a",b),f,M("a"))}function U(b,f){function h(q,u,v){return function(){return b(q,u,function(t){function y(N){var $=N.expecting;if($)if($.constructor==Array)T=T.concat($);else T.push($);N.expecting=N.success?ja:T}var T=[];y(t);return t.ast!==ja?function(){return v(t)}:function(){return f(q,u,function(N){y(N);return v(N)})}})}}h.constructor=D;return h}function Ab(){var b=P(fa,arguments);return function(f,
h,q){for(var u=1,v=b.length,t=b[0];u<v;++u)t=U(t,b[u]);return t(f,h,q)}}function sb(b){return function(f,h,q){function u(T){return function(N,$,Qa){return function(){return T(N,$,function(ua){v++;if(!ua.success)return Qa(ua);ua.ast!==ja&&t.push(ua.ast);return v<y?u(b[v])(N,$,Qa):Qa(ua)})}}}var v=0,t=[],y=b.length;return function(){return u(b[v])(f,h,function(T){var N=T.success;return q({ast:t,success:N,expecting:N?ja:T.expecting})})}}}function Bb(b){return function(f){return function(h,q,u){function v(T){return function(N,
$,Qa){return function(){return T(N,$,function(ua){if(!ua.success)return Qa(ua);t=true;ua.ast!==ja&&y.push(ua.ast);return v(T)(N,$,Qa)})}}}var t=false,y=[];return function(){return v(f)(h,q,function(T){var N=!b||t&&b;return u({ast:N?y:ja,success:N,expecting:N?ja:T.expecting})})}}}}function $a(b){return function(f){var h=ic++,q=function(u,v,t){u=v.index;var y=v.getCached(h);if(y!==ja)return t(y);y=b(f,v,u);v.putCached(h,u,y);return t(y)};q.constructor=D;return q}}function nb(b){return function(f,h){var q=
ic++,u=function(v,t,y){var T=t.index,N=t.getCached(q);if(N!==ja)return y(N);return function(){return f(v,t,function($){$=b(h,$,t,T);t.putCached(q,T,$);return y($)})}};u.constructor=D;return u}}function Kb(b){return function(f,h,q){return b(f)(f,h,q)}}function Cb(b){function f(h,q){return C(o("x",h),o("xs",q),M(Ka(Fa,"x","xs")))}return Ia(f,K([]),b)}function La(b){return Ia(U,Pb,b)}function ab(b,f){return U(f,K(b))}function V(b){return ab(gb.Nothing,ra(gb.Just,b))}function bb(b){return U(C(b,K(null)),
K(null))}function Ma(b,f,h){return C(b,o("x",h),f,M("x"))}function cb(b){return C(b,w(b))}function X(b,f){return U(Aa(b,f),K([]))}function Aa(b,f){return C(o("x",b),o("xs",Ib(C(f,b))),Pa(Fa,"x","xs"))}function Ra(b,f){return C(o("x",b),U(C(f,o("xs",function(h,q,u){return E(b,f)(h,q,u)}),M(function(h){return Fa(h.scope.x,h.xs)})),M(function(h){return[h.x]})))}function E(b,f){return U(Ra(b,f),K([]))}function tb(b,f){return g(C(o("x",b),f,M("x")))}function Db(b,f){return Ib(C(o("x",b),f,M("x")))}function Eb(b,
f){return b<=0?K([]):Cb(pa(b,f))}function db(b,f,h){return U(Va(b,f),K(h))}function eb(b,f,h){return U(Lb(b,f),K(h))}function Lb(b,f){function h(q){var u=C(o("f",f),o("y",b),function(v,t,y){return h(v.f(q,v.y))(v,t,y)});return U(u,K(q))}return va(b,h)}function Va(b,f){function h(u){var v=C(o("f",f),o("y",q),M(function(t){return t.f(u,t.y)}));return U(v,K(u))}var q=va(b,h);return q}function Q(b,f,h){b=f.at(0);if(b.length){f.scroll(1);return h(make_result(b))}return h(_fail("anyToken"))}function xa(b,
f,h){return h(make_result(ja,!f.length,f.length?"end of input":ja))}function ca(b){return n(U(va(n(b),W),K(null)))}function A(b,f){function h(u,v,t){return q(u,v,t)}var q=U(C(f,K([])),C(o("x",b),o("xs",h),Pa(Fa,"x","xs")));return q}function Mb(b){return C(o("state",jc),o("x",b),kc("state"),M("x"))}function Ca(){}function sa(){}function r(b,f){function h(t,y){return function(T,N,$){return t(T[y])(T,N,$)}}function q(t,y){var T=t[0],N=y[0],$=y[1],Qa=y[2],ua=y[3];y=y[4];if(t.Infix){var Ua=t[1];if(Ua.AssocNone)return[N,
$,Fa(T,Qa),ua,y];if(Ua.AssocLeft)return[N,Fa(T,$),Qa,ua,y];if(Ua.AssocRight)return[Fa(T,N),$,Qa,ua,y]}if(t.Prefix)return[N,$,Qa,Fa(T,ua),y];if(t.Postfix)return[N,$,Qa,ua,Fa(T,y)]}function u(t,y){return n(C(y,lc("ambiguous use of a "+t+" associative operator")))}function v(t,y){function T(Ja){return I(L("f","<-",mc)("y","<-",L("z","<-",Wb)(h,N,"z"))(M,function(rb){return rb.f(Ja,rb.y)}),"<|>",Zb,"<|>",$b)}function N(Ja){return U(T(Ja),K(Ja))}function $(Ja){return I(L("f","<-",nc)("y","<-",Wb)(function(rb,
oc,rc){return Qa(rb.f(Ja,rb.y))(rb,oc,rc)}),"<|>",ac,"<|>",$b)}function Qa(Ja){return U($(Ja),K(Ja))}function ua(Ja){return L("f","<-",bc)("y","<-",Wb)(ac,"<|>",Zb,"<|>",$b,"<|>",M,function(rb){return rb.f(Ja,rb.y)})}var Ua=Ia(q,[[],[],[],[],[]],y),sc=Ua[1],tc=Ua[2],Qb=Ua[3];y=Ua[4];var mc=La(Ua[0]),nc=La(sc),bc=La(tc);Ua=Ga(La(Qb),"");y=Ga(La(y),"");var ac=u("right",mc),Zb=u("left",nc),$b=u("non",bc);y=U(y,K(ea));Ua=U(Ua,K(ea));var Wb=L("pre","<-",Ua)("x","<-",t)("post","<-",y)(M,function(Ja){return Ja.post(Ja.pre(Ja.x))});
return L("x","<-",Wb)(h,T,"x","<|>",h,$,"x","<|>",h,ua,"x","<|>",M,"x","<?>","operator").resolve()}return Vb(v,f,b)}function Na(){}function H(){}function d(b){function f(m){return h(R(m))}function h(m){return C(o("x",m),Fc,M("x"))}function q(m,Y,ka){return Gc(m,Y,ka)}function u(m,Y,ka){return Hc(m,Y,ka)}function v(m,Y,ka){return uc(m,Y,ka)}function t(m){return Ma(f("("),f(")"),m)}function y(m){return Ma(f("{"),f("}"),m)}function T(m){return Ma(f("<"),f(">"),m)}function N(m){return Ma(f("["),f("]"),
m)}function $(m){return X(m,vc)}function Qa(m){return X(m,wc)}function ua(m){return Aa(m,vc)}function Ua(m){return Aa(m,wc)}function sc(m){return C(p(m[0]),K(m[1]))}function tc(m){return n(C(R(m[0]),K(m[1])))}function Qb(m,Y){return L("digits","<-",g,Y)(M,function(ka){return Vb(function(Xa,cc){return m*Xa+pb(ob(cc))},0,ka.digits)})}function mc(m,Y,ka){return Rb(m,Y,ka)}function nc(m,Y){return(Y+e(ob(m)))/10}function bc(m){return m<0?1/bc(-m):a(Math.pow(10,m))}function ac(m){return I(L("fract","<-",
Nc)("expo","<-",ab,1,Ic)(M,function(Y){return a(m+Y.fract)*Y.expo}),"<|>",L("expo","<-",Ic)(M,function(Y){return a(m)*Y.expo}))}function Zb(m){return L("f","<-",ac,m)(Pa,Fb.Right,"f")}function $b(m){return I(h,"$",n,L(R(m))(ca,b.opLetter,"<?>","end of "+m))}function Wb(m){return oc(Z(b.reservedOpNames),m)}function Ja(m){function Y(Xa){return!Xa.length?K(null):C(Ga(ka(Xa[0]),""+m),Y(ba(Xa,1)))}function ka(Xa){return Gb(Xa)?U(p(Xa.toLowerCase()),p(Xa.toUpperCase())):p(Xa)}return b.caseSensitive?R(m):
C(Y(m),K(m))}function rb(m){return I(h,"$",n,L(Ja(m))(ca,b.identLetter,"<?>","end of "+m))}function oc(m,Y){function ka(Xa){if(!Xa.length)return false;var cc=Da(Xa[0],Y);return cc.LT?ka(ba(Xa,1)):cc.EQ?true:cc.GT?false:null}return ka(m)}function rc(m){m=b.caseSensitive?m:m.toLowerCase();return oc(Oc,m)}if(!b.LanguageDef)throw"Type error: unexpected '"+b.constructor.name+"', expecting 'GenLanguageDef.LanguageDef'";var Xb=cb(F(ga)),pc=L(n(R(b.commentLine)))(w,F(function(m){return m!="\n"}))(K,null),
ya=da(ba(b.commentEnd+b.commentStart)),Gc=I(C(n(R(b.commentEnd)),K(null)),"<|>",C(cb(xc(ya)),q),"<|>",C(vb(ya),q),"<?>","end of comment"),Hc=I(C(n(R(b.commentEnd)),K(null)),"<|>",C(v,u),"<|>",C(cb(xc(ya)),u),"<|>",C(vb(ya),u),"<?>","end of comment");ya=b.nestedComments?Hc:Gc;var uc=C(n(R(b.commentStart)),ya);ya=wa(b.commentLine);var wb=wa(b.commentStart),Fc=oa(ya&&wb?[w,[Xb,"<?>",""]]:ya?[w,[Xb,"<|>",uc,"<?>",""]]:wb?[w,[Xb,"<|>",pc,"<?>",""]]:[w,[Xb,"<|>",pc,"<|>",uc,"<?>",""]]),wc=f(";"),vc=f(",");
Xb=f(".");pc=f(":");ya=k(ba("abfnrtv\\\"'"),ba("a\u0008\u000c\n\r\t\u000b\\\"'"));wb=k(["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","SUB","ESC","DEL"].concat(["BS","HT","LF","VT","FF","CR","SO","SI","EM","FS","GS","RS","US","SP"]),["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","SUB","ESC","DEL"].concat(["BS","HT","LF","VT","FF","CR","SO","SI","EM","FS","GS","RS","US","SP"]));ya=La(P(sc,
ya));var Jb=La(P(tc,wb));wb=F(function(m){return m!='"'&&m!="\\"&&m>"\u0016"});var Sb=p("&"),dc=L(g,yc)(p("\\"),"<?>","end of string gap"),Tb=L("code","<-",mc,"<|>",C(p("o"),Qb(8,zc)),"<|>",C(p("x"),Qb(16,Ac)))(M(function(m){return toEnum(a(m.code))})),Nb=L(p("^"))("code","<-",Jc)(M(function(m){return toEnum(fromEnum(m.code)-fromEnum("A"))}));Jb=I(ya,"<|>",Tb,"<|>",Jb,"<|>",Nb,"<?>","escape code");ya=C(p("\\"),Jb);Tb=F(function(m){return m!="'"&&m!="\\"&&m>"\u0016"});ya=I(Tb,"<|>",ya,"<?>","literal character");
ya=I(h,[Ma,p("'"),[p("'"),"<?>","end of character"],ya],"<?>","character");Sb=L(p("\\"))(C(dc,K(gb.Nothing)),"<|>",C(Sb,K(gb.Nothing)),"<|>",L("esc","<-",Jb)(Pa,gb.Just,"esc"));wb=I(L("c","<-",wb)(Pa,gb.Just,"c"),"<|>",Sb,"<?>","string character");wb=I(h,[L("str","<-",Ma,p('"'),[p('"'),"<?>","end of string"],[Ib,wb])(M,function(m){return Ia(c(ta)(ea,c(Fa)),"",m.str)}),"<?>","literal string"]);var Rb=Qb(10,Bc);Sb=L(vb,"xX")(Qb,16,Ac);dc=L(vb,"oO")(Qb,8,zc);var Nc=I(L(p("."))("digits","<-",g,Bc,"<?>",
"fraction")(M,function(m){return Ia(nc,0,m.digits)}),"<?>","fraction");Jb=I([p("-"),">>",K,ib],"<|>",[p("+"),">>",K,ea],"<|>",K,ea);var Ic=I(L(vb,"eE")("f","<-",Jb)("e","<-",Rb,"<?>","exponent")(Pa,bc,"f","e"),"<?>","exponent");Tb=L("n","<-",Rb)(function(m,Y,ka){return ac(m.n)(m,Y,ka)});Nb=L("n","<-",Rb)(function(m,Y,ka){return ab(Fb.Left(m.n),Zb(m.n))(m,Y,ka)});var Ob=I(L("n","<-",Sb,"<|>",dc)(Pa,Fb.Left,"n"),"<|>",Nb,"<|>",Zb(0),"<|>",K,Fb.Left(0));Nb=I(C(p("0"),Ob),"<|>",Nb);Ob=I(L(p,"0")(Sb,"<|>",
dc,"<|>",Rb,"<|>",K,0),"<?>","");Ob=U(Ob,Rb);var ec=L("f","<-",h,Jb)("n","<-",Ob)(M,function(m){return m.f(m.n)});Jb=I(h,Nb,"<?>","number").resolve();Tb=I(h,Tb,"<?>","float").resolve();Nb=I(h,ec,"<?>","integer").resolve();Ob=I(h,Ob,"<?>","natural").resolve();ec=I(L("c","<-",b.opStart)("cs","<-",Ib,b.opLetter)(Pa,ub,"c","cs"),"<?>","operator");ec=I(h,"$",n,L("name","<-",ec)(function(m,Y,ka){return(Wb(m.name)?W("reserved operator "+m.name):K(m.name))(m,Y,ka)}));var Cc=I(L("c","<-",b.identStart)("cs",
"<-",Ib,b.identLetter)(Pa,ub,"c","cs"),"<?>","identifier");Cc=I(h,"$",n,L("name","<-",Cc)(function(m,Y,ka){return(rc(m.name)?W("reserved word "+m.name):K(m.name))(m,Y,ka)}));var Kc=Z(b.reservedNames),Oc=b.caseSensitive?Kc:P(function(m){return m.toLowerCase()},Kc);return H.TokenParser(s,{identifier:Cc,reserved:rb,operator:ec,reservedOp:$b,charLiteral:ya,stringLiteral:wb,natural:Ob,integer:Nb,float_:Tb,naturalOrFloat:Jb,decimal:Rb,hexadecimal:Sb,octal:dc,symbol:f,lexeme:h,whiteSpace:Fc,parens:t,braces:y,
angles:T,brackets:N,squares:N,semi:wc,comma:vc,colon:pc,dot:Xb,semiSep:Qa,semiSep1:Ua,commaSep:$,commaSep1:ua})}var c=NS.Haskell.curry,j=NS.Haskell.const_,z=NS.Haskell.isArray,ba=NS.Haskell.slice,P=NS.Haskell.map,Z=NS.Haskell.isort,ha=NS.Haskell.compose,la=NS.Haskell.call,ea=NS.Haskell.id,Ea=NS.Haskell.flip,Fa=NS.Haskell.cons,ub=NS.Haskell.consJoin,ib=NS.Haskell.negate,wa=NS.Haskell.null_,Ba=NS.Haskell.elem,ob=NS.Haskell.digitToInt,ma=NS.Haskell.extend,Sa=NS.Haskell.namespace,pb=NS.Haskell.toInteger,
a=NS.Haskell.fromInteger,e=NS.Haskell.fromIntegral,i=NS.Haskell.evalThunks,l=NS.Haskell.data,s=NS.Haskell.record,G=NS.Haskell.instance,J=NS.Haskell.getInstance,ia=NS.Haskell.operators,S=NS.Haskell.infix,na=NS.Haskell.infixl,fb=NS.Haskell.infixr,oa=NS.Haskell.resolve,Wa=NS.Haskell.exl,qb=NS.Haskell.exs,Ta=NS.Haskell.Scope,gb=NS.Prelude.Maybe,Fb=NS.Prelude.Either,Hb=NS.Prelude.Monad,Vb=NS.Prelude.foldl,Ia=NS.Prelude.foldr,k=NS.Prelude.zip,pa=NS.Prelude.replicate,da=NS.Prelude.nub,ta=NS.Prelude.maybe,
Da=NS.Prelude.compare,ga=NS.Prelude.isSpace,Oa=NS.Prelude.isUpper,qa=NS.Prelude.isLower,Gb=NS.Prelude.isAlpha,hb=NS.Prelude.isAlphaNum,jb=NS.Prelude.isDigit,Ub=NS.Prelude.isHexDigit,fc=NS.Prelude.isOctDigit,ja;B.prototype={memoize:false,scrollTo:function(b){this.index=b;this.length=this.input.length-b;return this},scroll:function(b){this.index+=b;this.length-=b;return this},dropped:0,at:function(b){return this.input.charAt(this.index+b)},substring:function(b,f){return this.input.substring(b+this.index,
(f||this.length)+this.index)},substr:function(b,f){return this.input.substring(b+this.index,f||this.length)},toString:function(){var b=this.substring(0);return"PS at "+this.index+" "+(b.length?'"'+b+'"':"Empty")},getCached:function(b){if(this.memoize)if(b=this.cache[b])if(b=b[this.index]){this.index=b.index;this.length=b.length;return b}},putCached:function(b,f,h){if(!this.memoize)return false;h.index=this.index;h.length=this.length;var q=this.cache[b];q||(q=this.cache[b]={});q[f]=h},sourceLine:function(b){return(b=
this.input.substring(0,b).match(/(\r\n)|\r|\n/g))?b.length:0}};var lc=aa,Pb=O,Dc=Pb,ic=0,Yb=function(b,f){function h(q,u,v){return function(){return b(q,u,function(t){return t.success?f(q,u,v):v(t)})}}h.constructor=D;return h},C=function(){function b(h,q,u){h=new Ta(h);for(var v=1,t=f.length,y=f[0];v<t;++v)y=Yb(y,f[v]);return y(h,q,u)}var f=P(fa,arguments);b.constructor=D;return b},Pa=ha(M,Ka),jc=mb,kc=Ya,K=Za,gc=K;ha=ra;var hc=Yb,qc=U,Ib=Bb(false),g=Bb(true),n=nb(function(b,f,h,q){if(f.success)return f;
h.scrollTo(q);return{ast:ja,success:false,expecting:f.expecting}}),w=function(b){return nb(function(f,h){return{ast:ja,success:h.success,expecting:h.expecting}})(Ib(b),null)},p=$a(function(b,f){if(f.length>0&&f.at(0)==b){f.scroll(1);return{ast:b,success:true}}return{success:false,expecting:b}}),F=$a(function(b,f){var h=f.at(0);if(f.length>0&&b(h)){f.scroll(1);return{ast:h,success:true}}return{success:false,expecting:h}}),R=function(b){return nb(function(f,h,q,u){f=h.ast.join("");return{ast:f.length?
f:ja,success:h.success,expecting:h.success?ja:{at:u,expecting:b}}})(sb(P(p,b)),null)},Ga=nb(function(b,f,h,q){return f.success?f:{ast:f.ast,success:false,expecting:{at:q,expecting:b}}}),Ec=$a(function(b,f){if(typeof b=="string")if(f.substring(0,b.length)==b){f.scroll(b.length);return{ast:b,success:true}}else return{success:false,expecting:b};else if(b.exec){var h=new RegExp("^"+b.source),q=f.substring(0);h=(h=(h=h.exec(q))&&h[0])&&h.length;q=q.substr(0,h);if(h){f.scroll(h);return{ast:q,success:true}}else return{success:false,
expecting:b.source}}});ma(ia,{"<-":{func:o,fixity:fb(-1)},">>=":{func:va,fixity:na(1)},"=<<":{func:Ea(va),fixity:fb(1)},">>":{func:hc,fixity:na(1)},"*>":{func:hc,fixity:na(4)},"<*":{func:zb,fixity:na(4)},"<$>":{func:ha,fixity:na(4)},"<*>":{func:xb,fixity:na(4)},"<**>":{func:c(yb)(Ea(la)),fixity:na(4)},"<$":{func:function(b,f){return zb(gc(value),f)},fixity:na(4)},"<|>":{func:U,fixity:fb(1)},"<?>":{func:Ga,fixity:S(0)}});G(Hb,D,function(){return{">>=":va,">>":Yb,do_:C,return_:Za,fail:aa,run:lb,do$:function(){function b(v,
t,y){return q(v,t,y)}function f(v,t,y){if(u||v instanceof Ta)return(u?q:f.resolve())(v,t,y);h.push(oa(arguments,b));return f}var h=[],q,u;h.push(oa(arguments,b));f.resolve=function(){if(u)return q;q=C.apply(null,h);u=true;h=null;return q};f.CallStream=true;f.constructor=D;return f}}});var L=J(Hb,D).do$,I=Wa(D);Sa("Text_Parsec_Prim",{sequence:Cb,run:lb,Parser:D,ParseState:B,ps:kb,toParser:fa,unexpected:W,parsecMap:ha,fmap:ha,liftM:ra,liftM2:yb,liftM3:Ha,liftA:ha,liftA2:yb,liftA3:Ha,ap:xb,parserBind:va,
parserReturn:Za,return_:K,pure:gc,parserFail:aa,fail:lc,parserZero:O,mzero:Pb,empty:Dc,parserPlus:U,parserPlusN:Ab,mplus:qc,do_:C,do$:L,do2:Yb,bind:o,ret:M,withBound:Ka,returnCall:Pa,getPosition:mb,setPosition:Ya,getParserState:jc,setParserState:kc,tokens:sb,many:Ib,many1:g,string:R,char_:p,satisfy:F,label:Ga,try_:n,skipMany:w,match:Ec,withScope:Kb,ex:I});Sa("Text_Parsec_Combinator",{choice:La,count:Eb,between:Ma,option:ab,optionMaybe:V,optional:bb,skipMany1:cb,sepBy:X,sepBy1:Aa,endBy:Db,endBy1:tb,
sepEndBy:E,sepEndBy1:Ra,chainl:eb,chainl1:Lb,chainr:db,chainr1:Va,eof:xa,notFollowedBy:ca,manyTill:A,lookAhead:Mb,anyToken:Q});l(Ca,["AssocNone","AssocLeft","AssocRight"]);l(sa,[["Infix",D,Ca],["Prefix",D],["Postfix",D]]);Sa("Text_Parsec_Expr",{Assoc:Ca,Operator:sa,buildExpressionParser:r});var vb=function(b){return Ga(F(function(f){return Ba(f,b)}),"oneOf("+b+")")},xc=function(b){return Ga(F(function(f){return!Ba(f,b)}),"noneOf("+b+")")},yc=I(F,ga,"<?>","space").resolve();la=I(w,yc,"<?>","white space").resolve();
Ea=I(p,"\n","<?>","new-line").resolve();ma=I(p,"\t","<?>","tab").resolve();var Jc=I(F,Oa,"<?>","uppercase letter").resolve();qa=I(F,qa,"<?>","lowercase letter").resolve();hb=I(F,hb,"<?>","letter or digit").resolve();Oa=I(F,Gb,"<?>","letter").resolve();var Bc=I(F,jb,"<?>","digit").resolve(),Ac=I(F,Ub,"<?>","hexadecimal digit").resolve(),zc=I(F,fc,"<?>","octal digit").resolve();j=I(F,j(true)).resolve();Sa("Text_Parsec_Char",{oneOf:vb,noneOf:xc,space:yc,spaces:la,newline:Ea,tab:ma,upper:Jc,lower:qa,
alphaNum:hb,letter:Oa,digit:Bc,hexDigit:Ac,octDigit:zc,anyChar:j});l(Na,[["LanguageDef",{commentStart:String,commentEnd:String,commentLine:String,nestedComments:Boolean,identStart:D,identLetter:D,opStart:D,opLetter:D,reservedNames:Array,reservedOpNames:Array,caseSensitive:Boolean}]]);l(H,[["TokenParser",{identifier:D,reserved:Function,operator:D,reservedOp:Function,charLiteral:D,stringLiteral:D,natural:D,integer:D,float_:D,naturalOrFloat:D,decimal:D,hexadecimal:D,octal:D,symbol:Function,lexeme:Function,
whiteSpace:D,parens:Function,braces:Function,angles:Function,brackets:Function,squares:Function,semi:D,comma:D,colon:D,dot:D,semiSep:Function,semiSep1:Function,commaSep:Function,commaSep1:Function}]]);Sa("Text_Parsec_Token",{GenLanguageDef:Na,GenTokenParser:H,makeTokenParser:d});jb=vb(":!#$%&*+./<=>?@\\^|-~");l=Na.LanguageDef(s,{commentStart:"",commentEnd:"",commentLine:"",nestedComments:true,identStart:qb(Oa,"<|>",p("_")),identLetter:qb(hb,"<|>",vb("_'")),opStart:jb,opLetter:jb,reservedOpNames:[],
reservedNames:[],caseSensitive:true});j=Na.LanguageDef(s,{commentStart:"{-",commentEnd:"-}",commentLine:"--",nestedComments:true,identStart:Oa,identLetter:I(hb,"<|>",vb,"_'").resolve(),opStart:jb,opLetter:jb,reservedOpNames:[],reservedNames:[],caseSensitive:true});jb=Na.LanguageDef(s,{commentStart:"/*",commentEnd:"*/",commentLine:"//",nestedComments:true,identStart:Oa,identLetter:qb(hb,"<|>",vb,"_'"),opStart:jb,opLetter:jb,reservedOpNames:[],reservedNames:[],caseSensitive:false});Ub=j.update({reservedOpNames:["::",
"..","=","\\","|","<-","->","@","~","=>"],reservedNames:["let","in","case","of","if","then","else","data","type","class","default","deriving","do","import","infix","infixl","infixr","instance","module","newtype","where","primitive"]});var Lc=Ub.update({identLetter:qb(Ub.identLetter,"<|>",p("#")),reservedNames:Ub.reservedNames.concat(["foreign","import","export","primitive","_ccall_","_casm_","forall"])}),Mc=jb.update({reservedNames:["case","class","default","extends","import","in","let","new","of",
"package"],caseSensitive:true});Sa("Text_Parsec_Language",{emptyDef:l,haskellStyle:j,javaStyle:jb,haskellDef:Lc,mondrianDef:Mc,getHaskell:function(){return d(Lc)},getMondrian:function(){return d(Mc)}})})();(function(){namespace("Text_Parsec");importSubmodules("Text_Parsec",["Prim","Char","Combinator","Token","Language","Expr"])})();(function(){function B(){}function kb(){}function W(){}function aa(g){if(!(g instanceof W))throw"Type error: expecting type of 'Id' instead of "+g.constructor;return g.Id?
g[1]:null}function O(){}function fa(){}function lb(){}function za(){}function D(){}function va(){}function o(){}function M(){}function Ka(){}function mb(){}function Ya(){}function Za(){}function xb(g,n){for(var w=!!n.charAt,p=0,F=n.length;p<F;++p)if(!g(w?n.charAt(p):n[p]))break;return S(n,p)}function ra(g,n,w){return function(p,F,R){return(F.sourceLine(p[g])==F.sourceLine(p[n])?Ca(Q(E.Just,w),A(E.Nothing)):A(E.Nothing))(p,F,R)}}function yb(g,n,w){return function(p,F,R){return(F.sourceLine(p[g])==
F.sourceLine(p[n])?w:Lb("end of line"))(p,F,R)}}function Ha(g,n,w){var p=n.input.substring(0,n.index-n.dropped).match(/\s*$/);p=p&&/\n|\r/.test(p[0]);var F;if(!p){var R=n.at(0);if(R==""||R=="}")p=true;else if(R==";")F=p=true}return(p?F?k.semi:A(null):Mb("end of statement"))(g,n,w)}function zb(g){return g==" "||g=="\t"}function U(g){return function(n,w,p){return Ab(g)(n,w,p)}}function Ab(g){return ea([P(g),">>",A,""],"<|>",[r(ha,[ba,"\\'"])("cs","<-",U(g))(H,function(n){return"'"+n.cs})],"<|>",[r(P("\\"))("c",
"<-",jc,"<|>",kc,"<|>",K,"<|>",P("\r"),"<|>",P("\n"))("cs","<-",U(g))(H,function(n){return n.c=="\r"||n.c=="\n"?oa(n.c,xb(zb,n.cs)):oa(n.c,n.cs)})],"<|>",[xa,oa,ob,U(g)])}function sb(g,n,w){return n>=1?sb(g,n/10,w):(g+n)*Math.pow(10,w)}function Bb(g){return ea(g,">>=",[A,".",E.Just])}function $a(g,n){return sa(Na("pos",c),Na("e",n),H(function(w){return g(w.pos,w.e)}))}function nb(g){function n(w,p){return o.DotRef(w,g,p)}return ea([k.reservedOp("."),">>",$a,n,qa],"<?>","property.ref")}function Kb(g){function n(w,
p){return o.CallExpr(w,g,p)}return ea([k.parens,"$",$a,n,[ga,Ia(pb),k.comma]],"<?>","(function application)")}function Cb(g){function n(w,p){return o.BracketRef(w,g,p)}return ea([k.brackets,"$",$a,n,ga],"<?>","[property-ref]")}function La(g){if(g.Just){g=g[0];return ea(r("e_","<-",nb(g),"<|>",Cb(g))(function(n,w,p){return La(E.Just(n.e_))(n,w,p)}),"<|>",A(g))}if(g.Nothing)return r("e","<-",Da,"<?>","expression (3)")(function(n,w,p){return La(E.Just(n.e))(n,w,p)})}function ab(g){if(g.Just){g=g[0];
return ea(r("e_","<-",nb(g),"<|>",Kb(g),"<|>",Cb(g))(function(n,w,p){return ab(E.Just(n.e_))(n,w,p)}),"<|>",A(g))}if(g.Nothing)return r("e","<-",Da,"<?>","expression (3)")(function(n,w,p){return ab(E.Just(n.e))(n,w,p)})}function V(g,n){g=r("pos","<-",c)(k.reservedOp(g))(H,function(w){return function(p,F){return o.InfixExpr(w.pos,n,p,F)}});return J.Infix(g,G.AssocLeft)}function bb(g,n){if(n.VarRef)if(n[1].Id)return A(va.LVar(n[0],n[1][1]));if(n.DotRef)if(n[2].Id)return A(va.LDot(n[0],n[1],n[2][1]));
if(n.BracketRef)return A(va.LBracket(n[0],n[1],n[2]));return Mb("expeceted l-value at "+g)}function Ma(g,n){return function(w){return o.UnaryAssignExpr(g,lb[n],w)}}function cb(g,n){return function(w,p,F){var R=p.substring(0,2);if(R=="--"||R=="++"){R=p.input.substring(0,p.index-p.dropped).match(/\s*$/);return(R&&/\n|\r/.test(R[0])?n:g)(w,p,F)}else return n(w,p,F)}}var X=NS.Haskell_DataType.data,Aa=NS.Haskell_DataType.ADT;Aa=NS.Haskell_DataType.record;var Ra=NS.Haskell_DataType.accessor;Ra=NS.Haskell_DataType.accessors;
var E=NS.Prelude.Maybe,tb=NS.Prelude.maybe,Db=NS.Prelude.lookup,Eb=NS.Prelude.fst,db=NS.Prelude.uncurry,eb=NS.Text_Parsec.sequence,Lb=NS.Text_Parsec.unexpected,Va=NS.Text_Parsec.fmap,Q=NS.Text_Parsec.liftM,xa=NS.Text_Parsec.liftM2,ca=NS.Text_Parsec.parserBind,A=NS.Text_Parsec.return_,Mb=NS.Text_Parsec.fail,Ca=NS.Text_Parsec.parserPlus,sa=NS.Text_Parsec.do_,r=NS.Text_Parsec.do$,Na=NS.Text_Parsec.bind,H=NS.Text_Parsec.ret,d=NS.Text_Parsec.returnCall,c=NS.Text_Parsec.getPosition,j=NS.Text_Parsec.many,
z=NS.Text_Parsec.many1,ba=NS.Text_Parsec.string,P=NS.Text_Parsec.char_,Z=NS.Text_Parsec.label,ha=NS.Text_Parsec.try_,la=NS.Text_Parsec.withScope,ea=NS.Text_Parsec.ex,Ea=NS.Text_Parsec.oneOf,Fa=NS.Text_Parsec.noneOf,ub=NS.Text_Parsec.spaces,ib=NS.Text_Parsec.alphaNum,wa=NS.Text_Parsec.letter,Ba=NS.Text_Parsec.hexDigit,ob=NS.Text_Parsec.anyChar,ma=NS.Text_Parsec.option,Sa=NS.Text_Parsec.optionMaybe,pb=NS.Text_Parsec.sepBy,a=NS.Text_Parsec.sepBy1,e=NS.Text_Parsec.sepEndBy,i=NS.Text_Parsec.notFollowedBy,
l=NS.Text_Parsec.GenLanguageDef,s=NS.Text_Parsec.makeTokenParser,G=NS.Text_Parsec.Assoc,J=NS.Text_Parsec.Operator,ia=NS.Text_Parsec.buildExpressionParser,S=NS.Haskell.slice,na=NS.Haskell.map,fb=NS.Haskell.id,oa=NS.Haskell.cons,Wa=NS.Haskell.negate,qb=NS.Haskell.elem,Ta=NS.Haskell.namespace,gb=NS.Haskell.readHex,Fb=NS.Haskell.readOct,Hb=NS.Haskell.chr,Vb=NS.Haskell.round;X=NS.Haskell.data;Aa=NS.Haskell.ADT;Aa=NS.Haskell.record;Ra=NS.Haskell.accessor;Ra=NS.Haskell.accessors;var Ia=NS.Haskell.op;X(kb,
[["Script","a",Array]]);X(W,[["Id","a",String]]);X(O,["OpLT","OpLEq","OpGT","OpGEq","OpIn","OpInstanceof","OpEq","OpNEq","OpStrictEq","OpStrictNEq","OpLAnd","OpLOr","OpMul","OpDiv","OpMod","OpSub","OpLShift","OpSpRShift","OpZfRShift","OpBAnd","OpBXor","OpBOr","OpAdd"]);X(fa,["OpAssign","OpAssignAdd","OpAssignSub","OpAssignMul","OpAssignDiv","OpAssignMod","OpAssignLShift","OpAssignSpRShift","OpAssignZfRShift","OpAssignBAnd","OpAssignBXor","OpAssignBOr"]);X(lb,["PrefixInc","PrefixDec","PostfixInc",
"PostfixDec"]);X(za,["PrefixLNot","PrefixBNot","PrefixPlus","PrefixMinus","PrefixTypeof","PrefixVoid","PrefixDelete"]);X(D,[["PropId","a",W],["PropString","a",String],["PropNum","a",Number]]);X(va,[["LVar","a",String],["LDot","a",o,String],["LBracket","a",o,o]]);X(o,[["StringLit","a",String],["RegexpLit","a",String,Boolean,Boolean],["NumLit","a",Number],["IntLit","a",Number],["BoolLit","a",Boolean],["NullLit","a"],["ArrayLit","a",Array],["ObjectLit","a",Array],["ThisRef","a"],["VarRef","a",W],["DotRef",
"a",o,W],["BracketRef","a",o,o],["NewExpr","a",o,Array],["PrefixExpr","a",za,o],["UnaryAssignExpr","a",lb,va],["InfixExpr","a",O,o,o],["CondExpr","a",o,o,o],["AssignExpr","a",fa,va,o],["ParenExpr","a",o],["ListExpr","a",Array],["CallExpr","a",o,Array],["FuncExpr","a",E,Array,B]]);X(M,[["CaseClause","a",o,Array],["CaseDefault","a",Array]]);X(Ka,[["CatchClause","a",W,B]]);X(mb,[["VarDecl","a",W,E]]);X(Ya,["NoInit",["VarInit",Array],["ExprInit",o]]);X(Za,[["ForInVar",W],["ForInNoVar",W]]);X(B,[["BlockStmt",
"a",Array],["EmptyStmt","a"],["ExprStmt","a",o],["IfStmt","a",o,B,B],["IfSingleStmt","a",o,B],["SwitchStmt","a",o,Array],["WhileStmt","a",o,B],["DoWhileStmt","a",B,o],["BreakStmt","a",E],["ContinueStmt","a",E],["LabelledStmt","a",W,B],["ForInStmt","a",Za,o,B],["ForStmt","a",Ya,E,E,B],["TryStmt","a",B,Array,E],["ThrowStmt","a",o],["ReturnStmt","a",E],["WithStmt","a",o,B],["VarDeclStmt","a",Array],["FunctionStmt","a",W,Array,B]]);Ta("BrownPLT_JavaScript_Syntax",{Expression:o,CaseClause:M,Statement:B,
InfixOp:O,CatchClause:Ka,VarDecl:mb,JavaScript:kb,AssignOp:fa,Id:W,PrefixOp:za,Prop:D,ForInit:Ya,ForInInit:Za,unId:aa,UnaryAssignOp:lb,LValue:va});X=Ca(wa,Ea("$_"));ib=l.LanguageDef(Aa,{commentStart:"/*",commentEnd:"*/",commentLine:"//",nestedComments:false,identStart:X,identLetter:Ca(ib,Ea("$_")),opStart:Ea("{}<>()~.,?:|&^=!+-*/%!"),opLetter:Ea("=<>|&+"),reservedOpNames:["|=","^=","&=","<<=",">>=",">>>=","+=","-=","*=","/=","%=","=",";",",","?",":","||","&&","|","^","&","===","==","=","!==","!=",
"<<","<=","<",">>>",">>",">=",">","++","--","+","-","*","/","%","!","~",".","[","]","{","}","(",")","instanceof","in"],reservedNames:["break","case","catch","const","continue","debugger","default","delete","do","else","enum","false","finally","for","function","if","instanceof","in","let","new","null","return","switch","this","throw","true","try","typeof","var","void","while","with"],caseSensitive:true});var k=s(ib);Ta("BrownPLT_JavaScript_Lexer",{lex:k});var pa=la(function(){return pa}),da=la(function(){return da}),
ta=la(function(){return ta}),Da=la(function(){return Da}),ga=la(function(){return ga}),Oa=ga,qa=xa(W.Id,c,k.identifier);ib=r("pos","<-",c)(k.reserved,"if")("test","<-",ta,"<?>","parenthesized test-expression in if statement")("consequent","<-",da,"<?>","true-branch of if statement")(r(k.reserved,"else")("alternate","<-",da)(H,function(g){return B.IfStmt(g.scope.pos,g.scope.test,g.scope.consequent,g.alternate)}),"<|>",d(B.IfSingleStmt,"pos","test","consequent"));s=r("pos","<-",c)(k.reserved,"default")(k.colon)("statements",
"<-",j,da)(d,M.CaseDefault,"pos","statements");l=r("pos","<-",c)(k.reserved,"case")("condition","<-",pa)(k.colon)("actions","<-",j,da)(d,M.CaseClause,"pos","condition","actions");l=r("pos","<-",c)(k.reserved,"switch")("test","<-",ta)("clauses","<-",k.braces,"$",j,"$",s,"<|>",l)(d,B.SwitchStmt,"pos","test","clauses");Aa=r("pos","<-",c)(k.reserved,"while")("test","<-",ta,"<?>","parenthesized test-expression in while loop")("body","<-",da)(d,B.WhileStmt,"pos","test","body");s=r("pos","<-",c)("statements",
"<-",k.braces,[j,da])(d,B.BlockStmt,"pos","statements");wa=r("pos","<-",c)(k.reserved,"do")("body","<-",s)(k.reserved,"while","<?>","while at the end of a do block")("test","<-",ta,"<?>","parenthesized test-expression in do loop")(Ha)(d,B.DoWhileStmt,"pos","body","test");Ra=r("pos","<-",c)(k.reserved,"continue")("pos_","<-",c)("id","<-",ra,"pos","pos_",qa)(Ha)(d,B.ContinueStmt,"pos","id");var Gb=r("pos","<-",c)(k.reserved,"break")("pos_","<-",c)("id","<-",ra,"pos","pos_",qa)(Ha)(d,B.BreakStmt,"pos",
"id"),hb=r("pos","<-",c)(k.semi)(d,B.EmptyStmt,"pos"),jb=r("pos","<-",c)("label","<-",ha,r("label","<-",qa)(k.colon)(H,"label"))("statement","<-",da)(d,B.LabelledStmt,"pos","label","statement"),Ub=r("pos","<-",c)("expr","<-",pa)(Ha)(d,B.ExprStmt,"pos","expr"),fc=ea([k.reserved,"var",">>",Q,Za.ForInVar,qa],"<|>",[Q,Za.ForInNoVar,qa]);fc=r("pos","<-",c)("init_expr","<-",ha,r(k.reserved,"for")(k.parens,r("init","<-",fc)(k.reserved,"in")("expr","<-",ga)(H,function(g){return[g.init,g.expr]})))("body",
"<-",da)(H,function(g){return B.ForInStmt(g.pos,g.init_expr[0],g.init_expr[1],g.body)});var ja=r("pos","<-",c)("id","<-",qa)("init","<-",[k.reservedOp("="),">>",Q,E.Just,ga],"<|>",A(E.Nothing))(d,mb.VarDecl,"pos","id","init"),lc=r("pos","<-",c)(k.reserved,"var")("decls","<-",ja,Ia(pb),k.comma)(Ha)(d,B.VarDeclStmt,"pos","decls");ja=ea([k.reserved,"var",">>",Q,Ya.VarInit,[ja,Ia(pb),k.comma]],"<|>",[Q,Ya.ExprInit,pa],"<|>",A(Ya.NoInit));ja=r("pos","<-",c)(k.reserved,"for")(k.reservedOp("("))("init",
"<-",ja)(k.semi)("test","<-",[Q,E.Just,ga],"<|>",A(E.Nothing))(k.semi)("iter","<-",[Q,E.Just,pa],"<|>",A(E.Nothing))(k.reservedOp(")"),"<?>","closing paren")("stmt","<-",da)(d,B.ForStmt,"pos","init","test","iter","stmt");var Pb=r("pos","<-",c)(k.reserved,"catch")("id","<-",k.parens,qa)("stmt","<-",da)(d,Ka.CatchClause,"pos","id","stmt");Pb=r(k.reserved,"try")("pos","<-",c)("guarded","<-",da)("catches","<-",j,Pb)("finally","<-",[k.reserved,"finally",">>",Q,E.Just,da],"<|>",A(E.Nothing))(d,B.TryStmt,
"pos","guarded","catches","finally");var Dc=r("pos","<-",c)(k.reserved,"throw")("pos_","<-",c)("expr","<-",yb,"pos","pos_",ga)(Ha)(d,B.ThrowStmt,"pos","expr"),ic=r("pos","<-",c)(k.reserved,"return")("pos_","<-",c)("expr","<-",ra,"pos","pos_",pa)(Ha)(d,B.ReturnStmt,"pos","expr"),Yb=r("pos","<-",c)(k.reserved,"with")("context","<-",ta)("stmt","<-",da)(d,B.WithStmt,"pos","context","stmt"),C=r("pos","<-",c)("name","<-",ha,[k.reserved,"function",">>",qa])("args","<-",k.parens,[qa,Ia(pb),k.comma])("body",
"<-",s,"<?>","function body in { ... }")(d,B.FunctionStmt,"pos","name","args","body");da=ea(ib,"<|>",l,"<|>",Aa,"<|>",wa,"<|>",Ra,"<|>",Gb,"<|>",s,"<|>",hb,"<|>",fc,"<|>",ja,"<|>",Pb,"<|>",Dc,"<|>",ic,"<|>",Yb,"<|>",lc,"<|>",C,"<|>",jb,"<|>",Ub,"<?>","statement");ib=r("pos","<-",c)(k.reserved,"this")(d,o.ThisRef,"pos");l=r("pos","<-",c)(k.reserved,"null")(d,o.NullLit,"pos");Aa=r("pos","<-",c)("true","<-",A,true)("false","<-",A,false)([k.reserved,"true",">>",d(o.BoolLit,"pos","true")],"<|>",[k.reserved,
"false",">>",d(o.BoolLit,"pos","false")]);wa=xa(o.VarRef,c,qa);Ra=xa(o.ArrayLit,c,k.squares(e(ga,k.comma)));Gb=r("pos","<-",c)(k.reserved,"function")("name","<-",[qa,">>=",A,".",E.Just],"<|>",A,E.Nothing)("args","<-",k.parens,[qa,Ia(pb),k.comma])("body","<-",s)(d,o.FuncExpr,"pos","name","args","body");var Pa=[["'","'"],['"','"'],["\\","\\"],["b","\u0008"],["f","\u000c"],["n","\n"],["r","\r"],["t","\t"],["v","\u000b"],["/","/"],[" "," "],["0","\u0000"]];Eb=na(Eb,Pa);var jc=r("c","<-",Ea(Eb))(H,function(g){return Db(g.c,
Pa)[0]}),kc=r(P,"x")("d1","<-",Ba)("d2","<-",Ba)(H,function(g){return Hb(gb(""+g.d1+g.d2))}),K=r(P,"u")(Q,[Hb,".",gb],eb([Ba,Ba,Ba,Ba]));eb=r("pos","<-",c)("str","<-",k.lexeme,"$",[P("'"),">>=",Ab],"<|>",[P('"'),">>=",Ab])(d,o.StringLit,"pos","str");Ba=r("flags","<-",j,Ea("mgi"))(H,function(g){return function(n){return n(qb("g",g.flags),qb("i",g.flags))}});ea(P("\\"),">>",ob).resolve();Fa("/");Fa=function(g,n,w){return gc(g,n,w)};var gc=ea([P("/"),">>",A,""],"<|>",r(P("\\"))("ch","<-",ob)("rest",
"<-",Fa)(H,function(g){return"\\"+g.ch+g.rest}),"<|>",[xa,oa,ob,Fa]);ub=r("pos","<-",c)(P("/"))("pat","<-",gc)("flags","<-",Ba)(ub)(H,function(g){return g.flags(function(n,w){return o.RegexpLit(g.pos,g.pat,n,w)})});db=r("name","<-",[Q,db(D.PropString),[Q,function(g){return[g[0],g[1]]},eb]],"<|>",[xa,D.PropId,c,qa],"<|>",[xa,D.PropNum,c,k.decimal])(k.colon)("val","<-",Oa)(H,function(g){return[g.name,g.val]});e=r("pos","<-",c)("props","<-",k.braces,[db,Ia(e),k.comma],"<?>","object literal")(d,o.ObjectLit,
"pos","props");db=r(ha,ba("0x"))("digits","<-",z,Ea("0123456789abcdefABCDEF"))("hex","<-",d,gb,"digits")(H,function(g){return[true,g.hex]});z=r("digits","<-",ha,"$",[P("0"),">>",[z,Ea("01234567"),"<|>",A("0")]],"<*",i,Ea(".89"))("oct","<-",d,Fb,"digits")(H,function(g){return[true,g.oct]});Va=r(Ea,"eE")([P("+"),">>",k.decimal],"<|>",[P("-"),">>",Wa,Ia(Va),k.decimal],"<|>",k.decimal);ma=ea(r("whole","<-",k.decimal)("mfrac","<-",ma,E.Nothing,[Bb,[P("."),">>",k.decimal]])("mexp","<-",ma,E.Nothing,[Bb,
Va])(H,function(g){return g.mfrac==E.Nothing&&g.mexp==E.Nothing?[true,g.whole]:[false,sb(g.whole,tb(0,fb,g.mfrac),tb(0,fb,g.mexp))]}),"<|>",r("frac","<-",P("."),">>",k.decimal)("exp","<-",ma,0,Va)(H,function(g){return[false,sb(0,g.frac,g.exp)]}));ma=r("pos","<-",c)("isint_num","<-",k.lexeme,"$",db,"<|>",z,"<|>",ma)(i,X,"<?>","whitespace")(H,function(g){var n=g.isint_num[1];return g.isint_num[0]?o.IntLit(g.pos,Vb(n)):o.NumLit(g.pos,n)});ta=$a(o.ParenExpr,k.parens(pa));ea(ib,"<|>",l,"<|>",Aa,"<|>",
eb,"<|>",Ra,"<|>",ta,"<|>",Da,"<|>",ma,"<|>",ub,"<|>",e,"<|>",wa);ma=ea(ib,"<|>",l,"<|>",Aa,"<|>",eb,"<|>",Ra,"<|>",ta,"<|>",Gb,"<|>",ma,"<|>",ub,"<|>",e,"<|>",wa);Da=ea(r("pos","<-",c)(k.reserved,"new")("constructor_","<-",La,E.Nothing)("arguments","<-",[ha,[k.parens,[ga,Ia(pb),k.comma]]],"<|>",A([]))(d,o.NewExpr,"pos","constructor_","arguments"),"<|>",ma);var hc=r("pos","<-",c)("op","<-",Sa,"$",[k.reservedOp("!"),">>",A,za.PrefixLNot],"<|>",[k.reservedOp("~"),">>",A,za.PrefixBNot],"<|>",[ha,[k.lexeme,
"$",P("-"),">>",i,P("-")],">>",A,za.PrefixMinus],"<|>",[ha,[k.lexeme,"$",P("+"),">>",i,P("+")],">>",A,za.PrefixPlus],"<|>",[k.reserved,"typeof",">>",A,za.PrefixTypeof],"<|>",[k.reserved,"void",">>",A,za.PrefixVoid],"<|>",[k.reserved,"delete",">>",A,za.PrefixDelete])(function(g,n,w){var p=g.op,F;if(p.Nothing)F=Ib;if(p.Just)F=r("innerExpr","<-",hc)(H,function(R){return o.PrefixExpr(g.pos,p[0],R.innerExpr)});return F(g,n,w)});i=[[V("*",O.OpMul),V("/",O.OpDiv),V("%",O.OpMod)],[V("+",O.OpAdd),V("-",O.OpSub)],
[V("<<",O.OpLShift),V(">>",O.OpSpRShift),V(">>>",O.OpZfRShift)],[V("<",O.OpLT),V("<=",O.OpLEq),V(">",O.OpGT),V(">=",O.OpGEq),V("instanceof",O.OpInstanceof),V("in",O.OpIn)],[V("&",O.OpBAnd)],[V("^",O.OpBXor)],[V("|",O.OpBOr)],[V("&&",O.OpLAnd)],[V("||",O.OpLOr)],[V("==",O.OpEq),V("!=",O.OpNEq),V("===",O.OpStrictEq),V("!==",O.OpStrictNEq)]].reverse();Z=Z(ia(i,hc),"simple expression");var qc=r("p","<-",c)("e","<-",ab,E.Nothing)(function(g,n,w){return bb(g.p,g.e)(g,n,w)}),Ib=ca(c,function(g){function n(Ga){return sa(k.reservedOp("++"),
Q(Ma(g,"PostfixInc"),bb(g,Ga)))}function w(Ga){return sa(k.reservedOp("--"),Q(Ma(g,"PostfixDec"),bb(g,Ga)))}var p=sa(k.reservedOp("++"),Q(Ma(g,"PrefixInc"),qc)),F=sa(k.reservedOp("--"),Q(Ma(g,"PrefixDec"),qc)),R=ca(ab(E.Nothing),function(Ga){return cb(Ca(n(Ga),Ca(w(Ga),A(Ga))),A(Ga))});return Ca(p,Ca(F,R))});ia=r(k.reservedOp("?"))("l","<-",Oa)(k.colon)("r","<-",Oa)(H,function(g){return[g.l,g.r]});Sa=r("e","<-",Z)("e_","<-",Sa,ia)(function(g,n,w){var p=g.e_,F=g.e,R;if(p.Nothing)R=A(g.e);if(p.Just){var Ga=
p[0][0],Ec=p[0][1];R=r("p","<-",c)(H,function(L){return o.CondExpr(L.p,F,Ga,Ec)})}return R(g,n,w)});Z=ea([k.reservedOp("="),">>",A,fa.OpAssign],"<|>",[k.reservedOp("+="),">>",A,fa.OpAssignAdd],"<|>",[k.reservedOp("-="),">>",A,fa.OpAssignSub],"<|>",[k.reservedOp("*="),">>",A,fa.OpAssignMul],"<|>",[k.reservedOp("/="),">>",A,fa.OpAssignDiv],"<|>",[k.reservedOp("%="),">>",A,fa.OpAssignMod],"<|>",[k.reservedOp("<<="),">>",A,fa.OpAssignLShift],"<|>",[k.reservedOp(">>="),">>",A,fa.OpAssignSpRShift],"<|>",
[k.reservedOp(">>>="),">>",A,fa.OpAssignZfRShift],"<|>",[k.reservedOp("&="),">>",A,fa.OpAssignBAnd],"<|>",[k.reservedOp("^="),">>",A,fa.OpAssignBXor],"<|>",[k.reservedOp("|="),">>",A,fa.OpAssignBOr]);ga=Oa=r("p","<-",c)("lhs","<-",Sa)(r("op","<-",Z)("lhs","<-",la,function(g){g.p=g.scope.p;return bb(g.scope.p,g.scope.lhs)})("rhs","<-",la,function(){return Oa})(d,o.AssignExpr,"p","op","lhs","rhs"),"<|>",H,"lhs");pa=xa(o.ListExpr,c,a(Oa,k.comma));d=r(k.whiteSpace)(xa,kb.Script,c,j(da));Ta("BrownPLT_JavaScript_Parser",
{parseScript:d,parseExpression:ga,parseSimpleExpr_:ma,parseBlockStmt:s,parseStatement:da,assignExpr:Oa})})();(function(){namespace("BrownPLT_JavaScript");importSubmodules("BrownPLT_JavaScript",["Lexer","Syntax","Parser"])})()})();
