/*

 JavaScript analysis tools based on JSParsec

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.

 This is a port of the WebBits library (BrownPLT.JavaScript):
 http://hackage.haskell.org/package/WebBits-2.0
 Copyright (c) 2007-2009 Arjun Guha, Claudiu Saftoiu, and Spiridon Eliopoulos

 ------------------------------------------------------------


 JSParsec - A parser combinator library for JavaScript

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.


 The initial implementation of some combinators,
 and the memoization technique is derived from:
 http://www.bluishcoder.co.nz/2007/10/javascript-parser-combinators.html

 Most functions should behave like their counterparts in Parsec 3:
 http://www.haskell.org/haskellwiki/Parsec

 ------------------------------------------------------------


 JSHaskell - Some Haskell language features for JavaScript

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.

 ------------------------------------------------------------

*/
(function(){(function(){function B(d,g){return ob[d]=g||{}}function jb(d,g){for(var m=ob[d],o=0,v=g.length;o<v;++o){var D=ob[d+"_"+g[o]];for(var K in D)m[K]=D[K]}}function pa(d){return Ta.call(d)=="[object Array]"}function db(d){return d!==ha}function S(d,g){return d===g}function ma(d,g){return d!==g}function La(d,g){return d+g}function ia(d,g){return d-g}function Q(d,g){return d*g}function ta(d,g){return d/g}function t(d,g){return d<g}function R(d,g){return d<=g}function eb(d,g){return d>g}function wb(d,
g){return d>=g}function fb(d){return-d}function Ea(d){var g=d.constructor;if(g)return g;d=typeof d;return d=="string"?String:d=="number"?Number:d=="boolean"?Boolean:d=="function"?Function:ha}function xb(d){function g(){var m=qa(arguments);return m.length>=(d._length===ha?d.length:d._length)?d.apply(null,m):function(){return g.apply(null,m.concat(qa(arguments)))}}return g}function pb(d){var g=qa(arguments,1);return function(){return d.apply(null,g)}}function Fb(){function d(g){return!g?[]:[[g.name||
g._name||g,g.arguments]].concat(d(g.caller))}return d(arguments.callee.caller)}function Ba(d){d=(d instanceof Function?d.name||d._name:null)||d||"Unspecified error";var g=new Error(d);try{g.stackTrace=Fb()}catch(m){}g.message=d;throw g;}function Gb(d,g){for(var m in g)d[m]=g[m];return d}function X(d,g){if(g.indexOf)return g.indexOf(d);var m=g.length;if(!m)return-1;for(var o=0;o<m;o++)if(g[o]===d)return o;return-1}function yb(d,g){if(g.lastIndexOf)return g.lastIndexOf(d);var m=g.length;if(!m)return-1;
for(m=m-1;m>-1;--m)if(g[m]===d)return m;return-1}function Hb(d){var g=d.charAt;d=zb(d);d.sort();return g?d.join(""):d}function zb(d){if(!d.charAt)return qb.call(d,0);for(var g=[],m=0,o=d.length;m<o;++m)g.push(d.charAt(m));return g}function Ha(d,g){return{indexOf:function(m){return m>=d&&m<=g?true:-1},toString:function(){return"range("+d+", "+g+")"}}}function rb(d,g){function m(){try{var v=g;do d=d()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()();
while(--v);setTimeout(m,1)}catch(D){}}if(!g||g==Infinity){try{for(;d=d()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()(););}catch(o){}return d}m()}function Mb(d){return["l",d]}function Nb(d){return["r",d]}function Ma(d){return["x",d]}function lb(d){if(d)if(!d._String){var g=Na[d];if(d._Op&&!g)return"l";return g&&(g.fixity[0]||"l")}}function ka(d){if(d)if(!d._String){var g=
Na[d];if(d._Op&&!g)return 9;return g&&(db(g.fixity[1])?g.fixity[1]:9)}}function mb(){}function Ia(d,g,m){var o;if(d[g]._Op){delete d[g]._Op;o=d[g]}else o=Na[d[g]].func;o=o(d[g-1],d[g+1]);d.splice(g-1,3,o);return ua(d,m)}function sb(d){if(typeof d=="string"){d=new String(d);d._String=true;return d}else{d._Array=true;return d}}function aa(d){d._Op=true;return d}function ua(d,g){d=Ua(function(L){if(!L)return L;if(L._Array){delete L._Array;return L}return L.constructor==Array?ua(L,g):L.CallStream?L.resolve(g):
L},d);if(g)d=Ua(function(L){return L instanceof mb?g:L},d);for(var m=[],o=[],v=0,D=d.length;v<D;++v){var K=d[v],fa=false;if(Na[K])fa=true;if(K&&K._String){fa=false;K=K.toString()}if(K&&K._Op)fa=true;if(!fa&&v!=D-1)m.push(K);else{v==D-1&&m.push(K);m=m.length>1?m[0].apply(null,m.slice(1)):m[0];o.push(m);v!=D-1&&o.push(K);m=[]}}d=o;o=Ua(lb,d);D=Ua(ka,d);K=A(db,D).sort().pop();v=X(K,D);D=yb(K,D);return o[v]=="l"?Ia(d,v,g):o[D]=="r"?Ia(d,D,g):o[v]=="x"?Ia(d,v,g):d[0]}function ra(d){return function(){function g(){return v.apply(null,
arguments)}function m(){return(D?v:m.resolve()).apply(null,arguments)}var o=arguments,v,D;m.resolve=function(K){if(D)return v;v=ua(o,K||g);o=null;D=true;return v};m.CallStream=true;m.constructor=d;return m}}function tb(){return ua(qa(arguments))}function Ib(d){this.scope=d}function Jb(d){return function(){function g(){return v.apply(null,arguments)}function m(K){if(D||K instanceof Ib)return(D?v:m.resolve()).apply(null,arguments);o.push(ua(arguments,g));return m}var o=[],v,D;o.push(ua(arguments,g));
m.resolve=function(){if(D)return v;v=d.do_.apply(null,o);D=true;o=null;return v};m.CallStream=true;m.constructor=d._type;return m}}function Kb(){this.keys=[];this.values=[]}function kb(d,g){var m={};m._context=[];m._name=d;m._dict=new Kb;m.context=function(){this._context=qa(arguments);delete m.context;return this};m.types=function(o){this._fnTypes=o;delete m.types;return this};m.impl=function(o){this._default=o;for(var v in m._fnTypes)(function(D,K){m[D]=K!==ha&&K.constructor!=Array?(typeof o=="function"?
o():o)[D]:function(){var fa=arguments,L;if(K===ha||K===ba)Ba("There's no type signature for "+m._name+"."+D+", it can be accessed only by: getInstance("+m._name+", SomeType)."+D);var na,W=A(function(Ca,I){I=K[I];if(na||I==ba)return na=true;Ca=Ea(Ca);if(I==g){L=L||Ca;return L==Ca}else return Ca==I},fa);!na&&W.length!=K.length-1&&Ba("Type error in "+m._name+"."+D);(W=m._dict.get(L))||Ba("No "+m._name+" instance for "+(L.name||L._name));return W[D].apply(null,fa)}})(v,m._fnTypes[v]);delete m.impl;return this};
return m}function T(d,g,m){Ua(function(K){if(!K._dict.get(g))throw"No "+(K._name||"")+" instance for "+(g.name||g._name);},d._context);var o={};o._type=g;d._dict.put(g,o);m=typeof m=="function"?m(o):m||{};var v=d._default;v=typeof v=="function"?v(o):v;for(var D in d._fnTypes)o[D]=m[D]||v[D];return o}function Ab(d,g){return d._dict.get(g)}function Bb(d,g,m){return d._dict.get(Ea(m))[g]}function ub(d,g){return g?g[d]:function(m){return m[d]}}function Lb(){}function Ya(){}function vb(d){return function(){var g=
[],m=this._recordset;if(m&&m.constructor!=Array){for(var o in m){var v=d?m[o].name||m[o]:this[o];if(!d&&v instanceof Function)v=v.constructor!=Function?v.constructor.name:"Function("+v.name+")";g.push(o+(d?" :: ":" = ")+v)}m=replicate(this._dataConstructor.length+2," ").join("");g="{"+g.join("\n"+m+",")+"\n"+m+"}"}else{for(o=0;o in this;o++)g.push(d?m[o].name||m[o]:this[o]);g=g.join(" ")}return"("+this._dataConstructor+(g?" ":"")+g+")"}}function Ob(d,g,m,o,v){Ba("Type error: expecting "+d.name+" instead of "+
g.name+" in the argument '"+m+"' of "+o+"."+v)}function Oa(d,g){function m(L,na){function W(Pa,Za){var sa=Pa instanceof Lb,ga=new d,Va,ya;ga.constructor=d;ga._recordset=Ca&&na[0]||na;ga._dataConstructor=L;ga[L]=true;if(sa)for(var da in Za){sa=Za[da];Ca||Ba("Records are not defined for "+o+"."+L);da in I||Ba("The accessor '"+da+"' is not defined for "+o+"."+L);ya=I[da];if(typeof ya!="string"){Va=Ea(sa);Va!=ya&&Ob(ya,Va,da,o,L)}ga[da]=sa;ga[gb[da]]=sa}else{da=arguments;for(var M=0,U=da.length;M<U;++M){sa=
da[M];ya=na[M];if(typeof ya!="string"){Va=Ea(sa);Va!=ya&&Ob(ya,Va,M,o,L)}ga[M]=sa;if(Ca)ga[n[M]]=sa}}ga.update=function(Wa){var $a={};for(var ja in I)$a[ja]=ja in Wa?Wa[ja]:this[ja];return W(P,$a)};return ga}var Ca=na&&typeof na[0]=="object",I=Ca&&na[0];if(Ca){var xa=0,ca,gb={},n={};for(ca in I){var za=ca.charAt(0);if(za=="_"||za==za.toUpperCase())throw o+"."+fa+"."+ca+": record names can't start with underscore or uppercase letters";if(ca in{update:1})throw o+"."+fa+"."+ca+": record name is invalid";
gb[ca]=xa;n[xa]=ca;xa++}}return W}var o=d.name;if(d._constructors)throw"Type constructor has been already defined: '"+o+"'";d._constructors=g;d.prototype=new Ya;for(var v=0,D=g.length;v<D;++v){var K=typeof g[v]!="object",fa=K?g[v]:g[v][0];if(fa in d)throw"The name of the data constructor ("+o+"."+fa+") is invalid!";d[fa]=K?m(fa)():m(fa,qa(g[v],1));if(!K)d[fa]._length=g[v].length-1}}var hb=function(){return this}()||window,ob=hb.NS||(hb.NS={}),ha,Ta={}.toString,qb=[].slice,J=[].map,Cb=[].filter;(function(){return this}).toString().indexOf("this");
(function(){var d={9:1,d:1,b:1,0:1,a:1,c:1},g=[9,"d","b",0,"a","c"],m=0;for(var o in d)if(o!=g[m++])return false;return true})();hb.global=hb;hb.namespace=B;hb.importSubmodules=jb;var qa="a"[0]?function(d,g){return qb.call(d,g||0)}:function(d,g){if(typeof d=="string"){d=d.split("");if(!g)return d}return qb.call(d,g||0)},Ua=J?function(d,g){return J.call(g,d)}:function(d,g){for(var m=[],o=0,v=g.length;o<v;++o)m[o]=d(g[o],o,g);return m},A=Cb?function(d,g){return Cb.call(g,d)}:function(d,g){for(var m=
[],o=0,v=g.length;o<v;++o)d(g[o],o,g)&&m.push(g[o]);return m};B("Haskell_Main",{Bool:Boolean,isArray:pa,isDefined:db,slice:qa,imap:Ua,ifilter:A,indexOf:X,lastIndexOf:yb,isort:Hb,range:Ha,extend:Gb,namespace:B,typeOf:Ea,strictEq:S,strictNe:ma,unsafeAdd:La,unsafeSub:ia,unsafeMul:Q,unsafeDiv:ta,lt:t,le:R,gt:eb,ge:wb,negate:fb,evalThunks:rb,toArray:zb,curry:xb,error:Ba});var Na={};hb=new mb;B("Haskell_Expression",{operators:Na,infix:Ma,infixl:Mb,infixr:Nb,op:aa,no:sb,resolve:ua,recurse:hb,Recurse:mb,
exl:ra,exs:tb});B("Haskell_Do",{createDo:Jb,Scope:Ib});Kb.prototype.put=function(d,g){this.keys.push(d);this.values.push(g)};Kb.prototype.get=function(d){d=X(d,this.keys);if(d!=-1)return this.values[d]};var ba={};B("Haskell_TypeClass",{typeclass:kb,VARARG:ba,instance:T,getInstance:Ab,asTypeOf:Bb});var P=new Lb;Ya.prototype.toString=vb();Ya.prototype.dataConstructorToString=vb(true);Ya.prototype.update=pb(Ba);B("Haskell_DataType",{data:Oa,ADT:Ya,record:P,accessor:ub,accessors:{}})})();(function(){namespace("Haskell");
importSubmodules("Haskell",["Main","DataType","TypeClass","Expression","Do"])})();(function(){function B(){}function jb(a,c){return a===true?c:a===false?false:U(Ya)}function pa(a,c){return a===true?true:a===false?c:U(vb)}function db(a){return a===true?false:a===false?true:U(db)}function S(a){a.constructor=Qa["Tuple"+a.length];return a}function ma(){}function La(a){return a.charAt?"":[]}function ia(a,c){if(a.charAt&&c.charAt)return a+c;return[a].concat(c)}function Q(a,c){if(a.charAt&&c.charAt)return a+
c;return a+c.join("")}function ta(a){var c=a.charAt,j=c?a.charAt(0):a[0];a=c?a.substr(1):I(a,1);c=[j,a];c.head=j;c.tail=a;c.constructor=Qa.Tuple2;return c}function t(a,c){for(var j=c.charAt,u=[],Y=0,V=c.length;Y<V;++Y)u[Y]=a(j?c.charAt(Y):c[Y]);return u}function R(a,c,j){for(var u=j.charAt,Y=j.length-1;Y>-1;--Y)c=a(u?j.charAt(Y):j[Y],c);return c}function eb(a,c){var j=a.charAt,u=c.charAt;if(j)return a.concat(u?c:c.join(""));if(u)return(j?a:a.join("")).concat(c);return a.concat(c)}function wb(a){return a.charCodeAt(0)}
function fb(a){return function(){return a().apply(null,arguments)}}function Ea(a,c){!ignoreAsserts&&!a&&U("AssertionFailed");return c}function xb(a){return function(){return a}}function pb(a,c){return function(j){var u=I(arguments,1);u.unshift(c(j));return a.apply(null,u)}}function Fb(a,c){return function(){return a(c.apply(null,arguments))}}function Ba(a){return function(c,j){return a(j,c)}}function Gb(a,c,j){return a(j)?j:Gb(a,c,c(j))}function X(a,c){var j=c.length;if(!j)return Ha.Nothing;for(var u=
!!c.charAt,Y=p(oa,za(u?c.charAt(0):c[0])),V=0;V<j;++V)if(Y.eq(u?c.charAt(V):c[V],a))return Ha.Just(V);return Ha.Nothing}function yb(a,c){return a===c?B.EQ:a<=c?B.LT:B.GT}function Hb(a){return parseInt(a.join?a.join(""):a,16)}function zb(a){return parseInt(a.join?a.join(""):a,8)}function Ha(){}function rb(a){a.length||P("head");return a.charAt?a.charAt(0):a[0]}function Mb(a){a.length||P("tail");return a.substr?a.substr(1):I(a,1)}function Nb(a){var c=a.length;c||P("last");c=c-1;return a.charAt?a.charAt(c):
a[c]}function Ma(a){var c=a.length;c||P("init");c=c-1;return a.substring?a.substring(0,c):[].slice.call(a,0,c)}function lb(a){return!a.length}function ka(a){return a.length}function mb(a,c){for(var j=[],u=0,Y=c.length,V=c.charAt;u<Y;++u)if(a(V?c.charAt(u):c[u]))j.push(c[u]);return V?j.join(""):j}function Ia(a,c,j){for(var u=0,Y=j.length,V=j.charAt;u<Y;++u)c=a(c,V?j.charAt(u):j[u]);return c}function sb(a,c,j){if(j.length){j=ta(j);a=sb(a,a(c,j.head),j.tail)}else a=La(j);return ia(c,a)}function aa(a,
c){if(!c.length)return La(c);c=ta(c);return sb(a,c.head,c.tail)}function ua(a,c){var j=c.length;j==0&&P("foldr1");if(j==1)return c.charAt?c.charAt(0):c[0];c=ta(c);return a(c.head,ua(a,c.tail))}function ra(a,c,j){if(!j.length)return ia(c,La(j));j=ta(j);c=ra(a,c,j.tail);return ia(a(j.head,c.head),c)}function tb(a,c){var j=c.length;if(j==0)return La(c);if(j==1)return ia(c.charAt?c.charAt(0):c[0],La(c));c=ta(c);j=tb(a,c.tail);return ia(a(c.head,j.head),j)}function Ib(a,c){for(var j=[],u=0;u<a;++u)j[u]=
c;return j}function Jb(a,c){for(var j=!!c.charAt,u=0,Y=c.length;u<Y;++u)if(!a(j?c.charAt(u):c[u]))break;return j?c.substring(0,u):[].slice.call(c,0,u)}function Kb(a,c){for(var j=!!c.charAt,u=0,Y=c.length;u<Y;++u)if(!a(j?c.charAt(u):c[u]))break;return j?c.substr(u):I(c,u)}function kb(a,c){return c.substring?c.substring(0,a):[].slice.call(c,0,a)}function T(a,c){return c.substring?c.substring(a):[].slice.call(c,a)}function Ab(a,c){a=[kb(a,c),T(a,c)];a.constructor=Qa.Tuple2;return a}function Bb(a,c){a=
[Jb(a,c),Kb(a,c)];a.constructor=Qa.Tuple2;return a}function ub(a,c){return Bb(function(j){return!a(j)},c)}function Lb(a){a=a.charAt;var c=da(c);c.reverse();return a?c.join(""):c}function Ya(a){return R(jb,true,a)}function vb(a){return R(pa,false,a)}function Ob(a,c){return vb(t(a,c))}function Oa(a,c){return Ya(t(a,c))}function hb(a,c){return ca(a,c)!=-1}function ob(a,c){return ca(a,c)==-1}function ha(a,c){var j=c.length;if(!j)return Ha.Nothing;for(var u=!!c.charAt,Y=ab(oa,"eq",a),V=0;V<j;++V){var C=
u?c.charAt(V):c[V];if(Y(C[0],a))return Ha.Just(C[1])}return Ha.Nothing}function Ta(a,c){return R(function(j,u){return eb(a(j),u)},[],c)}function qb(a){return R(eb,[],a)}function J(a,c){return a.charAt?a.charAt(c):a[c]}function Cb(a,c){for(var j=[],u=a.charAt,Y=c.charAt,V=0,C=Math.min(a.length,c.length);V<C;++V)j[V]=[u?a.charAt(V):a[V],Y?c.charAt(V):c[V]];return j}function qa(a,c,j){for(var u=[],Y=a.charAt,V=c.charAt,C=j.charAt,la=0,Ra=Math.min(a.length,c.length);la<Ra;++la)u[la]=[Y?a.charAt(la):a[la],
V?c.charAt(la):c[la],C?j.charAt(la):j[la]];return u}function Ua(a,c,j){for(var u=[],Y=c.charAt,V=j.charAt,C=0,la=Math.min(c.length,j.length);C<la;++C)u[C]=a(Y?c.charAt(C):c[C],V?j.charAt(C):j[C]);return u}function A(a,c,j,u){for(var Y=[],V=c.charAt,C=j.charAt,la=u.charAt,Ra=0,Zb=Math.min(c.length,j.length);Ra<Zb;++Ra)Y[Ra]=a(V?c.charAt(Ra):c[Ra],C?j.charAt(Ra):j[Ra],la?u.charAt(Ra):u[Ra]);return Y}function Na(a){return R(function(c,j){return[ia(c[0],j[0]),ia(c[1],j[1])]},[[],[]],a)}function ba(a){return R(function(c,
j){return[ia(c[0],j[0]),ia(c[1],j[1]),ia(c[2],j[2])]},[[],[],[]],a)}function P(a){return U("Prelude."+a+": empty list")}function d(a){return/^\s$/.test(a)}function g(a){return a.toUpperCase()==a}function m(a){return a.toLowerCase()==a}function o(a){return/^\w$/.test(a)&&/^\D$/.test(a)}function v(a){return/^\w$/.test(a)}function D(a){return/^\d$/.test(a)}function K(a){return/^[0-7]$/.test(a)}function fa(a){return/^[0-9A-Fa-f]$/.test(a)}function L(a){return a.toUpperCase()}function na(a){return a.toLowerCase()}
function W(a){return a.toUpperCase()}var Ca=NS.Haskell.Bool,I=NS.Haskell.slice,xa=NS.Haskell.imap,ca=NS.Haskell.indexOf,gb=NS.Haskell.extend,n=NS.Haskell.namespace,za=NS.Haskell.typeOf,Pa=NS.Haskell.strictEq,Za=NS.Haskell.strictNe,sa=NS.Haskell.lt,ga=NS.Haskell.le,Va=NS.Haskell.gt,ya=NS.Haskell.ge,da=NS.Haskell.toArray,M=NS.Haskell.curry,U=NS.Haskell.error,Wa=NS.Haskell.data,$a=NS.Haskell.typeclass,ja=NS.Haskell.VARARG,Aa=NS.Haskell.instance,p=NS.Haskell.getInstance,ab=NS.Haskell.asTypeOf,Fa=NS.Haskell.operators,
bb=NS.Haskell.infixr,Db=NS.Haskell.createDo,Xa=NS.Haskell.Scope;Wa(B,["LT","EQ","GT"]);n("GHC_Ordering",{Ordering:B});var oa=$a("Eq","a").types({eq:["a","a",Boolean],ne:["a","a",Boolean]}).impl(function(a){return{eq:function(c,j){return!a.ne(c,j)},ne:function(c,j){return!a.eq(c,j)}}}),Ga=$a("Ord","a").context(oa).types({compare:["a","a",B],"<":["a","a",Boolean],"<=":["a","a",Boolean],">":["a","a",Boolean],">=":["a","a",Boolean],max:["a","a","a"],min:["a","a","a"]}).impl(function(a){var c=p(oa,a._type).eq;
return{compare:function(j,u){return c(j,u)?B.EQ:a["<="](j,u)?B.LT:B.GT},"<":function(j,u){return a.compare(j,u).LT?true:false},"<=":function(j,u){return a.compare(j,u).GT?false:true},">":function(j,u){return a.compare(j,u).GT?true:false},">=":function(j,u){return a.compare(j,u).LT?false:true},max:function(j,u){return a["<="](j,u)?u:j},min:function(j,u){return a["<="](j,u)?j:u}}});n("GHC_Classes",{Eq:oa,Ord:Ga,andOp:jb,orOp:pa,not:db});var Qa={};xa(function(a){var c="Tuple"+a;Qa[c]=function(){};Qa[c]._name=
c;Qa["tuple"+a]=function(j){j.constructor=Qa[c];return j}},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]);Qa.tuple=S;n("GHC_Tuple",{Tuple:Qa,tuple:S});Wa(ma,["Unit"]);n("GHC_Unit",{Unit:ma,unit:ma.Unit});xa=$a("Functor","f").types({fmap:[Function,"f","f"],"<$":["a","f","f"]}).impl(function(a){return{"<$":function(c,j){return a.fmap(xb(c),j)}}});ja=$a("Monad","m").types({">>=":["m",Function,"m"],">>":["m","m","m"],return_:["a","m"],fail:[String,"m"],do_:ja,do$:ja,run:ja}).impl(function(a){return{">>":function(c,
j){c=a[">>="](c,xb(j));c.constructor=a._type;return c},fail:function(c){return U(c)},do_:function(){function c(Y){for(var V=new Xa(Y),C=1,la=j.length,Ra=j[0];C<la;++C)Ra=u(Ra,j[C]);C=_slice.call(arguments,1);C.unshift(V);return Ra.apply(null,C)}var j=arguments,u=a[">>"];c.constructor=a._type;return c},run:function(c){var j=I(arguments,1);j.unshift(new Xa);return c.apply(null,j)},do$:Db(a)}});var Pb=ia;Aa(oa,Boolean,{eq:Pa,ne:Za});Aa(Ga,Boolean,{compare:function(a,c){return a===true&&c===false?B.LT:
a===false&&c===true?B.GT:B.EQ}});Aa(oa,B,{eq:function(a,c){return a.EQ&&c.EQ?true:a.LT&&c.LT?true:a.GT&&c.GT?true:false}});Aa(Ga,B,{"<=":function(a,c){return a.LT?true:c.LT?false:a.EQ?true:c.EQ?false:a.GT&&c.GT?true:U()}});Aa(oa,String,{eq:Pa,ne:Za});var Tb=String.fromCharCode,fc=Number.MIN_VALUE,Xb=Number.MAX_VALUE;Aa(oa,Number,{eq:Pa,ne:Za});Aa(Ga,Number,{compare:function(a,c){return a===c?B.EQ:a<=c?B.LT:B.GT},"<":sa,"<=":ga,">":Va,">=":ya,max:function(a,c){return a<=c?c:a},min:function(a,c){return a<=
c?a:c}});Za=function(a){return a};M=M(function(a,c){return a(c)});Aa(oa,RegExp,{eq:function(a,c){return a.source===c.source&&a.global===c.global&&a.ignoreCase===c.ignoreCase&&a.multiline===c.multiline}});Aa(oa,Array,{eq:function(a,c){var j=a.length;if(j!=c.length)return false;for(var u=0;u<j;++u)if(!oa.eq(a[u],c[u]))return false;return true}});Aa(oa,Object,{eq:function(a,c){var j,u={};for(j in a)u[j]=true;for(j in c)u[j]=true;for(j in u)if(!oa.eq(a[j],c[j]))return false;return true}});sa=Math.round;
ga=parseInt;gb(Fa,{$:{func:M,fixity:bb(0)},".":{func:pb,fixity:bb(9)},":":{func:ia,fixity:bb(5)},"++":{func:eb,fixity:bb(5)}});n("GHC_Base",{Unit:ma,Tuple:Qa,Bool:Ca,Ordering:B,Eq:oa,Ord:Ga,andOp:jb,orOp:pa,not:db,Functor:xa,Monad:ja,emptyListOf:La,cons:ia,consJoin:Q,uncons:ta,augment:Pb,map:t,foldr:R,append:eb,otherwise:true,ord:wb,chr:Tb,eqString:Pa,minInt:fc,maxInt:Xb,id:Za,lazy:fb,assert:Ea,const_:xb,compose1:pb,compose:Fb,flip:Ba,call:M,until:Gb,asTypeOf:ab,elemIndex:X,unsafeCompare:yb,readHex:Hb,
readOct:zb,round:sa,toInteger:ga,fromInteger:Za,fromIntegral:Za});var va=$a("Show","a").types({show:["a",String]}).impl({show:function(a){return a.toString()}});Aa(va,ma,{show:function(){return"()"}});Aa(va,Boolean);Aa(va,String,{show:function(a){return'"'+a.toString()+'"'}});Aa(va,Number);Aa(va,RegExp);Aa(va,Function,{show:function(a){var c=a.name||a._name||"\u03bb";if(a.constructor)return c+" :: "+a.constructor.name;a=(a=a.toString().match(/\([^\)]*\)/))&&a[0]||"";return c+a}});Aa(va,Array,{show:function(a){return typeof a[0]==
String?'"'+a.join("")+'"':"["+t(va.show,a).join(", ")+"]"}});Aa(va,Object,{show:function(a){var c=[];for(var j in a)c.push("  "+j+": "+va.show(a[j]));return"{\n"+a.join(",\n")+"\n}"}});n("GHC_Show",{Show:va});Wa(Ha,[["Just","a"],"Nothing"]);n("GHC_Maybe",{Maybe:Ha});n("GHC_List",{map:t,append:eb,filter:mb,concat:qb,head:rb,last:Nb,tail:Mb,init:Ma,null_:lb,length:ka,index:J,foldl:Ia,scanl:sb,scanl1:aa,foldr:R,foldr1:ua,scanr:ra,scanr1:tb,replicate:Ib,take:kb,drop:T,splitAt:Ab,takeWhile:Jb,dropWhile:Kb,
span:Bb,break_:ub,reverse:Lb,and:Ya,or:vb,any:Ob,all:Oa,elem:hb,notElem:ob,lookup:ha,concatMap:Ta,zip:Cb,zip3:qa,zipWith:Ua,zipWith3:A,unzip:Na,unzip3:ba,errorEmptyList:P});n("GHC_Unicode",{isSpace:d,isUpper:g,isLower:m,isAlpha:o,isAlphaNum:v,isDigit:D,isHexDigit:fa,isOctDigit:K,toUpper:L,toLower:na,toTitle:W})})();(function(){function B(b,f,k){if(k.Nothing)return b;if(k.Just)return f(k[0])}function jb(b){return!!b.Just}function pa(b){return!!b.Nothing}function db(b){return b.Nothing?I("Maybe.fromJust: Nothing"):
b.Just?b[0]:I()}function S(b,f){return f.Nothing?b:f.Just?f[0]:I(S)}function ma(b){return b.Nothing?[]:b.Just?[b[0]]:I(ma)}function La(b){if(!b.length)return da(b);return za.Just(b[0])}function ia(b){for(var f=[],k=0,w=b.length;k<w;++k)b[k].Just&&f.push(b[k][0]);return f}function Q(b,f){var k=U(f);f=Q(b,k.tail);b=b(k.head);return b.Nothing?f:b.Just?M(r,f):I(Q)}function ta(b,f){if(!b.length)return za.Just(f);b=U(b);f=U(f);if(b.head===f.head)return ta(b.tail,f.tail);return za.Nothing}function t(b,f){return wb(function(){return sa.eq(b)},
f)}function R(b,f){return fb(function(){return sa.eq(b)},f)}function eb(b,f){return La(Db(b,f))}function wb(b,f){return La(fb(b,f))}function fb(b,f){function k(w,N){if(!f.length)return f;return b(x)?M(w,k(w+1,N)):k(w+1,N)}return k(0,f)}function Ea(b,f){if(!b.length)return true;if(!f.length)return false;b=U(b);f=U(f);return b.head===f.head&&Ea(b.tail,f.tail)}function xb(b,f){return Ea(gc(b),gc(f))}function pb(b,f){return F(function(k){return Ea(b,k)},Ab(f))}function Fb(b){function f(k,w){var N=U(k);
return!k.length?da(k):O(N.head,w)?f(N.tail,w):M(N.head,f(N.tail,M(N.head,w)))}return f(b,da(b))}function Ba(b,f){return nub_(f,da(f))}function Gb(b,f){return X(sa.eq,b,f)}function X(b,f,k){if(!k.length)return da(k);k=U(k);return b(f,k.head)?k.tail:M(k.head,X(b,f,k.tail))}function yb(b,f){return va(bb(Gb),b,f)}function Hb(b,f){return zb(sa.eq,b,f)}function zb(b,f,k){return ja(f,va(function(w,N){return X(b,N,w)},Ba(b,k),f))}function Ha(b,f){return rb(sa.eq,b,f)}function rb(b,f,k){return Db(function(w){return F(function(N){return b(w,
N)},k)},f)}function Mb(b,f){if(!f.length)return da(f);if(f.length==1)return M(oa(f),da(f));f=U(f);return M(f.head,M(b,Mb(b,f.tail)))}function Nb(b,f){return Xa(Mb(b,f))}function Ma(b){if(!b.length)return da(b);b=U(b);if(!b.head.length)return Ma(b.tail);var f=U(b.head),k=f.head;f=f.tail;b=b.tail;return U(U(k,Wa(oa,b)),Ma(U(f,Wa(Qa,b))))}function lb(b,f){return $a(function(k,w){return ka(b,k,w)},[da(f),da(f)],f)}function ka(b,f,k){var w=k[0];k=k[1];return b(f)?[M(f,w),k]:[w,M(f,k)]}function mb(b,f,
k){if(!k.length)return[f,da(k)];k=U(k);var w=b(f,x);f=w[1];b=mb(b,w[0],k.tail);return[b[0],M(f,b[1])]}function Ia(b,f,k){if(!k.length)return[f,da(k)];k=U(k);k=Ia(b,f,k.tail);f=k[1];b=b(k[0],x);return[b[0],M(b[1],f)]}function sb(b,f){var k=gb(ga,K(b));return aa(k.compare,b,f)}function aa(b,f,k){if(!k.length)return M(f,da(k));k=U(k);return b(f,k.head).GT?M(k.head,aa(b,f,k.tail)):M(f,k.tail)}function ua(b){if(!b.length)return $b("maximum");var f=gb(ga,K(oa(b)));return Oa(f.max,b)}function ra(b){if(!b.length)return $b("minimum");
var f=gb(ga,K(oa(b)));return Oa(f.min,b)}function tb(b,f){function k(w,N){return b(w,N).GT?w:N}if(!f.length)return $b("maximumBy");return Oa(k,f)}function Ib(b,f){function k(w,N){return b(w,N).GT?N:w}if(!f.length)return $b("minimumBy");return Oa(k,f)}function Jb(b,f,k){return va(function(w,N){return X(b,N,w)},f,k)}function Kb(b){return kb(sa.eq,b)}function kb(b,f){if(!f.length)return da(f);var k=U(f);f=ac(function(w){return b(x,w)},f);return M(M(k.head,f.ys),kb(b,f.zs))}function T(b){if(!b.length)return[da(b)];
return ja([da(b)],Wa(function(f){return M(x,f)},T(b)))}function Ab(b){if(!xs.length)return[da(b)];return M(b,Ab(Qa(b)))}function Bb(b){return M([],ub(b))}function ub(b){function f(w,N){return M(w,M(M(k.head,w),N))}var k=U(b);return M(k.head,$a(f,[],ub(k.tail)))}function Lb(b){function f(k,w){function N(bc,Qb){return Ja(ab,bc,Qb)[1]}function Ja(bc,Qb,Eb){if(!Qb.length)return[cb.tail,Eb];var cc=U(Qb).head;Eb=Ja(Fa(bc,function(lc){M(cc,lc)}),Qb,Eb);Qb=Eb[0];Eb=Eb[1];return[M(cc,Qb),M(bc(M(cb.head,M(cc,
Qb))),Eb)]}if(!k.length)return da(k);var cb=U(k);return $a(N,f(cb.tail,M(cb.head,w)),Lb(w))}return M(b,f(b,[]))}function Ya(b){var f=gb(ga,K(b.charAt?b.charAt(0):b[0]));return vb(f.compare,b)}function vb(b,f){function k(w,N){w=b(w,N);return w.LT?-1:w.GT?1:w.EQ?0:I(Ya)}if(f.sort)return f.sort(k);return v(f).sort(k).join("")}function Ob(b,f){f=b(f);return f.Just?M(f[0][0],Ob(b,f[0][1])):f.Nothing?[]:I()}function Oa(b,f){if(!f.length)return $b("foldl1");f=U(f);return va(b,f.head,f.tail)}function hb(b){return va(na,
0,b)}function ob(b){return va(Ca,1,b)}function ha(b){b=b.split("\n");b[b.length-1]==""&&b.pop();return b}function Ta(b){return b.join("\n")}function qb(b){b=b.split(/\s+/);b[0]==""&&b.shift();b[b.length-1]==""&&b.pop();return b}function J(b){return b.join(" ")}function Cb(b){return b[0]}function qa(b){return b[1]}function Ua(b){return function(f,k){f=[f,k];f.constructor=Pa.Tuple2;return b(f)}}function A(b){return function(f){return b(f[0],f[1])}}function Na(){}function ba(b,f,k){return k.Left?b(k[0]):
k.Right?f(k[0]):I(ba)}function P(b){for(var f=[],k=0,w=b.length;k<w;++k){var N=b[k];N.Left&&f.push(N[0])}return f}function d(b){for(var f=[],k=0,w=b.length;k<w;++k){var N=b[k];N.Right&&f.push(N[0])}return f}function g(b){function f(w){return function(N){return[M(w,N[0]),N[1]]}}function k(w){return function(N){return[N[0],M(w,N[1])]}}return $a(function(w,N){return ba(f,k,w)(N)},[[],[]],b)}function m(b){b=parseInt(b,16);return isNaN(b)?I(m):b}var o=NS.Haskell.Bool;o=NS.Haskell.isArray;o=NS.Haskell.isDefined;
var v=NS.Haskell.slice;o=NS.Haskell.imap;var D=NS.Haskell.ifilter;D=NS.Haskell.indexOf;D=NS.Haskell.lastIndexOf;D=NS.Haskell.isort;D=NS.Haskell.range;D=NS.Haskell.extend;D=NS.Haskell.namespace;var K=NS.Haskell.typeOf,fa=NS.Haskell.strictEq,L=NS.Haskell.strictNe,na=NS.Haskell.unsafeAdd,W=NS.Haskell.unsafeSub,Ca=NS.Haskell.unsafeMul;W=NS.Haskell.unsafeDiv;W=NS.Haskell.lt;W=NS.Haskell.le;W=NS.Haskell.gt;W=NS.Haskell.ge;W=NS.Haskell.negate;W=NS.Haskell.evalThunks;W=NS.Haskell.toArray;W=NS.Haskell.curry;
var I=NS.Haskell.error;W=NS.Haskell.data;var xa=NS.Haskell.ADT;xa=NS.Haskell.record;xa=NS.Haskell.accessor;xa=NS.Haskell.accessors;var ca=NS.Haskell.instance,gb=NS.Haskell.getInstance,n=NS.Haskell.asTypeOf,za=NS.GHC_Maybe.Maybe;n=NS.GHC_Base.Unit;var Pa=NS.GHC_Base.Tuple;o=NS.GHC_Base.Bool;var Za=NS.GHC_Base.Ordering,sa=NS.GHC_Base.Eq,ga=NS.GHC_Base.Ord;o=NS.GHC_Base.andOp;o=NS.GHC_Base.orOp;o=NS.GHC_Base.not;var Va=NS.GHC_Base.Functor,ya=NS.GHC_Base.Monad,da=NS.GHC_Base.emptyListOf,M=NS.GHC_Base.cons,
U=NS.GHC_Base.uncons,Wa=NS.GHC_Base.map,$a=NS.GHC_Base.foldr,ja=NS.GHC_Base.append,Aa=NS.GHC_Base.ord,p=NS.GHC_Base.chr,ab=NS.GHC_Base.id,Fa=NS.GHC_Base.compose1,bb=NS.GHC_Base.flip;n=NS.GHC_Base.asTypeOf;t=NS.GHC_Base.elemIndex;Wa=NS.GHC_List.map;ja=NS.GHC_List.append;var Db=NS.GHC_List.filter,Xa=NS.GHC_List.concat,oa=NS.GHC_List.head,Ga=NS.GHC_List.last,Qa=NS.GHC_List.tail,Pb=NS.GHC_List.init,Tb=NS.GHC_List.null_,fc=NS.GHC_List.length,Xb=NS.GHC_List.index,va=NS.GHC_List.foldl,a=NS.GHC_List.scanl,
c=NS.GHC_List.scanl1;$a=NS.GHC_List.foldr;var j=NS.GHC_List.foldr1,u=NS.GHC_List.scanr,Y=NS.GHC_List.scanr1,V=NS.GHC_List.replicate,C=NS.GHC_List.take,la=NS.GHC_List.drop,Ra=NS.GHC_List.splitAt,Zb=NS.GHC_List.takeWhile,Z=NS.GHC_List.dropWhile,ac=NS.GHC_List.span,hc=NS.GHC_List.break_,gc=NS.GHC_List.reverse,i=NS.GHC_List.and,s=NS.GHC_List.or,F=NS.GHC_List.any,E=NS.GHC_List.all,O=NS.GHC_List.elem,$=NS.GHC_List.notElem,Ka=NS.GHC_List.lookup,Ub=NS.GHC_List.concatMap,pc=NS.GHC_List.zip,ea=NS.GHC_List.zip3,
Da=NS.GHC_List.zipWith,Rb=NS.GHC_List.zipWith3,qc=NS.GHC_List.unzip,rc=NS.GHC_List.unzip3,$b=NS.GHC_List.errorEmptyList;n=NS.GHC_Unit.Unit;var mc=NS.GHC_Unit.unit;Pa=NS.GHC_Tuple.Tuple;Za=NS.GHC_Ordering.Ordering;sa=NS.GHC_Classes.Eq;ga=NS.GHC_Classes.Ord;o=NS.GHC_Classes.andOp;o=NS.GHC_Classes.orOp;o=NS.GHC_Classes.not;o=NS.Haskell_Main.Bool;o=NS.Haskell_Main.isArray;o=NS.Haskell_Main.isDefined;v=NS.Haskell_Main.slice;o=NS.Haskell_Main.imap;D=NS.Haskell_Main.ifilter;D=NS.Haskell_Main.indexOf;D=NS.Haskell_Main.lastIndexOf;
D=NS.Haskell_Main.isort;D=NS.Haskell_Main.range;D=NS.Haskell_Main.extend;D=NS.Haskell_Main.namespace;K=NS.Haskell_Main.typeOf;fa=NS.Haskell_Main.strictEq;L=NS.Haskell_Main.strictNe;na=NS.Haskell_Main.unsafeAdd;W=NS.Haskell_Main.unsafeSub;Ca=NS.Haskell_Main.unsafeMul;W=NS.Haskell_Main.unsafeDiv;W=NS.Haskell_Main.lt;W=NS.Haskell_Main.le;W=NS.Haskell_Main.gt;W=NS.Haskell_Main.ge;W=NS.Haskell_Main.negate;W=NS.Haskell_Main.evalThunks;W=NS.Haskell_Main.toArray;W=NS.Haskell_Main.curry;I=NS.Haskell_Main.error;
W=NS.Haskell_DataType.data;xa=NS.Haskell_DataType.ADT;xa=NS.Haskell_DataType.record;xa=NS.Haskell_DataType.accessor;xa=NS.Haskell_DataType.accessors;xa=NS.GHC_Unicode.isSpace;var sc=NS.GHC_Unicode.isUpper,tc=NS.GHC_Unicode.isLower,Bc=NS.GHC_Unicode.isAlpha,Cc=NS.GHC_Unicode.isAlphaNum,e=NS.GHC_Unicode.isDigit,h=NS.GHC_Unicode.isHexDigit,l=NS.GHC_Unicode.isOctDigit,y=NS.GHC_Unicode.toUpper,G=NS.GHC_Unicode.toLower,H=NS.GHC_Unicode.toTitle;ca(Va,za,{fmap:function(b,f){return f.Nothing?za.Nothing:f.Just?
za.Just(b(f[0])):I("Functor.Maybe.fmap")}});ca(ya,za,{">>=":function(b,f){return b.Just?f(b[0]):b.Nothing?za.Nothing:I("Monad.Maybe.>>=")},">>":function(b,f){return b.Just?f:b.Nothing?za.Nothing:I("Monad.Maybe.>>")},return_:za.Just,fail:za.Nothing});D("Data_Maybe",{Maybe:za,maybe:B,isJust:jb,isNothing:pa,fromJust:db,fromMaybe:S,listToMaybe:La,maybeToList:ma,catMaybes:ia,mapMaybe:Q});var z={};o(function(b){z["zip"+b]=function(){return z["zipWith"+b](Pa["tuple"+b](v(arguments)))};z["zipWith"+b]=function(f){var k=
Wa(U,v(arguments,1)),w=Wa(Cb,k);k=Wa(qa,k);return M(f.apply(null,w),z["zipWith"+b].apply(null,[f].concat(k)))};z["unzip"+b]=function(f){return $a(function(k,w){return Wa(M,k,w)},V(b,[]),f)}},[4,5,6,7]);D("Data_List",{append:ja,head:oa,last:Ga,tail:Qa,init:Pb,null_:Tb,length:fc,map:Wa,reverse:gc,intersperse:Mb,intercalate:Nb,transpose:Ma,subsequences:Bb,permutations:Lb,foldl:va,foldl1:Oa,foldr:$a,foldr1:j,concat:Xa,concatMap:Ub,and:i,or:s,any:F,all:E,sum:hb,product:ob,maximum:ua,minimum:ra,scanl:a,
scanl1:c,scanr:u,scanr1:Y,mapAccumL:mb,mapAccumR:Ia,replicate:V,unfoldr:Ob,take:C,drop:la,splitAt:Ra,takeWhile:Zb,dropWhile:Z,span:ac,break_:hc,stripPrefix:ta,group:Kb,inits:T,tails:Ab,isPrefixOf:Ea,isSuffixOf:xb,isInfixOf:pb,elem:O,notElem:$,lookup:Ka,find:eb,filter:Db,partition:lb,index:Xb,elemIndex:t,elemIndices:R,findIndex:wb,findIndices:fb,zip:pc,zip3:ea,zip4:z.zip4,zip5:z.zip5,zip6:z.zip6,zip7:z.zip7,zipWith:Da,zipWith3:Rb,zipWith4:z.zipWith4,zipWith5:z.zipWith5,zipWith6:z.zipWith6,zipWith7:z.zipWith7,
unzip:qc,unzip3:rc,unzip4:z.unzip4,unzip5:z.unzip5,unzip6:z.unzip6,unzip7:z.unzip7,lines:ha,words:qb,unlines:Ta,unwords:J,nub:Fb,delete_:Gb,difference:yb,union:Hb,intersect:Ha,sort:Ya,insert:sb,nubBy:Ba,deleteBy:X,deleteFirstsBy:Jb,unionBy:zb,intersectBy:rb,groupBy:kb,sortBy:vb,insertBy:aa,maximumBy:tb,minimumBy:Ib});ca(sa,n,{eq:fa,ne:L});ca(ga,n,{"<=":function(){return true},"<":function(){return false},">=":function(){return true},">":function(){return false},max:function(){return mc},min:function(){return mc},
compare:function(){return Za.EQ}});D("Data_Tuple",{fst:Cb,snd:qa,curry_:Ua,uncurry:A});W(Na,[["Left","a"],["Right","b"]]);D("Data_Either",{Either:Na,either:ba,lefts:P,rights:d,partitionEithers:g});D("Data_Char",{String:String,ord:Aa,chr:p,isSpace:xa,isUpper:sc,isLower:tc,isAlpha:Bc,isAlphaNum:Cc,isDigit:e,isHexDigit:h,isOctDigit:l,toUpper:y,toLower:G,toTitle:H,digitToInt:m})})();(function(){var B=NS.Haskell.Bool,jb=NS.Haskell.namespace,pa=NS.Haskell.curry,db=NS.Haskell.error,S=NS.Haskell.asTypeOf,
ma=NS.Data_Either.Either,La=NS.Data_Either.either,ia=NS.Data_Tuple.fst,Q=NS.Data_Tuple.snd,ta=NS.Data_Tuple.curry_,t=NS.Data_Tuple.uncurry,R=NS.Data_List.append,eb=NS.Data_List.head,wb=NS.Data_List.last,fb=NS.Data_List.tail,Ea=NS.Data_List.init,xb=NS.Data_List.null_,pb=NS.Data_List.length,Fb=NS.Data_List.map,Ba=NS.Data_List.reverse,Gb=NS.Data_List.foldl,X=NS.Data_List.foldl1,yb=NS.Data_List.foldr,Hb=NS.Data_List.foldr1,zb=NS.Data_List.concat,Ha=NS.Data_List.concatMap,rb=NS.Data_List.and,Mb=NS.Data_List.or,
Nb=NS.Data_List.any,Ma=NS.Data_List.all,lb=NS.Data_List.sum,ka=NS.Data_List.product,mb=NS.Data_List.maximum,Ia=NS.Data_List.minimum,sb=NS.Data_List.scanl,aa=NS.Data_List.scanl1,ua=NS.Data_List.scanr,ra=NS.Data_List.scanr1,tb=NS.Data_List.replicate,Ib=NS.Data_List.take,Jb=NS.Data_List.drop,Kb=NS.Data_List.splitAt,kb=NS.Data_List.takeWhile,T=NS.Data_List.dropWhile,Ab=NS.Data_List.span,Bb=NS.Data_List.break_,ub=NS.Data_List.elem,Lb=NS.Data_List.notElem,Ya=NS.Data_List.lookup,vb=NS.Data_List.filter,Ob=
NS.Data_List.index,Oa=NS.Data_List.elemIndex,hb=NS.Data_List.zip,ob=NS.Data_List.zip3,ha=NS.Data_List.zipWith,Ta=NS.Data_List.zipWith3,qb=NS.Data_List.unzip,J=NS.Data_List.unzip3,Cb=NS.Data_List.lines,qa=NS.Data_List.words,Ua=NS.Data_List.unlines,A=NS.Data_List.unwords,Na=NS.Data_Maybe.Maybe,ba=NS.Data_Maybe.maybe;B=NS.GHC_Base.Bool;var P=NS.GHC_Base.Ordering,d=NS.GHC_Base.Eq,g=NS.GHC_Base.Ord,m=NS.GHC_Base.andOp,o=NS.GHC_Base.orOp,v=NS.GHC_Base.not,D=NS.GHC_Base.Functor,K=NS.GHC_Base.Monad,fa=NS.GHC_Base.cons,
L=NS.GHC_Base.consJoin,na=NS.GHC_Base.uncons;Fb=NS.GHC_Base.map;yb=NS.GHC_Base.foldr;R=NS.GHC_Base.append;var W=NS.GHC_Base.otherwise,Ca=NS.GHC_Base.id,I=NS.GHC_Base.const_,xa=NS.GHC_Base.compose1,ca=NS.GHC_Base.compose,gb=NS.GHC_Base.flip,n=NS.GHC_Base.call,za=NS.GHC_Base.until;S=NS.GHC_Base.asTypeOf;Oa=NS.GHC_Base.elemIndex;var Pa=NS.GHC_Base.fromIntegral;jb("Prelude",{cons:fa,consJoin:L,uncons:na,elemIndex:Oa,unsafeCompare:NS.GHC_Base.unsafeCompare,readHex:NS.GHC_Base.readHex,readOct:NS.GHC_Base.readOct,
round:NS.GHC_Base.round,toInteger:NS.GHC_Base.toInteger,fromInteger:NS.GHC_Base.fromInteger,fromIntegral:Pa,Bool:B,andOp:m,orOp:o,not:v,otherwise:W,Maybe:Na,maybe:ba,Either:ma,either:La,Ordering:P,String:String,fst:ia,snd:Q,curry:pa,curry_:ta,uncurry:t,Eq:d,Ord:g,fromIntegral:Pa,Monad:K,Functor:D,id:Ca,const_:I,compose:ca,compose1:xa,flip:gb,call:n,until:za,asTypeOf:S,error:db,map:Fb,append:R,filter:vb,head:eb,last:wb,tail:fb,init:Ea,null_:xb,length:pb,index:Ob,reverse:Ba,foldl:Gb,foldl1:X,foldr:yb,
foldr1:Hb,and:rb,or:Mb,any:Nb,all:Ma,sum:lb,product:ka,concat:zb,concatMap:Ha,maximum:mb,minimum:Ia,scanl:sb,scanl1:aa,scanr:ua,scanr1:ra,replicate:tb,take:Ib,drop:Jb,splitAt:Kb,takeWhile:kb,dropWhile:T,span:Ab,break_:Bb,elem:ub,notElem:Lb,lookup:Ya,zip:hb,zip3:ob,zipWith:ha,zipWith3:Ta,unzip:qb,unzip3:J,lines:Cb,words:qa,unlines:Ua,unwords:A,Show:NS.GHC_Show.Show})})();(function(){function B(e,h){this.input=e;this.index=h||0;this.length=e.length-this.index;this.cache={};return this}function jb(e){return new B(e)}
function pa(e){return function(h,l,y){return y({ast:null,success:false,expecting:{unexpected:e}})}}function db(e){return function(h,l,y){return y({success:false,expecting:e})}}function S(e,h,l){return l({success:false})}function ma(e){return typeof e=="string"?Ka(e):Cb(e)?W(e):e}function La(e,h,l,y,G){var H=h instanceof B?h:jb(h);P(e(new xa,H,function(z){z.state=H;delete z.index;delete z.length;if(z.success){delete z.error;delete z.expecting}else{z.error=ia(z.expecting,z.state);y&&y(z.error)}l(z)}),
G)}function ia(e,h,l,y){l=l===undefined?h.index:l;if(typeof e=="string"){var G=h.input.split("\n"),H=G.length,z=h.input.substr(l).split("\n").length;H=H-z+1;G=l-G.splice(0,H-1).join("\n").length;h=y||h.input.substr(l,e.length).substr(0,6);return'Unexpected "'+(h.length?h:"end of input")+(y?"":'", expecting "'+e)+'" at line '+H+" char "+G}if(Cb(e)){e=ja(function(b){return typeof b=="object"?b.expecting:b},e);return ia(e.join('" or "'),h)}else if(typeof e=="object")return ia(e.expecting,h,e.at,e.unexpected)}
function Q(){}function ta(e,h){return function(l,y,G){return function(){return e(l,y,function(H){return H.success?function(){return h(H.ast)(l,y,G)}:G(H)})}}}function t(e,h){if(e=="scope")throw"Can't use 'scope' as an identifier!";return function(l,y,G){return function(){return h(l,y,function(H){if(H.success)l[e]=H.ast;return G(H)})}}}function R(e,h){h&&qa(arguments);return function(l,y,G){return function(){return function(){var H;if(typeof e=="string"){if(!(e in l))throw'Not in scope: "'+e+'"';H=
l[e]}else H=e(l);return G({ast:H,success:true})}}}}function eb(e){var h=qa(arguments,1);return function(l){return e.apply(null,ja(function(y){return l[y]},h))}}function wb(e,h,l){return l({ast:h.index,success:true})}function fb(e){var h=typeof e;return function(l,y,G){y.scrollTo(h=="string"?l[e]:e);return G({success:true})}}function Ea(e){return function(h,l,y){return y({ast:e,success:true})}}function xb(e,h){return C(t("a",e),t("b",h),R(function(l){return l.a(l.b)}))}function pb(e,h){return C(t("x1",
h),la(e,"x1"))}function Fb(e,h,l){return C(t("x1",h),t("x2",l),la(e,"x1","x2"))}function Ba(e,h,l,y){return C(t("x1",h),t("x2",l),t("x3",y),la(e,"x1","x2","x3"))}function Gb(e,h){return C(t("a",e),h,R("a"))}function X(e,h){function l(y,G,H){return function(){return e(y,G,function(z){function b(k){var w=k.expecting;if(w)if(w.constructor==Array)f=f.concat(w);else f.push(w);k.expecting=k.success?c:f}var f=[];b(z);return z.ast!==c?function(){return H(z)}:function(){return h(y,G,function(k){b(k);return H(k)})}})}}
l.constructor=Q;return l}function yb(){var e=ja(ma,arguments);return function(h,l,y){for(var G=1,H=e.length,z=e[0];G<H;++G)z=X(z,e[G]);return z(h,l,y)}}function Hb(e){return function(h,l,y){function G(f){return function(k,w,N){return function(){return f(k,w,function(Ja){H++;if(!Ja.success)return N(Ja);Ja.ast!==c&&z.push(Ja.ast);return H<b?G(e[H])(k,w,N):N(Ja)})}}}var H=0,z=[],b=e.length;return function(){return G(e[H])(h,l,function(f){var k=f.success;return y({ast:z,success:k,expecting:k?c:f.expecting})})}}}
function zb(e){return function(h){return function(l,y,G){function H(f){return function(k,w,N){return function(){return f(k,w,function(Ja){if(!Ja.success)return N(Ja);z=true;Ja.ast!==c&&b.push(Ja.ast);return H(f)(k,w,N)})}}}var z=false,b=[];return function(){return H(h)(l,y,function(f){var k=!e||z&&e;return G({ast:k?b:c,success:k,expecting:k?c:f.expecting})})}}}}function Ha(e){return function(h){var l=Y++,y=function(G,H,z){G=H.index;var b=H.getCached(l);if(b!==c)return z(b);b=e(h,H,G);H.putCached(l,
G,b);return z(b)};y.constructor=Q;return y}}function rb(e){return function(h,l){var y=Y++,G=function(H,z,b){var f=z.index,k=z.getCached(y);if(k!==c)return b(k);return function(){return h(H,z,function(w){w=e(l,w,z,f);z.putCached(y,f,w);return b(w)})}};G.constructor=Q;return G}}function Mb(e){return function(h,l,y){return e(h)(h,l,y)}}function Nb(e){function h(l,y){return C(t("x",l),t("xs",y),R(eb(ca,"x","xs")))}return ab(h,Z([]),e)}function Ma(e){return ab(X,u,e)}function lb(e,h){return X(h,Z(e))}
function ka(e){return lb(ga.Nothing,pb(ga.Just,e))}function mb(e){return X(C(e,Z(null)),Z(null))}function Ia(e,h,l){return C(e,t("x",l),h,R("x"))}function sb(e){return C(e,E(e))}function aa(e,h){return X(ua(e,h),Z([]))}function ua(e,h){return C(t("x",e),t("xs",i(C(h,e))),la(ca,"x","xs"))}function ra(e,h){return C(t("x",e),X(C(h,t("xs",function(l,y,G){return tb(e,h)(l,y,G)}),R(function(l){return ca(l.scope.x,l.xs)})),R(function(l){return[l.x]})))}function tb(e,h){return X(ra(e,h),Z([]))}function Ib(e,
h){return s(C(t("x",e),h,R("x")))}function Jb(e,h){return i(C(t("x",e),h,R("x")))}function Kb(e,h){return e<=0?Z([]):Nb(Fa(e,h))}function kb(e,h,l){return X(Bb(e,h),Z(l))}function T(e,h,l){return X(Ab(e,h),Z(l))}function Ab(e,h){function l(y){var G=C(t("f",h),t("y",e),function(H,z,b){return l(H.f(y,H.y))(H,z,b)});return X(G,Z(y))}return ta(e,l)}function Bb(e,h){function l(G){var H=C(t("f",h),t("y",y),R(function(z){return z.f(G,z.y)}));return X(H,Z(G))}var y=ta(e,l);return y}function ub(e,h,l){e=h.at(0);
if(e.length){h.scroll(1);return l({ast:e,success:true})}return l({success:false,expecting:"anyToken"})}function Lb(e,h,l){return l({success:!h.length,expecting:h.length?"end of input":c})}function Ya(e){return F(X(ta(F(e),pa),Z(null)))}function vb(e,h){function l(G,H,z){return y(G,H,z)}var y=X(C(h,Z([])),C(t("x",e),t("xs",l),la(ca,"x","xs")));return y}function Ob(e){return C(t("state",Ra),t("x",e),Zb("state"),R("x"))}function Oa(){}function hb(){}function ob(e,h){function l(z,b){return function(f,
k,w){return z(f[b])(f,k,w)}}function y(z,b){var f=z[0],k=b[0],w=b[1],N=b[2],Ja=b[3];b=b[4];if(z.Infix){var cb=z[1];if(cb.AssocNone)return[k,w,ca(f,N),Ja,b];if(cb.AssocLeft)return[k,ca(f,w),N,Ja,b];if(cb.AssocRight)return[ca(f,k),w,N,Ja,b]}if(z.Prefix)return[k,w,N,ca(f,Ja),b];if(z.Postfix)return[k,w,N,Ja,ca(f,b)]}function G(z,b){return F(C(b,j("ambiguous use of a "+z+" associative operator")))}function H(z,b){function f(nb){return Da(ea("f","<-",cc)("y","<-",ea("z","<-",nc)(l,k,"z"))(R,function(Vb){return Vb.f(nb,
Vb.y)}),"<|>",uc,"<|>",vc)}function k(nb){return X(f(nb),Z(nb))}function w(nb){return Da(ea("f","<-",lc)("y","<-",nc)(function(Vb,Dc,Fc){return N(Vb.f(nb,Vb.y))(Vb,Dc,Fc)}),"<|>",wc,"<|>",vc)}function N(nb){return X(w(nb),Z(nb))}function Ja(nb){return ea("f","<-",xc)("y","<-",nc)(wc,"<|>",uc,"<|>",vc,"<|>",R,function(Vb){return Vb.f(nb,Vb.y)})}var cb=ab(y,[[],[],[],[],[]],b),bc=cb[1],Qb=cb[2],Eb=cb[3];b=cb[4];var cc=Ma(cb[0]),lc=Ma(bc),xc=Ma(Qb);cb=Ub(Ma(Eb),"");b=Ub(Ma(b),"");var wc=G("right",cc),
uc=G("left",lc),vc=G("non",xc);b=X(b,Z(M));cb=X(cb,Z(M));var nc=ea("pre","<-",cb)("x","<-",z)("post","<-",b)(R,function(nb){return nb.post(nb.pre(nb.x))});return ea("x","<-",nc)(l,f,"x","<|>",l,w,"x","<|>",l,Ja,"x","<|>",R,"x","<?>","operator").resolve()}return p(H,h,e)}function ha(){}function Ta(){}function qb(e){function h(q){return l(Ka(q))}function l(q){return C(t("x",q),Lc,R("x"))}function y(q,wa,Sa){return Mc(q,wa,Sa)}function G(q,wa,Sa){return Nc(q,wa,Sa)}function H(q,wa,Sa){return Gc(q,wa,
Sa)}function z(q){return Ia(h("("),h(")"),q)}function b(q){return Ia(h("{"),h("}"),q)}function f(q){return Ia(h("<"),h(">"),q)}function k(q){return Ia(h("["),h("]"),q)}function w(q){return aa(q,Hc)}function N(q){return aa(q,Ic)}function Ja(q){return ua(q,Hc)}function cb(q){return ua(q,Ic)}function bc(q){return C(O(q[0]),Z(q[1]))}function Qb(q){return F(C(Ka(q[0]),Z(q[1])))}function Eb(q,wa){return ea("digits","<-",s,wa)(R,function(Sa){return p(function(Sb,yc){return q*Sb+Pa(va(yc))},0,Sa.digits)})}
function cc(q,wa,Sa){return ic(q,wa,Sa)}function lc(q,wa){return(wa+sa(va(q)))/10}function xc(q){return q<0?1/xc(-q):Za(Math.pow(10,q))}function wc(q){return Da(ea("fract","<-",Qc)("expo","<-",lb,1,Oc)(R,function(wa){return Za(q+wa.fract)*wa.expo}),"<|>",ea("expo","<-",Oc)(R,function(wa){return Za(q)*wa.expo}))}function uc(q){return ea("f","<-",wc,q)(la,ya.Right,"f")}function vc(q){return Da(l,"$",F,ea(Ka(q))(Ya,e.opLetter,"<?>","end of "+q))}function nc(q){return Dc(Ua(e.reservedOpNames),q)}function nb(q){function wa(Sb){return!Sb.length?
Z(null):C(Ub(Sa(Sb[0]),""+q),wa(qa(Sb,1)))}function Sa(Sb){return Qa(Sb)?X(O(Sb.toLowerCase()),O(Sb.toUpperCase())):O(Sb)}return e.caseSensitive?Ka(q):C(wa(q),Z(q))}function Vb(q){return Da(l,"$",F,ea(nb(q))(Ya,e.identLetter,"<?>","end of "+q))}function Dc(q,wa){function Sa(yc){if(!yc.length)return false;var Jc=Sb(yc[0],wa);return Jc.LT?Sa(qa(yc,1)):Jc.EQ?true:Jc.GT?false:null}var Sb=za;return Sa(q)}function Fc(q){q=e.caseSensitive?q:q.toLowerCase();return Dc(Rc,q)}if(!e.LanguageDef)throw"Type error: unexpected '"+
e.constructor.name+"', expecting 'GenLanguageDef.LanguageDef'";var oc=sb($(Xa)),Ec=ea(F(Ka(e.commentLine)))(E,$(function(q){return q!="\n"}))(Z,null),ib=a(qa(e.commentEnd+e.commentStart)),Mc=Da(C(F(Ka(e.commentEnd)),Z(null)),"<|>",C(sb(qc(ib)),y),"<|>",C(Rb(ib),y),"<?>","end of comment"),Nc=Da(C(F(Ka(e.commentEnd)),Z(null)),"<|>",C(H,G),"<|>",C(sb(qc(ib)),G),"<|>",C(Rb(ib),G),"<?>","end of comment");ib=e.nestedComments?Nc:Mc;var Gc=C(F(Ka(e.commentStart)),ib);ib=Aa(e.commentLine);var Wb=Aa(e.commentStart),
Lc=I(ib&&Wb?[E,[oc,"<?>",""]]:ib?[E,[oc,"<|>",Gc,"<?>",""]]:Wb?[E,[oc,"<|>",Ec,"<?>",""]]:[E,[oc,"<|>",Ec,"<|>",Gc,"<?>",""]]),Ic=h(";"),Hc=h(",");oc=h(".");Ec=h(":");ib=Db(qa("abfnrtv\\\"'"),qa("a\u0008\u000c\n\r\t\u000b\\\"'"));Wb=Db(["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","SUB","ESC","DEL"].concat(["BS","HT","LF","VT","FF","CR","SO","SI","EM","FS","GS","RS","US","SP"]),["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","DLE","DC1","DC2",
"DC3","DC4","NAK","SYN","ETB","CAN","SUB","ESC","DEL"].concat(["BS","HT","LF","VT","FF","CR","SO","SI","EM","FS","GS","RS","US","SP"]));ib=Ma(ja(bc,ib));var Yb=Ma(ja(Qb,Wb));Wb=$(function(q){return q!='"'&&q!="\\"&&q>"\u0016"});var jc=O("&"),zc=ea(s,rc)(O("\\"),"<?>","end of string gap"),kc=ea("code","<-",cc,"<|>",C(O("o"),Eb(8,tc)),"<|>",C(O("x"),Eb(16,sc)))(R(function(q){return toEnum(Za(q.code))})),dc=ea(O("^"))("code","<-",$b)(R(function(q){return toEnum(fromEnum(q.code)-fromEnum("A"))}));Yb=
Da(ib,"<|>",kc,"<|>",Yb,"<|>",dc,"<?>","escape code");ib=C(O("\\"),Yb);kc=$(function(q){return q!="'"&&q!="\\"&&q>"\u0016"});ib=Da(kc,"<|>",ib,"<?>","literal character");ib=Da(l,[Ia,O("'"),[O("'"),"<?>","end of character"],ib],"<?>","character");jc=ea(O("\\"))(C(zc,Z(ga.Nothing)),"<|>",C(jc,Z(ga.Nothing)),"<|>",ea("esc","<-",Yb)(la,ga.Just,"esc"));Wb=Da(ea("c","<-",Wb)(la,ga.Just,"c"),"<|>",jc,"<?>","string character");Wb=Da(l,[ea("str","<-",Ia,O('"'),[O('"'),"<?>","end of string"],[i,Wb])(R,function(q){return ab(d(Va)(M,
d(ca)),"",q.str)}),"<?>","literal string"]);var ic=Eb(10,mc);jc=ea(Rb,"xX")(Eb,16,sc);zc=ea(Rb,"oO")(Eb,8,tc);var Qc=Da(ea(O("."))("digits","<-",s,mc,"<?>","fraction")(R,function(q){return ab(lc,0,q.digits)}),"<?>","fraction");Yb=Da([O("-"),">>",Z,ba],"<|>",[O("+"),">>",Z,M],"<|>",Z,M);var Oc=Da(ea(Rb,"eE")("f","<-",Yb)("e","<-",ic,"<?>","exponent")(la,xc,"f","e"),"<?>","exponent");kc=ea("n","<-",ic)(function(q,wa,Sa){return wc(q.n)(q,wa,Sa)});dc=ea("n","<-",ic)(function(q,wa,Sa){return lb(ya.Left(q.n),
uc(q.n))(q,wa,Sa)});var ec=Da(ea("n","<-",jc,"<|>",zc)(la,ya.Left,"n"),"<|>",dc,"<|>",uc(0),"<|>",Z,ya.Left(0));dc=Da(C(O("0"),ec),"<|>",dc);ec=Da(ea(O,"0")(jc,"<|>",zc,"<|>",ic,"<|>",Z,0),"<?>","");ec=X(ec,ic);var Ac=ea("f","<-",l,Yb)("n","<-",ec)(R,function(q){return q.f(q.n)});Yb=I(l,dc,"<?>","number");kc=I(l,kc,"<?>","float");dc=I(l,Ac,"<?>","integer");ec=I(l,ec,"<?>","natural");Ac=Da(ea("c","<-",e.opStart)("cs","<-",i,e.opLetter)(la,gb,"c","cs"),"<?>","operator");Ac=Da(l,"$",F,ea("name","<-",
Ac)(function(q,wa,Sa){return(nc(q.name)?pa("reserved operator "+q.name):Z(q.name))(q,wa,Sa)}));var Kc=Da(ea("c","<-",e.identStart)("cs","<-",i,e.identLetter)(la,gb,"c","cs"),"<?>","identifier");Kc=Da(l,"$",F,ea("name","<-",Kc)(function(q,wa,Sa){return(Fc(q.name)?pa("reserved word "+q.name):Z(q.name))(q,wa,Sa)}));var Pc=Ua(e.reservedNames),Rc=e.caseSensitive?Pc:ja(function(q){return q.toLowerCase()},Pc);return Ta.TokenParser(o,{identifier:Kc,reserved:Vb,operator:Ac,reservedOp:vc,charLiteral:ib,stringLiteral:Wb,
natural:ec,integer:dc,float_:kc,naturalOrFloat:Yb,decimal:ic,hexadecimal:jc,octal:zc,symbol:h,lexeme:l,whiteSpace:Lc,parens:z,braces:b,angles:f,brackets:k,squares:k,semi:Ic,comma:Hc,colon:Ec,dot:oc,semiSep:N,semiSep1:cb,commaSep:w,commaSep1:Ja})}var J=NS.Haskell.Bool,Cb=NS.Haskell.isArray,qa=NS.Haskell.slice,Ua=NS.Haskell.isort,A=NS.Haskell.extend,Na=NS.Haskell.namespace,ba=NS.Haskell.negate,P=NS.Haskell.evalThunks,d=NS.Haskell.curry,g=NS.Haskell.error,m=NS.Haskell.data,o=NS.Haskell.record,v=NS.Haskell.instance,
D=NS.Haskell.getInstance;g=NS.Haskell.asTypeOf;var K=NS.Haskell.operators,fa=NS.Haskell.infix,L=NS.Haskell.infixl,na=NS.Haskell.infixr,W=NS.Haskell.resolve,Ca=NS.Haskell.exl,I=NS.Haskell.exs,xa=NS.Haskell.Scope,ca=NS.Prelude.cons,gb=NS.Prelude.consJoin,n=NS.Prelude.elemIndex,za=NS.Prelude.unsafeCompare,Pa=NS.Prelude.toInteger,Za=NS.Prelude.fromInteger,sa=NS.Prelude.fromIntegral;J=NS.Prelude.Bool;var ga=NS.Prelude.Maybe,Va=NS.Prelude.maybe,ya=NS.Prelude.Either;g=NS.Prelude.String;d=NS.Prelude.curry;
var da=NS.Prelude.Monad,M=NS.Prelude.id;J=NS.Prelude.const_;var U=NS.Prelude.compose,Wa=NS.Prelude.flip,$a=NS.Prelude.call;g=NS.Prelude.asTypeOf;g=NS.Prelude.error;var ja=NS.Prelude.map;n=NS.Prelude.append;n=NS.Prelude.filter;n=NS.Prelude.head;n=NS.Prelude.last;n=NS.Prelude.tail;n=NS.Prelude.init;var Aa=NS.Prelude.null_;n=NS.Prelude.length;n=NS.Prelude.index;n=NS.Prelude.reverse;var p=NS.Prelude.foldl;n=NS.Prelude.foldl1;var ab=NS.Prelude.foldr;n=NS.Prelude.foldr1;n=NS.Prelude.and;n=NS.Prelude.or;
n=NS.Prelude.any;n=NS.Prelude.all;n=NS.Prelude.sum;n=NS.Prelude.product;n=NS.Prelude.concat;n=NS.Prelude.concatMap;n=NS.Prelude.maximum;n=NS.Prelude.minimum;n=NS.Prelude.scanl;n=NS.Prelude.scanl1;n=NS.Prelude.scanr;n=NS.Prelude.scanr1;var Fa=NS.Prelude.replicate;n=NS.Prelude.take;n=NS.Prelude.drop;n=NS.Prelude.splitAt;n=NS.Prelude.takeWhile;n=NS.Prelude.dropWhile;n=NS.Prelude.span;n=NS.Prelude.break_;var bb=NS.Prelude.elem;n=NS.Prelude.notElem;n=NS.Prelude.lookup;var Db=NS.Prelude.zip;n=NS.Prelude.zip3;
n=NS.Prelude.zipWith;n=NS.Prelude.zipWith3;n=NS.Prelude.unzip;n=NS.Prelude.unzip3;n=NS.Prelude.lines;n=NS.Prelude.words;n=NS.Prelude.unlines;n=NS.Prelude.unwords;g=NS.Data_Char.String;var Xa=NS.Data_Char.isSpace,oa=NS.Data_Char.isUpper,Ga=NS.Data_Char.isLower,Qa=NS.Data_Char.isAlpha,Pb=NS.Data_Char.isAlphaNum,Tb=NS.Data_Char.isDigit,fc=NS.Data_Char.isHexDigit,Xb=NS.Data_Char.isOctDigit,va=NS.Data_Char.digitToInt;n=NS.Data_List.append;n=NS.Data_List.head;n=NS.Data_List.last;n=NS.Data_List.tail;n=NS.Data_List.init;
Aa=NS.Data_List.null_;n=NS.Data_List.length;ja=NS.Data_List.map;n=NS.Data_List.reverse;p=NS.Data_List.foldl;n=NS.Data_List.foldl1;ab=NS.Data_List.foldr;n=NS.Data_List.foldr1;n=NS.Data_List.concat;n=NS.Data_List.concatMap;n=NS.Data_List.and;n=NS.Data_List.or;n=NS.Data_List.any;n=NS.Data_List.all;n=NS.Data_List.sum;n=NS.Data_List.product;n=NS.Data_List.maximum;n=NS.Data_List.minimum;n=NS.Data_List.scanl;n=NS.Data_List.scanl1;n=NS.Data_List.scanr;n=NS.Data_List.scanr1;Fa=NS.Data_List.replicate;n=NS.Data_List.take;
n=NS.Data_List.drop;n=NS.Data_List.splitAt;n=NS.Data_List.takeWhile;n=NS.Data_List.dropWhile;n=NS.Data_List.span;n=NS.Data_List.break_;bb=NS.Data_List.elem;n=NS.Data_List.notElem;n=NS.Data_List.lookup;n=NS.Data_List.filter;n=NS.Data_List.index;n=NS.Data_List.elemIndex;Db=NS.Data_List.zip;n=NS.Data_List.zip3;n=NS.Data_List.zipWith;n=NS.Data_List.zipWith3;n=NS.Data_List.unzip;n=NS.Data_List.unzip3;n=NS.Data_List.lines;n=NS.Data_List.words;n=NS.Data_List.unlines;n=NS.Data_List.unwords;var a=NS.Data_List.nub,
c;B.prototype={memoize:false,scrollTo:function(e){this.index=e;this.length=this.input.length-e;return this},scroll:function(e){this.index+=e;this.length-=e;return this},dropped:0,at:function(e){return this.input.charAt(this.index+e)},substring:function(e,h){return this.input.substring(e+this.index,(h||this.length)+this.index)},substr:function(e,h){return this.input.substring(e+this.index,h||this.length)},toString:function(){var e=this.substring(0);return"PS at "+this.index+" "+(e.length?'"'+e+'"':
"Empty")},getCached:function(e){if(this.memoize)if(e=this.cache[e])if(e=e[this.index]){this.index=e.index;this.length=e.length;return e}},putCached:function(e,h,l){if(!this.memoize)return false;l.index=this.index;l.length=this.length;var y=this.cache[e];y||(y=this.cache[e]={});y[h]=l},sourceLine:function(e){return(e=this.input.substring(0,e).match(/(\r\n)|\r|\n/g))?e.length:0}};var j=db,u=S;n=u;var Y=0,V=function(e,h){function l(y,G,H){return function(){return e(y,G,function(z){return z.success?h(y,
G,H):H(z)})}}l.constructor=Q;return l},C=function(){function e(l,y,G){l=new xa(l);for(var H=1,z=h.length,b=h[0];H<z;++H)b=V(b,h[H]);return b(l,y,G)}var h=ja(ma,arguments);e.constructor=Q;return e},la=U(R,eb),Ra=wb,Zb=fb,Z=Ea,ac=Z;U=pb;var hc=V,gc=X,i=zb(false),s=zb(true),F=rb(function(e,h,l,y){if(h.success)return h;l.scrollTo(y);return{ast:c,success:false,expecting:h.expecting}}),E=function(e){return rb(function(h,l){return{ast:c,success:l.success,expecting:l.expecting}})(i(e),null)},O=Ha(function(e,
h){if(h.length>0&&h.at(0)==e){h.scroll(1);return{ast:e,success:true}}return{success:false,expecting:e}}),$=Ha(function(e,h){var l=h.at(0);if(h.length>0&&e(l)){h.scroll(1);return{ast:l,success:true}}return{success:false,expecting:l}}),Ka=function(e){return rb(function(h,l,y,G){h=l.ast.join("");return{ast:h.length?h:c,success:l.success,expecting:l.success?c:{at:G,expecting:e}}})(Hb(ja(O,e)),null)},Ub=rb(function(e,h,l,y){return h.success?h:{ast:h.ast,success:false,expecting:{at:y,expecting:e}}}),pc=
Ha(function(e,h){if(typeof e=="string")if(h.substring(0,e.length)==e){h.scroll(e.length);return{ast:e,success:true}}else return{success:false,expecting:e};else if(e.exec){var l=new RegExp("^"+e.source),y=h.substring(0);l=(l=(l=l.exec(y))&&l[0])&&l.length;y=y.substr(0,l);if(l){h.scroll(l);return{ast:y,success:true}}else return{success:false,expecting:e.source}}});A(K,{"<-":{func:t,fixity:na(-1)},">>=":{func:ta,fixity:L(1)},"=<<":{func:Wa(ta),fixity:na(1)},">>":{func:hc,fixity:L(1)},"*>":{func:hc,fixity:L(4)},
"<*":{func:Gb,fixity:L(4)},"<$>":{func:U,fixity:L(4)},"<*>":{func:xb,fixity:L(4)},"<**>":{func:d(Fb)(Wa($a)),fixity:L(4)},"<$":{func:function(e,h){return Gb(ac(value),h)},fixity:L(4)},"<|>":{func:X,fixity:na(1)},"<?>":{func:Ub,fixity:fa(0)}});v(da,Q,function(){return{">>=":ta,">>":V,do_:C,return_:Ea,fail:db,run:La,do$:function(){function e(H,z,b){return y(H,z,b)}function h(H,z,b){if(G||H instanceof xa)return(G?y:h.resolve())(H,z,b);l.push(W(arguments,e));return h}var l=[],y,G;l.push(W(arguments,e));
h.resolve=function(){if(G)return y;y=C.apply(null,l);G=true;l=null;return y};h.CallStream=true;h.constructor=Q;return h}}});var ea=D(da,Q).do$,Da=Ca(Q);Na("Text_Parsec_Prim",{sequence:Nb,run:La,Parser:Q,ParseState:B,ps:jb,toParser:ma,unexpected:pa,parsecMap:U,fmap:U,liftM:pb,liftM2:Fb,liftM3:Ba,liftA:U,liftA2:Fb,liftA3:Ba,ap:xb,parserBind:ta,parserReturn:Ea,return_:Z,pure:ac,parserFail:db,fail:j,parserZero:S,mzero:u,empty:n,parserPlus:X,parserPlusN:yb,mplus:gc,do_:C,do$:ea,do2:V,bind:t,ret:R,withBound:eb,
returnCall:la,getPosition:wb,setPosition:fb,getParserState:Ra,setParserState:Zb,tokens:Hb,many:i,many1:s,string:Ka,char_:O,satisfy:$,label:Ub,try_:F,skipMany:E,match:pc,withScope:Mb,ex:Da});Na("Text_Parsec_Combinator",{choice:Ma,count:Kb,between:Ia,option:lb,optionMaybe:ka,optional:mb,skipMany1:sb,sepBy:aa,sepBy1:ua,endBy:Jb,endBy1:Ib,sepEndBy:tb,sepEndBy1:ra,chainl:T,chainl1:Ab,chainr:kb,chainr1:Bb,eof:Lb,notFollowedBy:Ya,manyTill:vb,lookAhead:Ob,anyToken:ub});m(Oa,["AssocNone","AssocLeft","AssocRight"]);
m(hb,[["Infix",Q,Oa],["Prefix",Q],["Postfix",Q]]);Na("Text_Parsec_Expr",{Assoc:Oa,Operator:hb,buildExpressionParser:ob});var Rb=function(e){return Ub($(function(h){return bb(h,e)}),"oneOf("+e+")")},qc=function(e){return Ub($(function(h){return!bb(h,e)}),"noneOf("+e+")")},rc=I($,Xa,"<?>","space");A=I(E,rc,"<?>","white space");v=I(O,"\n","<?>","new-line");D=I(O,"\t","<?>","tab");var $b=I($,oa,"<?>","uppercase letter");fa=I($,Ga,"<?>","lowercase letter");Pb=I($,Pb,"<?>","letter or digit");K=I($,Qa,"<?>",
"letter");var mc=I($,Tb,"<?>","digit"),sc=I($,fc,"<?>","hexadecimal digit"),tc=I($,Xb,"<?>","octal digit");J=I($,J(true));Na("Text_Parsec_Char",{oneOf:Rb,noneOf:qc,space:rc,spaces:A,newline:v,tab:D,upper:$b,lower:fa,alphaNum:Pb,letter:K,digit:mc,hexDigit:sc,octDigit:tc,anyChar:J});m(ha,[["LanguageDef",{commentStart:g,commentEnd:g,commentLine:g,nestedComments:Boolean,identStart:Q,identLetter:Q,opStart:Q,opLetter:Q,reservedNames:Array,reservedOpNames:Array,caseSensitive:Boolean}]]);m(Ta,[["TokenParser",
{identifier:Q,reserved:Function,operator:Q,reservedOp:Function,charLiteral:Q,stringLiteral:Q,natural:Q,integer:Q,float_:Q,naturalOrFloat:Q,decimal:Q,hexadecimal:Q,octal:Q,symbol:Function,lexeme:Function,whiteSpace:Q,parens:Function,braces:Function,angles:Function,brackets:Function,squares:Function,semi:Q,comma:Q,colon:Q,dot:Q,semiSep:Function,semiSep1:Function,commaSep:Function,commaSep1:Function}]]);Na("Text_Parsec_Token",{GenLanguageDef:ha,GenTokenParser:Ta,makeTokenParser:qb});g=Rb(":!#$%&*+./<=>?@\\^|-~");
m=ha.LanguageDef(o,{commentStart:"",commentEnd:"",commentLine:"",nestedComments:true,identStart:I(K,"<|>",O("_")),identLetter:I(Pb,"<|>",Rb("_'")),opStart:g,opLetter:g,reservedOpNames:[],reservedNames:[],caseSensitive:true});J=ha.LanguageDef(o,{commentStart:"{-",commentEnd:"-}",commentLine:"--",nestedComments:true,identStart:K,identLetter:I(Pb,"<|>",Rb,"_'"),opStart:g,opLetter:g,reservedOpNames:[],reservedNames:[],caseSensitive:true});g=ha.LanguageDef(o,{commentStart:"/*",commentEnd:"*/",commentLine:"//",
nestedComments:true,identStart:K,identLetter:I(Pb,"<|>",Rb,"_'"),opStart:g,opLetter:g,reservedOpNames:[],reservedNames:[],caseSensitive:false});Tb=J.update({reservedOpNames:["::","..","=","\\","|","<-","->","@","~","=>"],reservedNames:["let","in","case","of","if","then","else","data","type","class","default","deriving","do","import","infix","infixl","infixr","instance","module","newtype","where","primitive"]});var Bc=Tb.update({identLetter:I(Tb.identLetter,"<|>",O("#")),reservedNames:Tb.reservedNames.concat(["foreign",
"import","export","primitive","_ccall_","_casm_","forall"])}),Cc=g.update({reservedNames:["case","class","default","extends","import","in","let","new","of","package"],caseSensitive:true});Na("Text_Parsec_Language",{emptyDef:m,haskellStyle:J,javaStyle:g,haskellDef:Bc,mondrianDef:Cc,getHaskell:function(){return qb(Bc)},getMondrian:function(){return qb(Cc)}})})();(function(){namespace("Text_Parsec");importSubmodules("Text_Parsec",["Prim","Char","Combinator","Token","Language","Expr"])})();(function(){function B(){}
function jb(){}function pa(){}function db(i){if(!(i instanceof pa))throw"Type error: expecting type of 'Id' instead of "+i.constructor;return i.Id?i[1]:null}function S(){}function ma(){}function La(){}function ia(){}function Q(){}function ta(){}function t(){}function R(){}function eb(){}function wb(){}function fb(){}function Ea(){}function xb(i,s){for(var F=!!s.charAt,E=0,O=s.length;E<O;++E)if(!i(F?s.charAt(E):s[E]))break;return Wa(s,E)}function pb(i,s,F){return function(E,O,$){return(O.sourceLine(E[i])==
O.sourceLine(E[s])?qa(ha(T.Just,F),J(T.Nothing)):J(T.Nothing))(E,O,$)}}function Fb(i,s,F){return function(E,O,$){return(O.sourceLine(E[i])==O.sourceLine(E[s])?F:hb("end of line"))(E,O,$)}}function Ba(i,s,F){var E=s.input.substring(0,s.index-s.dropped).match(/\s*$/);E=E&&/\n|\r/.test(E[0]);var O;if(!E){var $=s.at(0);if($==""||$=="}")E=true;else if($==";")O=E=true}return(E?O?p.semi:J(null):Cb("end of statement"))(i,s,F)}function Gb(i){return i==" "||i=="\t"}function X(i){return function(s,F,E){return yb(i)(s,
F,E)}}function yb(i){return L([v(i),">>",J,""],"<|>",[A(K,[o,"\\'"])("cs","<-",X(i))(ba,function(s){return"'"+s.cs})],"<|>",[A(v("\\"))("c","<-",la,"<|>",Ra,"<|>",Zb,"<|>",v("\r"),"<|>",v("\n"))("cs","<-",X(i))(ba,function(s){return s.c=="\r"||s.c=="\n"?tb(s.c,xb(Gb,s.cs)):tb(s.c,s.cs)})],"<|>",[Ta,tb,gb,X(i)])}function Hb(i,s,F){return s>=1?Hb(i,s/10,F):(i+s)*Math.pow(10,F)}function zb(i){return L(i,">>=",[J,".",T.Just])}function Ha(i,s){return Ua(Na("pos",d),Na("e",s),ba(function(F){return i(F.pos,
F.e)}))}function rb(i){function s(F,E){return t.DotRef(F,i,E)}return L([p.reservedOp("."),">>",Ha,s,Ga],"<?>","property.ref")}function Mb(i){function s(F,E){return t.CallExpr(F,i,E)}return L([p.parens,"$",Ha,s,[Xa,ja(Pa),p.comma]],"<?>","(function application)")}function Nb(i){function s(F,E){return t.BracketRef(F,i,E)}return L([p.brackets,"$",Ha,s,Xa],"<?>","[property-ref]")}function Ma(i){if(i.Just){i=i[0];return L(A("e_","<-",rb(i),"<|>",Nb(i))(function(s,F,E){return Ma(T.Just(s.e_))(s,F,E)}),
"<|>",J(i))}if(i.Nothing)return A("e","<-",Db,"<?>","expression (3)")(function(s,F,E){return Ma(T.Just(s.e))(s,F,E)})}function lb(i){if(i.Just){i=i[0];return L(A("e_","<-",rb(i),"<|>",Mb(i),"<|>",Nb(i))(function(s,F,E){return lb(T.Just(s.e_))(s,F,E)}),"<|>",J(i))}if(i.Nothing)return A("e","<-",Db,"<?>","expression (3)")(function(s,F,E){return lb(T.Just(s.e))(s,F,E)})}function ka(i,s){i=A("pos","<-",d)(p.reservedOp(i))(ba,function(F){return function(E,O){return t.InfixExpr(F.pos,s,E,O)}});return M.Infix(i,
da.AssocLeft)}function mb(i,s){if(s.VarRef)if(s[1].Id)return J(ta.LVar(s[0],s[1][1]));if(s.DotRef)if(s[2].Id)return J(ta.LDot(s[0],s[1],s[2][1]));if(s.BracketRef)return J(ta.LBracket(s[0],s[1],s[2]));return Cb("expeceted l-value at "+i)}function Ia(i,s){return function(F){return t.UnaryAssignExpr(i,La[s],F)}}function sb(i,s){return function(F,E,O){var $=E.substring(0,2);if($=="--"||$=="++"){$=E.input.substring(0,E.index-E.dropped).match(/\s*$/);return($&&/\n|\r/.test($[0])?s:i)(F,E,O)}else return s(F,
E,O)}}var aa=NS.Haskell_DataType.data,ua=NS.Haskell_DataType.ADT;ua=NS.Haskell_DataType.record;var ra=NS.Haskell_DataType.accessor;ra=NS.Haskell_DataType.accessors;var tb=NS.Prelude.cons,Ib=NS.Prelude.readHex,Jb=NS.Prelude.readOct,Kb=NS.Prelude.round,kb=NS.Prelude.Bool,T=NS.Prelude.Maybe,Ab=NS.Prelude.maybe;ra=NS.Prelude.String;var Bb=NS.Prelude.fst;aa=NS.Prelude.curry;var ub=NS.Prelude.uncurry,Lb=NS.Prelude.id;ra=NS.Prelude.asTypeOf;aa=NS.Prelude.error;var Ya=NS.Prelude.map;xb=NS.Prelude.dropWhile;
var vb=NS.Prelude.elem,Ob=NS.Prelude.lookup,Oa=NS.Text_Parsec.sequence,hb=NS.Text_Parsec.unexpected,ob=NS.Text_Parsec.fmap,ha=NS.Text_Parsec.liftM,Ta=NS.Text_Parsec.liftM2,qb=NS.Text_Parsec.parserBind,J=NS.Text_Parsec.return_,Cb=NS.Text_Parsec.fail,qa=NS.Text_Parsec.parserPlus,Ua=NS.Text_Parsec.do_,A=NS.Text_Parsec.do$,Na=NS.Text_Parsec.bind,ba=NS.Text_Parsec.ret,P=NS.Text_Parsec.returnCall,d=NS.Text_Parsec.getPosition,g=NS.Text_Parsec.many,m=NS.Text_Parsec.many1,o=NS.Text_Parsec.string,v=NS.Text_Parsec.char_,
D=NS.Text_Parsec.label,K=NS.Text_Parsec.try_,fa=NS.Text_Parsec.withScope,L=NS.Text_Parsec.ex,na=NS.Text_Parsec.oneOf,W=NS.Text_Parsec.noneOf,Ca=NS.Text_Parsec.spaces,I=NS.Text_Parsec.alphaNum,xa=NS.Text_Parsec.letter,ca=NS.Text_Parsec.hexDigit,gb=NS.Text_Parsec.anyChar,n=NS.Text_Parsec.option,za=NS.Text_Parsec.optionMaybe,Pa=NS.Text_Parsec.sepBy,Za=NS.Text_Parsec.sepBy1,sa=NS.Text_Parsec.sepEndBy,ga=NS.Text_Parsec.notFollowedBy,Va=NS.Text_Parsec.GenLanguageDef,ya=NS.Text_Parsec.makeTokenParser,da=
NS.Text_Parsec.Assoc,M=NS.Text_Parsec.Operator,U=NS.Text_Parsec.buildExpressionParser;kb=NS.Haskell.Bool;var Wa=NS.Haskell.slice;kb=NS.Haskell.namespace;var $a=NS.Haskell.negate;aa=NS.Haskell.curry;aa=NS.Haskell.error;aa=NS.Haskell.data;ua=NS.Haskell.ADT;ua=NS.Haskell.record;ra=NS.Haskell.accessor;ra=NS.Haskell.accessors;ra=NS.Haskell.asTypeOf;var ja=NS.Haskell.op;ra=NS.Data_Char.String;var Aa=NS.Data_Char.chr;aa(jb,[["Script","a",Array]]);aa(pa,[["Id","a",ra]]);aa(S,["OpLT","OpLEq","OpGT","OpGEq",
"OpIn","OpInstanceof","OpEq","OpNEq","OpStrictEq","OpStrictNEq","OpLAnd","OpLOr","OpMul","OpDiv","OpMod","OpSub","OpLShift","OpSpRShift","OpZfRShift","OpBAnd","OpBXor","OpBOr","OpAdd"]);aa(ma,["OpAssign","OpAssignAdd","OpAssignSub","OpAssignMul","OpAssignDiv","OpAssignMod","OpAssignLShift","OpAssignSpRShift","OpAssignZfRShift","OpAssignBAnd","OpAssignBXor","OpAssignBOr"]);aa(La,["PrefixInc","PrefixDec","PostfixInc","PostfixDec"]);aa(ia,["PrefixLNot","PrefixBNot","PrefixPlus","PrefixMinus","PrefixTypeof",
"PrefixVoid","PrefixDelete"]);aa(Q,[["PropId","a",pa],["PropString","a",ra],["PropNum","a",Number]]);aa(ta,[["LVar","a",ra],["LDot","a",t,ra],["LBracket","a",t,t]]);aa(t,[["StringLit","a",ra],["RegexpLit","a",ra,Boolean,Boolean],["NumLit","a",Number],["IntLit","a",Number],["BoolLit","a",Boolean],["NullLit","a"],["ArrayLit","a",Array],["ObjectLit","a",Array],["ThisRef","a"],["VarRef","a",pa],["DotRef","a",t,pa],["BracketRef","a",t,t],["NewExpr","a",t,Array],["PrefixExpr","a",ia,t],["UnaryAssignExpr",
"a",La,ta],["InfixExpr","a",S,t,t],["CondExpr","a",t,t,t],["AssignExpr","a",ma,ta,t],["ParenExpr","a",t],["ListExpr","a",Array],["CallExpr","a",t,Array],["FuncExpr","a",T,Array,B]]);aa(R,[["CaseClause","a",t,Array],["CaseDefault","a",Array]]);aa(eb,[["CatchClause","a",pa,B]]);aa(wb,[["VarDecl","a",pa,T]]);aa(fb,["NoInit",["VarInit",Array],["ExprInit",t]]);aa(Ea,[["ForInVar",pa],["ForInNoVar",pa]]);aa(B,[["BlockStmt","a",Array],["EmptyStmt","a"],["ExprStmt","a",t],["IfStmt","a",t,B,B],["IfSingleStmt",
"a",t,B],["SwitchStmt","a",t,Array],["WhileStmt","a",t,B],["DoWhileStmt","a",B,t],["BreakStmt","a",T],["ContinueStmt","a",T],["LabelledStmt","a",pa,B],["ForInStmt","a",Ea,t,B],["ForStmt","a",fb,T,T,B],["TryStmt","a",B,Array,T],["ThrowStmt","a",t],["ReturnStmt","a",T],["WithStmt","a",t,B],["VarDeclStmt","a",Array],["FunctionStmt","a",pa,Array,B]]);kb("BrownPLT_JavaScript_Syntax",{Expression:t,CaseClause:R,Statement:B,InfixOp:S,CatchClause:eb,VarDecl:wb,JavaScript:jb,AssignOp:ma,Id:pa,PrefixOp:ia,Prop:Q,
ForInit:fb,ForInInit:Ea,unId:db,UnaryAssignOp:La,LValue:ta});xa=qa(xa,na("$_"));I=Va.LanguageDef(ua,{commentStart:"/*",commentEnd:"*/",commentLine:"//",nestedComments:false,identStart:xa,identLetter:qa(I,na("$_")),opStart:na("{}<>()~.,?:|&^=!+-*/%!"),opLetter:na("=<>|&+"),reservedOpNames:["|=","^=","&=","<<=",">>=",">>>=","+=","-=","*=","/=","%=","=",";",",","?",":","||","&&","|","^","&","===","==","=","!==","!=","<<","<=","<",">>>",">>",">=",">","++","--","+","-","*","/","%","!","~",".","[","]",
"{","}","(",")","instanceof","in"],reservedNames:["break","case","catch","const","continue","debugger","default","delete","do","else","enum","false","finally","for","function","if","instanceof","in","let","new","null","return","switch","this","throw","true","try","typeof","var","void","while","with"],caseSensitive:true});var p=ya(I);kb("BrownPLT_JavaScript_Lexer",{lex:p});var ab=fa(function(){return ab}),Fa=fa(function(){return Fa}),bb=fa(function(){return bb}),Db=fa(function(){return Db}),Xa=fa(function(){return Xa}),
oa=Xa,Ga=Ta(pa.Id,d,p.identifier);I=A("pos","<-",d)(p.reserved,"if")("test","<-",bb,"<?>","parenthesized test-expression in if statement")("consequent","<-",Fa,"<?>","true-branch of if statement")(A(p.reserved,"else")("alternate","<-",Fa)(ba,function(i){return B.IfStmt(i.scope.pos,i.scope.test,i.scope.consequent,i.alternate)}),"<|>",P(B.IfSingleStmt,"pos","test","consequent"));ya=A("pos","<-",d)(p.reserved,"default")(p.colon)("statements","<-",g,Fa)(P,R.CaseDefault,"pos","statements");Va=A("pos",
"<-",d)(p.reserved,"case")("condition","<-",ab)(p.colon)("actions","<-",g,Fa)(P,R.CaseClause,"pos","condition","actions");Va=A("pos","<-",d)(p.reserved,"switch")("test","<-",bb)("clauses","<-",p.braces,"$",g,"$",ya,"<|>",Va)(P,B.SwitchStmt,"pos","test","clauses");aa=A("pos","<-",d)(p.reserved,"while")("test","<-",bb,"<?>","parenthesized test-expression in while loop")("body","<-",Fa)(P,B.WhileStmt,"pos","test","body");ya=A("pos","<-",d)("statements","<-",p.braces,[g,Fa])(P,B.BlockStmt,"pos","statements");
ua=A("pos","<-",d)(p.reserved,"do")("body","<-",ya)(p.reserved,"while","<?>","while at the end of a do block")("test","<-",bb,"<?>","parenthesized test-expression in do loop")(Ba)(P,B.DoWhileStmt,"pos","body","test");ra=A("pos","<-",d)(p.reserved,"continue")("pos_","<-",d)("id","<-",pb,"pos","pos_",Ga)(Ba)(P,B.ContinueStmt,"pos","id");var Qa=A("pos","<-",d)(p.reserved,"break")("pos_","<-",d)("id","<-",pb,"pos","pos_",Ga)(Ba)(P,B.BreakStmt,"pos","id"),Pb=A("pos","<-",d)(p.semi)(P,B.EmptyStmt,"pos"),
Tb=A("pos","<-",d)("label","<-",K,A("label","<-",Ga)(p.colon)(ba,"label"))("statement","<-",Fa)(P,B.LabelledStmt,"pos","label","statement"),fc=A("pos","<-",d)("expr","<-",ab)(Ba)(P,B.ExprStmt,"pos","expr"),Xb=L([p.reserved,"var",">>",ha,Ea.ForInVar,Ga],"<|>",[ha,Ea.ForInNoVar,Ga]);Xb=A("pos","<-",d)("init_expr","<-",K,A(p.reserved,"for")(p.parens,A("init","<-",Xb)(p.reserved,"in")("expr","<-",Xa)(ba,function(i){return[i.init,i.expr]})))("body","<-",Fa)(ba,function(i){return B.ForInStmt(i.pos,i.init_expr[0],
i.init_expr[1],i.body)});var va=A("pos","<-",d)("id","<-",Ga)("init","<-",[p.reservedOp("="),">>",ha,T.Just,Xa],"<|>",J(T.Nothing))(P,wb.VarDecl,"pos","id","init"),a=A("pos","<-",d)(p.reserved,"var")("decls","<-",va,ja(Pa),p.comma)(Ba)(P,B.VarDeclStmt,"pos","decls");va=L([p.reserved,"var",">>",ha,fb.VarInit,[va,ja(Pa),p.comma]],"<|>",[ha,fb.ExprInit,ab],"<|>",J(fb.NoInit));va=A("pos","<-",d)(p.reserved,"for")(p.reservedOp("("))("init","<-",va)(p.semi)("test","<-",[ha,T.Just,Xa],"<|>",J(T.Nothing))(p.semi)("iter",
"<-",[ha,T.Just,ab],"<|>",J(T.Nothing))(p.reservedOp(")"),"<?>","closing paren")("stmt","<-",Fa)(P,B.ForStmt,"pos","init","test","iter","stmt");var c=A("pos","<-",d)(p.reserved,"catch")("id","<-",p.parens,Ga)("stmt","<-",Fa)(P,eb.CatchClause,"pos","id","stmt");c=A(p.reserved,"try")("pos","<-",d)("guarded","<-",Fa)("catches","<-",g,c)("finally","<-",[p.reserved,"finally",">>",ha,T.Just,Fa],"<|>",J(T.Nothing))(P,B.TryStmt,"pos","guarded","catches","finally");var j=A("pos","<-",d)(p.reserved,"throw")("pos_",
"<-",d)("expr","<-",Fb,"pos","pos_",Xa)(Ba)(P,B.ThrowStmt,"pos","expr"),u=A("pos","<-",d)(p.reserved,"return")("pos_","<-",d)("expr","<-",pb,"pos","pos_",ab)(Ba)(P,B.ReturnStmt,"pos","expr"),Y=A("pos","<-",d)(p.reserved,"with")("context","<-",bb)("stmt","<-",Fa)(P,B.WithStmt,"pos","context","stmt"),V=A("pos","<-",d)("name","<-",K,[p.reserved,"function",">>",Ga])("args","<-",p.parens,[Ga,ja(Pa),p.comma])("body","<-",ya,"<?>","function body in { ... }")(P,B.FunctionStmt,"pos","name","args","body");
Fa=L(I,"<|>",Va,"<|>",aa,"<|>",ua,"<|>",ra,"<|>",Qa,"<|>",ya,"<|>",Pb,"<|>",Xb,"<|>",va,"<|>",c,"<|>",j,"<|>",u,"<|>",Y,"<|>",a,"<|>",V,"<|>",Tb,"<|>",fc,"<?>","statement");I=A("pos","<-",d)(p.reserved,"this")(P,t.ThisRef,"pos");Va=A("pos","<-",d)(p.reserved,"null")(P,t.NullLit,"pos");aa=A("pos","<-",d)("true","<-",J,true)("false","<-",J,false)([p.reserved,"true",">>",P(t.BoolLit,"pos","true")],"<|>",[p.reserved,"false",">>",P(t.BoolLit,"pos","false")]);ua=Ta(t.VarRef,d,Ga);ra=Ta(t.ArrayLit,d,p.squares(sa(Xa,
p.comma)));Qa=A("pos","<-",d)(p.reserved,"function")("name","<-",[Ga,">>=",J,".",T.Just],"<|>",J,T.Nothing)("args","<-",p.parens,[Ga,ja(Pa),p.comma])("body","<-",ya)(P,t.FuncExpr,"pos","name","args","body");var C=[["'","'"],['"','"'],["\\","\\"],["b","\u0008"],["f","\u000c"],["n","\n"],["r","\r"],["t","\t"],["v","\u000b"],["/","/"],[" "," "],["0","\u0000"]];Bb=Ya(Bb,C);var la=A("c","<-",na(Bb))(ba,function(i){return Ob(i.c,C)[0]}),Ra=A(v,"x")("d1","<-",ca)("d2","<-",ca)(ba,function(i){return Aa(Ib(""+
i.d1+i.d2))}),Zb=A(v,"u")(ha,[Aa,".",Ib],Oa([ca,ca,ca,ca]));Oa=A("pos","<-",d)("str","<-",p.lexeme,"$",[v("'"),">>=",yb],"<|>",[v('"'),">>=",yb])(P,t.StringLit,"pos","str");ca=A("flags","<-",g,na("mgi"))(ba,function(i){return function(s){return s(vb("g",i.flags),vb("i",i.flags))}});L(v("\\"),">>",gb).resolve();W("/");W=function(i,s,F){return Z(i,s,F)};var Z=L([v("/"),">>",J,""],"<|>",A(v("\\"))("ch","<-",gb)("rest","<-",W)(ba,function(i){return"\\"+i.ch+i.rest}),"<|>",[Ta,tb,gb,W]);Ca=A("pos","<-",
d)(v("/"))("pat","<-",Z)("flags","<-",ca)(Ca)(ba,function(i){return i.flags(function(s,F){return t.RegexpLit(i.pos,i.pat,s,F)})});ub=A("name","<-",[ha,ub(Q.PropString),[ha,function(i){return[i[0],i[1]]},Oa]],"<|>",[Ta,Q.PropId,d,Ga],"<|>",[Ta,Q.PropNum,d,p.decimal])(p.colon)("val","<-",oa)(ba,function(i){return[i.name,i.val]});sa=A("pos","<-",d)("props","<-",p.braces,[ub,ja(sa),p.comma],"<?>","object literal")(P,t.ObjectLit,"pos","props");ub=A(K,o("0x"))("digits","<-",m,na("0123456789abcdefABCDEF"))("hex",
"<-",P,Ib,"digits")(ba,function(i){return[true,i.hex]});Jb=A("digits","<-",K,"$",[v("0"),">>",[m,na("01234567"),"<|>",J("0")]],"<*",ga,na(".89"))("oct","<-",P,Jb,"digits")(ba,function(i){return[true,i.oct]});ob=A(na,"eE")([v("+"),">>",p.decimal],"<|>",[v("-"),">>",$a,ja(ob),p.decimal],"<|>",p.decimal);n=L(A("whole","<-",p.decimal)("mfrac","<-",n,T.Nothing,[zb,[v("."),">>",p.decimal]])("mexp","<-",n,T.Nothing,[zb,ob])(ba,function(i){return i.mfrac==T.Nothing&&i.mexp==T.Nothing?[true,i.whole]:[false,
Hb(i.whole,Ab(0,Lb,i.mfrac),Ab(0,Lb,i.mexp))]}),"<|>",A("frac","<-",v("."),">>",p.decimal)("exp","<-",n,0,ob)(ba,function(i){return[false,Hb(0,i.frac,i.exp)]}));n=A("pos","<-",d)("isint_num","<-",p.lexeme,"$",ub,"<|>",Jb,"<|>",n)(ga,xa,"<?>","whitespace")(ba,function(i){var s=i.isint_num[1];return i.isint_num[0]?t.IntLit(i.pos,Kb(s)):t.NumLit(i.pos,s)});bb=Ha(t.ParenExpr,p.parens(ab));L(I,"<|>",Va,"<|>",aa,"<|>",Oa,"<|>",ra,"<|>",bb,"<|>",Db,"<|>",n,"<|>",Ca,"<|>",sa,"<|>",ua);n=L(I,"<|>",Va,"<|>",
aa,"<|>",Oa,"<|>",ra,"<|>",bb,"<|>",Qa,"<|>",n,"<|>",Ca,"<|>",sa,"<|>",ua);Db=L(A("pos","<-",d)(p.reserved,"new")("constructor_","<-",Ma,T.Nothing)("arguments","<-",[K,[p.parens,[Xa,ja(Pa),p.comma]]],"<|>",J([]))(P,t.NewExpr,"pos","constructor_","arguments"),"<|>",n);var ac=A("pos","<-",d)("op","<-",za,"$",[p.reservedOp("!"),">>",J,ia.PrefixLNot],"<|>",[p.reservedOp("~"),">>",J,ia.PrefixBNot],"<|>",[K,[p.lexeme,"$",v("-"),">>",ga,v("-")],">>",J,ia.PrefixMinus],"<|>",[K,[p.lexeme,"$",v("+"),">>",ga,
v("+")],">>",J,ia.PrefixPlus],"<|>",[p.reserved,"typeof",">>",J,ia.PrefixTypeof],"<|>",[p.reserved,"void",">>",J,ia.PrefixVoid],"<|>",[p.reserved,"delete",">>",J,ia.PrefixDelete])(function(i,s,F){var E=i.op,O;if(E.Nothing)O=gc;if(E.Just)O=A("innerExpr","<-",ac)(ba,function($){return t.PrefixExpr(i.pos,E[0],$.innerExpr)});return O(i,s,F)});ga=[[ka("*",S.OpMul),ka("/",S.OpDiv),ka("%",S.OpMod)],[ka("+",S.OpAdd),ka("-",S.OpSub)],[ka("<<",S.OpLShift),ka(">>",S.OpSpRShift),ka(">>>",S.OpZfRShift)],[ka("<",
S.OpLT),ka("<=",S.OpLEq),ka(">",S.OpGT),ka(">=",S.OpGEq),ka("instanceof",S.OpInstanceof),ka("in",S.OpIn)],[ka("&",S.OpBAnd)],[ka("^",S.OpBXor)],[ka("|",S.OpBOr)],[ka("&&",S.OpLAnd)],[ka("||",S.OpLOr)],[ka("==",S.OpEq),ka("!=",S.OpNEq),ka("===",S.OpStrictEq),ka("!==",S.OpStrictNEq)]].reverse();D=D(U(ga,ac),"simple expression");var hc=A("p","<-",d)("e","<-",lb,T.Nothing)(function(i,s,F){return mb(i.p,i.e)(i,s,F)}),gc=qb(d,function(i){function s(Ka){return Ua(p.reservedOp("++"),ha(Ia(i,"PostfixInc"),
mb(i,Ka)))}function F(Ka){return Ua(p.reservedOp("--"),ha(Ia(i,"PostfixDec"),mb(i,Ka)))}var E=Ua(p.reservedOp("++"),ha(Ia(i,"PrefixInc"),hc)),O=Ua(p.reservedOp("--"),ha(Ia(i,"PrefixDec"),hc)),$=qb(lb(T.Nothing),function(Ka){return sb(qa(s(Ka),qa(F(Ka),J(Ka))),J(Ka))});return qa(E,qa(O,$))});U=A(p.reservedOp("?"))("l","<-",oa)(p.colon)("r","<-",oa)(ba,function(i){return[i.l,i.r]});za=A("e","<-",D)("e_","<-",za,U)(function(i,s,F){var E=i.e_,O=i.e,$;if(E.Nothing)$=J(i.e);if(E.Just){var Ka=E[0][0],Ub=
E[0][1];$=A("p","<-",d)(ba,function(pc){return t.CondExpr(pc.p,O,Ka,Ub)})}return $(i,s,F)});D=L([p.reservedOp("="),">>",J,ma.OpAssign],"<|>",[p.reservedOp("+="),">>",J,ma.OpAssignAdd],"<|>",[p.reservedOp("-="),">>",J,ma.OpAssignSub],"<|>",[p.reservedOp("*="),">>",J,ma.OpAssignMul],"<|>",[p.reservedOp("/="),">>",J,ma.OpAssignDiv],"<|>",[p.reservedOp("%="),">>",J,ma.OpAssignMod],"<|>",[p.reservedOp("<<="),">>",J,ma.OpAssignLShift],"<|>",[p.reservedOp(">>="),">>",J,ma.OpAssignSpRShift],"<|>",[p.reservedOp(">>>="),
">>",J,ma.OpAssignZfRShift],"<|>",[p.reservedOp("&="),">>",J,ma.OpAssignBAnd],"<|>",[p.reservedOp("^="),">>",J,ma.OpAssignBXor],"<|>",[p.reservedOp("|="),">>",J,ma.OpAssignBOr]);Xa=oa=A("p","<-",d)("lhs","<-",za)(A("op","<-",D)("lhs","<-",fa,function(i){i.p=i.scope.p;return mb(i.scope.p,i.scope.lhs)})("rhs","<-",fa,function(){return oa})(P,t.AssignExpr,"p","op","lhs","rhs"),"<|>",ba,"lhs");ab=Ta(t.ListExpr,d,Za(oa,p.comma));P=A(p.whiteSpace)(Ta,jb.Script,d,g(Fa));kb("BrownPLT_JavaScript_Parser",{parseScript:P,
parseExpression:Xa,parseSimpleExpr_:n,parseBlockStmt:ya,parseStatement:Fa,assignExpr:oa})})();(function(){namespace("BrownPLT_JavaScript");importSubmodules("BrownPLT_JavaScript",["Lexer","Syntax","Parser"])})();(function(){function B(){jb(pa,B.toString(),function(S){db(S.state.length?"failed":"ok");typeof console!="undefined"&&console.log(S.ast)})}var jb=NS.Text_Parsec_Prim.run,pa=NS.BrownPLT_JavaScript.parseScript,db=typeof console!="undefined"?console.log:typeof print!="undefined"?print:function(S){alert(S)};
B()})()})();
