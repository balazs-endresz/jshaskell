/*

 JavaScript analysis tools based on JSParsec

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.

 This is a port of the WebBits library (BrownPLT.JavaScript):
 http://hackage.haskell.org/package/WebBits-2.0
 Copyright (c) 2007-2009 Arjun Guha, Claudiu Saftoiu, and Spiridon Eliopoulos

 ------------------------------------------------------------


 JSParsec - A parser combinator library for JavaScript

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.


 The initial implementation of some combinators,
 and the memoization technique is derived from:
 http://www.bluishcoder.co.nz/2007/10/javascript-parser-combinators.html

 Most functions should behave like their counterparts in Parsec 3:
 http://www.haskell.org/haskellwiki/Parsec

 ------------------------------------------------------------


 JSHaskell - Some Haskell language features for JavaScript

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.

 ------------------------------------------------------------

*/
(function(){(function(){function y(a,b){return yb[a]=b||{}}function pb(a,b){for(var d=yb[a],h=0,m=b.length;h<m;++h){var B=yb[a+"_"+b[h]];for(var u in B)d[u]=B[u]}}function P(a){return Fa.call(a)=="[object Array]"}function Xa(a){return a!==ya}function G(a,b){return a===b}function da(a,b){return a!==b}function zb(a,b){return a<b}function za(a,b){return a<=b}function Ab(a,b){return a>b}function Ya(a,b){return a>=b}function t(a){return-a}function Ra(a){var b=a.constructor;if(b)return b;a=typeof a;return a==
"string"?String:a=="number"?Number:a=="boolean"?Boolean:a=="function"?Function:ya}function J(a){function b(){var d=ja(arguments);return d.length>=(a._length===ya?a.length:a._length)?a.apply(null,d):function(){return b.apply(null,d.concat(ja(arguments)))}}return b}function Ga(a){return function(){return a}}function M(a){var b=ja(arguments,1);return function(){return a.apply(null,b)}}function Q(){function a(b){return!b?[]:[[b.name||b._name||b,b.arguments]].concat(a(b.caller))}return a(arguments.callee.caller)}
function Aa(a){a=(a instanceof Function?a.name||a._name:null)||a||"Unspecified error";var b=new Error(a);try{b.stackTrace=Q()}catch(d){}b.message=a;throw b;}function Lb(a,b){for(var d in b)a[d]=b[d];return a}function Bb(a,b){if(b.indexOf)return b.indexOf(a);var d=b.length;if(!d)return-1;for(var h=0;h<d;h++)if(b[h]===a)return h;return-1}function Sa(a,b){if(b.lastIndexOf)return b.lastIndexOf(a);var d=b.length;if(!d)return-1;for(d=d-1;d>-1;--d)if(b[d]===a)return d;return-1}function dc(a){if(a.sort)return a.sort();
return ja(a).sort().join("")}function hb(a,b){for(var d=[],h=0,m=b.length;h<m;++h)d[h]=a(b[h]);return d}function Cb(a,b){for(var d=[],h=0,m=b.length;h<m;++h)a(b[h])&&d.push(b[h]);return d}function Mb(a,b,d){for(var h=0,m=d.length;h<m;++h)b=a(b,d[h]);return b}function Ub(a,b,d){for(var h=d.length-1;h>-1;--h)b=a(d[h],b);return b}function R(a,b){for(var d=[],h=0,m=Math.min(a.length,b.length);h<m;++h)d[h]=[a[h],b[h]];return d}function Vb(a){function b(d,h){d=ka.compare(d,h);return d.LT?-1:d.GT?1:d.EQ?
0:Aa(Vb)}if(a.sort)return a.sort(b);return ja(a).sort(b).join("")}function ec(a){function b(d,h){var m=d.constructor==Array;x=m?d[0]:d.charAt(0);xs=m?d.slice(1):d.substr(1);return!d.length?[]:C(x,h)?b(xs,h):ta(x,b(xs,ta(x,h)))}return b(a,[])}function Wb(a,b,d){if(d.Nothing)return a;if(d.Just)return b(d[0])}function Db(a,b){return a===b?ea.EQ:a<=b?ea.LT:ea.GT}function ib(a,b){return function(){return a(b.apply(null,arguments))}}function V(a,b){return function(d){var h=ja(arguments,1);h.unshift(b(d));
return a.apply(null,h)}}function Eb(a){return function(b,d){return a(d,b)}}function ta(a,b){if(typeof a=="string"&&typeof b=="string")return a+b;return[a].concat(b)}function Nb(a,b){if(typeof a=="string"&&typeof b=="string")return a+b;return a+b.join("")}function ca(a,b){for(var d=[],h=0;h<a;++h)d[h]=b;return d}function Za(a){return!a.length}function L(a,b){var d=b.constructor==Array;return a.constructor==Array?a.concat(d?b:b.split("")):a.concat(d?b.join(""):b)}function C(a,b){return(b.indexOf?b.indexOf(a):
Bb(a,b))!=-1}function jb(a){return/^\s$/.test(a)}function Ob(a){return a.toUpperCase()==a}function Fb(a){return a.toLowerCase()==a}function la(a){return/^\w$/.test(a)}function $a(a){return/^\w$/.test(a)&&/^\D$/.test(a)}function fc(a){return/^\d$/.test(a)}function z(a){return/^[0-9A-Fa-f]$/.test(a)}function gc(a){return/^[0-7]$/.test(a)}function db(a){a=parseInt(a,16);return isNaN(a)?Aa(db):a}function qb(a,b){return{indexOf:function(d){return d>=a&&d<=b?true:-1},toString:function(){return"range("+
a+", "+b+")"}}}function o(a){return a[0]}function hc(a){return a[1]}function X(a){return function(b){return a(b[0],b[1])}}function H(a,b){var d=b.length;if(!d)return kb.Nothing;for(var h=0;h<d;++h)if(b[h][0]===a)return kb.Just(b[h][1]);return kb.Nothing}function w(a){return parseInt(a.join?a.join(""):a,16)}function lb(a){return parseInt(a.join?a.join(""):a,8)}function eb(){this.keys=[];this.values=[]}function fb(a,b){var d={};d._context=[];d._name=a;d._dict=new eb;d.context=function(){this._context=
ja(arguments);delete d.context;return this};d.types=function(h){this._fnTypes=h;delete d.types;return this};d.impl=function(h){this._default=h;for(var m in d._fnTypes)(function(B,u){d[B]=u!==ya&&u.constructor!=Array?(typeof h=="function"?h():h)[B]:function(){var aa=arguments,K;if(u===ya||u===i)Aa("There's no type signature for "+d._name+"."+B+", it can be accessed only by: getInstance("+d._name+", SomeType)."+B);var Ha,ba=va(function(Ia,Ja){Ja=u[Ja];if(Ha||Ja==i)return Ha=true;Ia=Ra(Ia);if(Ja==b){K=
K||Ia;return K==Ia}else return Ia==Ja},aa);!Ha&&ba.length!=u.length-1&&Aa("Type error in "+d._name+"."+B);(ba=d._dict.get(K))||Aa("No "+d._name+" instance for "+(K.name||K._name));return ba[B].apply(null,aa)}})(m,d._fnTypes[m]);delete d.impl;return this};return d}function D(a,b,d){rb(function(u){if(!u._dict.get(b))throw"No "+(u._name||"")+" instance for "+(b.name||b._name);},a._context);var h={};h._type=b;a._dict.put(b,h);d=typeof d=="function"?d(h):d||{};var m=a._default;m=typeof m=="function"?m(h):
m;for(var B in a._fnTypes)h[B]=d[B]||m[B];return h}function ab(a,b){return a._dict.get(b)}function Ka(a,b,d){return a._dict.get(Ra(d))[b]}function bb(a){return["l",a]}function Y(a){return["r",a]}function qa(a){return["x",a]}function sb(a){if(a)if(!a._String){var b=Ba[a];if(a._Op&&!b)return"l";return b&&(b.fixity[0]||"l")}}function Ta(a){if(a)if(!a._String){var b=Ba[a];if(a._Op&&!b)return 9;return b&&(Xa(b.fixity[1])?b.fixity[1]:9)}}function La(){}function Ca(a,b,d){var h;if(a[b]._Op){delete a[b]._Op;
h=a[b]}else h=Ba[a[b]].func;h=h(a[b-1],a[b+1]);a.splice(b-1,3,h);return fa(a,d)}function ra(a){if(typeof a=="string"){a=new String(a);a._String=true;return a}else{a._Array=true;return a}}function Gb(a){a._Op=true;return a}function fa(a,b){a=rb(function(K){if(!K)return K;if(K._Array){delete K._Array;return K}return K.constructor==Array?fa(K,b):K.CallStream?K.resolve(b):K},a);if(b)a=hb(function(K){return K instanceof La?b:K},a);for(var d=[],h=[],m=0,B=a.length;m<B;++m){var u=a[m],aa=false;if(Ba[u])aa=
true;if(u&&u._String){aa=false;u=u.toString()}if(u&&u._Op)aa=true;if(!aa&&m!=B-1)d.push(u);else{m==B-1&&d.push(u);d=d.length>1?d[0].apply(null,d.slice(1)):d[0];h.push(d);m!=B-1&&h.push(u);d=[]}}a=h;h=rb(sb,a);B=rb(Ta,a);u=va(Xa,B).sort().pop();m=Bb(u,B);B=Sa(u,B);return h[m]=="l"?Ca(a,m,b):h[B]=="r"?Ca(a,B,b):h[m]=="x"?Ca(a,m,b):a[0]}function Pb(a){return function(){function b(){return m.apply(null,arguments)}function d(){return(B?m:d.resolve()).apply(null,arguments)}var h=arguments,m,B;d.resolve=
function(u){if(B)return m;m=fa(h,u||b);h=null;B=true;return m};d.CallStream=true;d.constructor=a;return d}}function tb(){return fa(ja(arguments))}function Qb(a){this.scope=a}function Ma(a){return function(){function b(){return m.apply(null,arguments)}function d(u){if(B||u instanceof Qb)return(B?m:d.resolve()).apply(null,arguments);h.push(fa(arguments,b));return d}var h=[],m,B;h.push(fa(arguments,b));d.resolve=function(){if(B)return m;m=a.do_.apply(null,h);B=true;h=null;return m};d.CallStream=true;
d.constructor=a._type;return d}}function gb(a,b){return b?b[a]:function(d){return d[a]}}function wa(){}function na(){}function Na(a){return function(){var b=[],d=this._recordset;if(d&&d.constructor!=Array){for(var h in d){var m=a?d[h].name||d[h]:this[h];if(!a&&m instanceof Function)m=m.constructor!=Function?m.constructor.name:"Function("+m.name+")";b.push(h+(a?" :: ":" = ")+m)}d=ca(this._dataConstructor.length+2," ").join("");b="{"+b.join("\n"+d+",")+"\n"+d+"}"}else{for(h=0;h in this;h++)b.push(a?
d[h].name||d[h]:this[h]);b=b.join(" ")}return"("+this._dataConstructor+(b?" ":"")+b+")"}}function Xb(a,b,d,h,m){Aa("Type error: expecting "+a.name+" instead of "+b.name+" in the argument '"+d+"' of "+h+"."+m)}function mb(a,b){function d(K,Ha){function ba(ua,Rb){var Ua=ua instanceof wa,e=new a,k,r;e.constructor=a;e._recordset=Ia&&Ha[0]||Ha;e._dataConstructor=K;e[K]=true;if(Ua)for(var n in Rb){Ua=Rb[n];Ia||Aa("Records are not defined for "+h+"."+K);n in Ja||Aa("The accessor '"+n+"' is not defined for "+
h+"."+K);r=Ja[n];if(typeof r!="string"){k=Ra(Ua);k!=r&&Xb(r,k,n,h,K)}e[n]=Ua;e[Yb[n]]=Ua}else{n=arguments;for(var F=0,S=n.length;F<S;++F){Ua=n[F];r=Ha[F];if(typeof r!="string"){k=Ra(Ua);k!=r&&Xb(r,k,F,h,K)}e[F]=Ua;if(Ia)e[Hb[F]]=Ua}}e.update=function(Z){var cb={};for(var O in Ja)cb[O]=O in Z?Z[O]:this[O];return ba($,cb)};return e}var Ia=Ha&&typeof Ha[0]=="object",Ja=Ia&&Ha[0];if(Ia){var ub=0,nb,Yb={},Hb={};for(nb in Ja){var A=nb.charAt(0);if(A=="_"||A==A.toUpperCase())throw h+"."+aa+"."+nb+": record names can't start with underscore or uppercase letters";
if(nb in{update:1})throw h+"."+aa+"."+nb+": record name is invalid";Yb[nb]=ub;Hb[ub]=nb;ub++}}return ba}var h=a.name;if(a._constructors)throw"Type constructor has been already defined: '"+h+"'";a._constructors=b;a.prototype=new na;for(var m=0,B=b.length;m<B;++m){var u=typeof b[m]!="object",aa=u?b[m]:b[m][0];if(aa in a)throw"The name of the data constructor ("+h+"."+aa+") is invalid!";a[aa]=u?d(aa)():d(aa,ja(b[m],1));if(!u)a[aa]._length=b[m].length-1}}function lc(a){a.constructor=ga["Tuple"+a.length];
return a}function Ib(){}function kb(){}function ea(){}function Va(){}var ma=function(){return this}()||window,yb=ma.NS||(ma.NS={});ma.JSParsec={};var ya,Fa={}.toString,Oa=[].slice,ic=[].map,Jb=[].filter;(function(){return this}).toString().indexOf("this");(function(){var a={9:1,d:1,b:1,0:1,a:1,c:1},b=[9,"d","b",0,"a","c"],d=0;for(var h in a)if(h!=b[d++])return false;return true})();ma.global=ma;ma.namespace=y;ma.importSubmodules=pb;ma=function(a){return a};var Pa=J(function(a,b){return a(b)}),ja=
"a"[0]?function(a,b){return Oa.call(a,b||0)}:function(a,b){if(typeof a=="string"){a=a.split("");if(!b)return a}return Oa.call(a,b||0)},rb=ic?function(a,b){return ic.call(b,a)}:function(a,b){for(var d=[],h=0,m=b.length;h<m;++h)d[h]=a(b[h],h,b);return d},va=Jb?function(a,b){return Jb.call(b,a)}:function(a,b){for(var d=[],h=0,m=b.length;h<m;++h)a(b[h],h,b)&&d.push(b[h]);return d};y("Haskell_Main",{curry:J,const_:Ga,isArray:P,isDefined:Xa,slice:ja,foldl:Mb,foldr:Ub,map:hb,imap:rb,filter:Cb,ifilter:va,
indexOf:Bb,lastIndexOf:Sa,zip:R,sort:Vb,isort:dc,nub:ec,maybe:Wb,compare:Db,compose:ib,compose1:V,call:Pa,id:ma,flip:Eb,cons:ta,consJoin:Nb,replicate:ca,negate:t,null_:Za,elem:C,isSpace:jb,isUpper:Ob,isLower:Fb,isAlpha:$a,isAlphaNum:la,isDigit:fc,isHexDigit:z,isOctDigit:gc,digitToInt:db,range:qb,extend:Lb,namespace:y,toInteger:parseInt,fromInteger:ma,fromIntegral:ma,fst:o,snd:hc,uncurry:X,lookup:H,readHex:w,readOct:lb,chr:String.fromCharCode,round:Math.round,typeOf:Ra});eb.prototype.put=function(a,
b){this.keys.push(a);this.values.push(b)};eb.prototype.get=function(a){a=Bb(a,this.keys);if(a!=-1)return this.values[a]};var i={};y("Haskell_Typeclass",{typeclass:fb,VARARG:i,instance:D,getInstance:ab,asTypeOf:Ka});var Ba={$:{func:Pa,fixity:Y(0)},".":{func:V,fixity:Y(9)},":":{func:ta,fixity:Y(5)},"++":{func:L,fixity:Y(5)}};ma=new La;y("Haskell_Expression",{operators:Ba,infix:qa,infixl:bb,infixr:Y,op:Gb,no:ra,resolve:fa,recurse:ma,Recurse:La,exl:Pb,exs:tb});y("Haskell_Do",{createDo:Ma});var $=new wa;
na.prototype.toString=Na();na.prototype.dataConstructorToString=Na(true);na.prototype.update=M(Aa);y("Haskell_ADT",{data:mb,ADT:na,record:$,accessor:gb,accessors:{}});var ga={};rb(function(a){var b="Tuple"+a;ga[b]=function(){};ga[b]._name=b;ga["tuple"+a]=function(d){d.constructor=ga[b];return d}},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]);ga.tuple=lc;mb(Ib,["Unit"]);mb(kb,[["Just","a"],"Nothing"]);mb(ea,["LT","EQ","GT"]);mb(Va,[["Left","a"],["Right","b"]]);var ha=fb("Eq","a").types({eq:["a","a",Boolean],
ne:["a","a",Boolean]}).impl(function(a){return{eq:function(b,d){return!a.ne(b,d)},ne:function(b,d){return!a.eq(b,d)}}});D(ha,Number,{eq:G,ne:da});D(ha,String,{eq:G,ne:da});D(ha,Boolean,{eq:G,ne:da});D(ha,RegExp,{eq:function(a,b){return a.source===b.source&&a.global===b.global&&a.ignoreCase===b.ignoreCase&&a.multiline===b.multiline}});D(ha,Array,{eq:function(a,b){var d=a.length;if(d!=b.length)return false;for(var h=0;h<d;++h)if(!ha.eq(a[h],b[h]))return false;return true}});D(ha,Object,{eq:function(a,
b){var d,h={};for(d in a)h[d]=true;for(d in b)h[d]=true;for(d in h)if(!ha.eq(a[d],b[d]))return false;return true}});D(ha,ea,{eq:function(a,b){return a.EQ&&b.EQ?true:a.LT&&b.LT?true:a.GT&&b.GT?true:false}});var ka=fb("Ord","a").context(ha).types({compare:["a","a",ea],"<":["a","a",Boolean],"<=":["a","a",Boolean],">":["a","a",Boolean],">=":["a","a",Boolean],max:["a","a","a"],min:["a","a","a"]}).impl(function(a){return{compare:function(b,d){return ha.eq(b,d)?ea.EQ:a["<="](b,d)?ea.LT:ea.GT},"<":function(b,
d){return a.compare(b,d).LT?true:false},"<=":function(b,d){return a.compare(b,d).GT?false:true},">":function(b,d){return a.compare(b,d).GT?true:false},">=":function(b,d){return a.compare(b,d).LT?false:true},max:function(b,d){return a["<="](b,d)?d:b},min:function(b,d){return a["<="](b,d)?b:d}}});D(ka,Boolean,{compare:function(a,b){return a===true&&b===false?ea.LT:a===false&&b===true?ea.GT:ea.EQ}});D(ka,Number,{compare:function(a,b){return a===b?ea.EQ:a<=b?ea.LT:ea.GT},"<":zb,"<=":za,">":Ab,">=":Ya,
max:function(a,b){return a<=b?b:a},min:function(a,b){return a<=b?a:b}});D(ka,ea,{"<=":function(a,b){return a.LT?true:b.LT?false:a.EQ?true:b.EQ?false:a.GT&&b.GT?true:Aa()}});ma=fb("Functor","f").types({fmap:[Function,"f","f"],"<$":["a","f","f"]}).impl(function(a){return{"<$":function(b,d){return a.fmap(Ga(b),d)}}});Pa=fb("Monad","m").types({">>=":["m",Function,"m"],">>":["m","m","m"],return_:["a","m"],fail:[String,"m"],do_:i,do$:i,run:i}).impl(function(a){return{">>":function(b,d){b=a[">>="](b,Ga(d));
b.constructor=a._type;return b},fail:function(b){return Aa(b)},do_:function(){function b(m){for(var B=new Qb(m),u=1,aa=d.length,K=d[0];u<aa;++u)K=h(K,d[u]);u=Oa.call(arguments,1);u.unshift(B);return K.apply(null,u)}var d=arguments,h=a[">>"];b.constructor=a._type;return b},run:function(b){var d=ja(arguments,1);d.unshift(new Qb);return b.apply(null,d)},do$:Ma(a)}});var oa=fb("Show","a").types({show:["a",String]}).impl({show:function(a){return a.toString()}});D(oa,Number);D(oa,Boolean);D(oa,RegExp);
D(oa,Function,{show:function(a){var b=a.name||a._name||"\u03bb";if(a.constructor)return b+" :: "+a.constructor.name;a=(a=a.toString().match(/\([^\)]*\)/))&&a[0]||"";return b+a}});D(oa,String,{show:function(a){return'"'+a.toString()+'"'}});D(oa,Array,{show:function(a){return typeof a[0]==String?'"'+a.join("")+'"':"["+hb(oa.show,a).join(", ")+"]"}});D(oa,Object,{show:function(a){var b=[];for(var d in a)b.push("  "+d+": "+oa.show(a[d]));return"{\n"+a.join(",\n")+"\n}"}});y("Haskell_DataTypes",{Unit:Ib,
Tuple:ga,Maybe:kb,Ordering:ea,Either:Va,Eq:ha,Ord:ka,Functor:ma,Monad:Pa,Scope:Qb,Show:oa})})();(function(){namespace("Haskell");importSubmodules("Haskell",["Main","ADT","Typeclass","Expression","Do","DataTypes"])})();(function(){function y(c,f){this.input=c;this.index=f||0;this.length=c.length-this.index;this.cache={};return this}function pb(c){return new y(c)}function P(c,f,g){return{ast:c,success:f===ba?true:f,expecting:g}}function Xa(c){return P(ba,false,c)}function G(c){return function(f,g,l){return l(P(null,
false,{unexpected:c}))}}function da(c){return function(f,g,l){return l(P(ba,false,c))}}function zb(c,f,g){return g(P(ba,false))}function za(c){return typeof c=="string"?vb(c):sb(c)?h(c):c}function Ab(c){for(;c&&c.func;)c=c.func.apply(null,c.args||[])}function Ya(c,f){f=f||0;f++;if(c&&c.func){c=c.func.apply(null,c.args||[]);f%500==0?setTimeout(function(){Ya(c,f)},1):Ya(c,f)}else f=0}function t(c,f,g,l,s){var q=f instanceof y?f:pb(f);(s?Ya:Ab)({func:c,args:[new Ha,q,function(p){p.state=q;delete p.index;
delete p.length;if(p.success){delete p.error;delete p.expecting}else{p.error=Ra(p.expecting,p.state);l&&l(p.error)}g(p)}]})}function Ra(c,f,g,l){g=g===undefined?f.index:g;if(typeof c=="string"){var s=f.input.split("\n"),q=s.length,p=f.input.substr(g).split("\n").length;q=q-p+1;s=g-s.splice(0,q-1).join("\n").length;f=l||f.input.substr(g,c.length).substr(0,6);return'Unexpected "'+(f.length?f:"end of input")+(l?"":'", expecting "'+c)+'" at line '+q+" char "+s}if(sb(c)){c=ra(function(v){return typeof v==
"object"?v.expecting:v},c);return Ra(c.join('" or "'),f)}else if(typeof c=="object")return Ra(c.expecting,f,c.at,c.unexpected)}function J(){}function Ga(c,f){return function(g,l,s){return{func:c,args:[g,l,function(q){return q.success?{func:f(q.ast),args:[g,l,s]}:s(q)}]}}}function M(c,f){if(c=="scope")throw"Can't use 'scope' as an identifier!";return function(g,l,s){return{func:f,args:[g,l,function(q){if(q.success)g[c]=q.ast;q=Pa({},q);return s(q)}]}}}function Q(c,f){f&&Ta(arguments);return function(g,
l,s){return{func:function(){var q;if(typeof c=="string"){if(!(c in g))throw'Not in scope: "'+c+'"';q=g[c]}else q=c(g);return s(P(q))}}}}function Aa(c){var f=Ta(arguments,1);return function(g){return c.apply(null,ra(function(l){return g[l]},f))}}function Lb(c,f,g){return g(P(f.index))}function Bb(c){var f=typeof c;return function(g,l,s){l.scrollTo(f=="string"?g[c]:c);return s(Ia)}}function Sa(c){return function(f,g,l){return l(P(c))}}function dc(c,f){return A(M("a",c),M("b",f),Q(function(g){return g.a(g.b)}))}
function hb(c,f){return A(M("x1",f),ua(c,"x1"))}function Cb(c,f,g){return A(M("x1",f),M("x2",g),ua(c,"x1","x2"))}function Mb(c,f,g,l){return A(M("x1",f),M("x2",g),M("x3",l),ua(c,"x1","x2","x3"))}function Ub(c,f){return A(M("a",c),f,Q("a"))}function R(c,f){function g(l,s,q){return{func:c,args:[l,s,function(p){function v(T){var W=T.expecting;if(W)if(sb(W))E=E.concat(W);else E.push(W);if(T.success)delete T.expecting;else T.expecting=E}var E=[];v(p);return p.ast!==ba?{func:q,args:[p]}:{func:f,args:[l,
s,function(T){v(T);return q(T)}]}}]}}g.constructor=J;return g}function Vb(){var c=ra(za,arguments);return function(f,g,l){for(var s=1,q=c.length,p=c[0];s<q;++s)p=R(p,c[s]);return p(f,g,l)}}function ec(c){return function(f,g,l){function s(E){return function(T,W,Da){return{func:E,args:[T,W,function(pa){q++;if(!pa.success)return Da(pa);pa.ast!==ba&&p.push(pa.ast);return q<v?s(c[q])(T,W,Da):Da(pa)}]}}}var q=0,p=[],v=c.length;return{func:s(c[q]),args:[f,g,function(E){E=Pa({},E);E.ast=p;E.success&&delete E.expecting;
return l(E)}]}}}function Wb(c){return function(f){return function(g,l,s){function q(E){return function(T,W,Da){return{func:E,args:[T,W,function(pa){if(!pa.success)return Da(pa);p=true;pa.ast!==ba&&v.push(pa.ast);return q(E)(T,W,Da)}]}}}var p=false,v=[];return{func:q(f),args:[g,l,function(E){E=Pa({},E);E.success=!c||p&&c;E.ast=v;if(E.success)delete E.expecting;else E.ast=ba;return s(E)}]}}}}function Db(c){return function(f){var g=Yb++,l=function(s,q,p){s=q.index;var v=q.getCached(g);if(v!==ba)return p(v);
v=c(f,q,s);q.putCached(g,s,v);return p(v)};l.constructor=J;return l}}function ib(c){return function(f,g){var l=Yb++,s=function(q,p,v){var E=p.index,T=p.getCached(l);if(T!==ba)return v(T);return{func:f,args:[q,p,function(W){W=c(g,W,p,E);p.putCached(l,E,W);return v(W)}]}};s.constructor=J;return s}}function V(c){return function(f,g,l){return c(f)(f,g,l)}}function Eb(c){function f(p,v){return g.do_(l("x",p),l("xs",v),s(q(Na,"x","xs")))}var g=ka(K,Ba(c[0])),l=NS.Text_Parsec.bind,s=NS.Text_Parsec.ret,q=
NS.Text_Parsec.withBound;return Ca(f,g.return_([]),c)}function ta(c){return Ca(R,ub,c)}function Nb(c,f){return R(f,e(c))}function ca(c){return Nb(u.Nothing,hb(u.Just,c))}function Za(c){return R(A(c,e(null)),e(null))}function L(c,f,g){return A(c,M("x",g),f,Q("x"))}function C(c){return A(c,cb(c))}function jb(c,f){return R(Ob(c,f),e([]))}function Ob(c,f){return A(M("x",c),M("xs",F(A(f,c))),ua(Na,"x","xs"))}function Fb(c,f){return A(M("x",c),R(A(f,M("xs",function(g,l,s){return la(c,f)(g,l,s)}),Q(function(g){return Na(g.scope.x,
g.xs)})),Q(function(g){return[g.x]})))}function la(c,f){return R(Fb(c,f),e([]))}function $a(c,f){return S(A(M("x",c),f,Q("x")))}function fc(c,f){return F(A(M("x",c),f,Q("x")))}function z(c,f){return c<=0?e([]):Eb(mb(c,f))}function gc(c,f,g){return R(o(c,f),e(g))}function db(c,f,g){return R(qb(c,f),e(g))}function qb(c,f){function g(l){var s=A(M("f",f),M("y",c),function(q,p,v){return g(q.f(l,q.y))(q,p,v)});return R(s,e(l))}return Ga(c,g)}function o(c,f){function g(s){var q=A(M("f",f),M("y",l),Q(function(p){return p.f(s,
p.y)}));return R(q,e(s))}var l=Ga(c,g);return l}function hc(c,f,g){c=f.at(0);if(c.length){f.scroll(1);return g(P(c))}return g(Xa("anyToken"))}function X(c,f,g){return g(P(ba,!f.length,f.length?"end of input":ba))}function H(c){return Z(R(Ga(Z(c),G),e(null)))}function w(c,f){function g(s,q,p){return l(s,q,p)}var l=R(A(f,e([])),A(M("x",c),M("xs",g),ua(Na,"x","xs")));return l}function lb(c){return A(M("state",Rb),M("x",c),Ua("state"),Q("x"))}function eb(){}function fb(){}function D(c,f){function g(p,
v){return function(E,T,W){return p(E[v])(E,T,W)}}function l(p,v){var E=p[0],T=v[0],W=v[1],Da=v[2],pa=v[3];v=v[4];if(p.Infix){var Qa=p[1];if(Qa.AssocNone)return[T,W,Na(E,Da),pa,v];if(Qa.AssocLeft)return[T,Na(E,W),Da,pa,v];if(Qa.AssocRight)return[Na(E,T),W,Da,pa,v]}if(p.Prefix)return[T,W,Da,Na(E,pa),v];if(p.Postfix)return[T,W,Da,pa,Na(E,v)]}function s(p,v){return Z(A(v,Ja("ambiguous use of a "+p+" associative operator")))}function q(p,v){function E(xa){return I(N("f","<-",tc)("y","<-",N("z","<-",jc)(g,
T,"z"))(Q,function(ob){return ob.f(xa,ob.y)}),"<|>",mc,"<|>",nc)}function T(xa){return R(E(xa),e(xa))}function W(xa){return I(N("f","<-",uc)("y","<-",jc)(function(ob,vc,xc){return Da(ob.f(xa,ob.y))(ob,vc,xc)}),"<|>",oc,"<|>",nc)}function Da(xa){return R(W(xa),e(xa))}function pa(xa){return N("f","<-",pc)("y","<-",jc)(oc,"<|>",mc,"<|>",nc,"<|>",Q,function(ob){return ob.f(xa,ob.y)})}var Qa=Ca(l,[[],[],[],[],[]],v),yc=Qa[1],zc=Qa[2],Zb=Qa[3];v=Qa[4];var tc=ta(Qa[0]),uc=ta(yc),pc=ta(zc);Qa=$b(ta(Zb),"");
v=$b(ta(v),"");var oc=s("right",tc),mc=s("left",uc),nc=s("non",pc);v=R(v,e(wa));Qa=R(Qa,e(wa));var jc=N("pre","<-",Qa)("x","<-",p)("post","<-",v)(Q,function(xa){return xa.post(xa.pre(xa.x))});return N("x","<-",jc)(g,E,"x","<|>",g,W,"x","<|>",g,pa,"x","<|>",Q,"x","<?>","operator").resolve()}return La(q,f,c)}function ab(){}function Ka(){}function bb(c){function f(j){return g(vb(j))}function g(j){return A(M("x",j),Jc,Q("x"))}function l(j,U,ia){return Kc(j,U,ia)}function s(j,U,ia){return Lc(j,U,ia)}function q(j,
U,ia){return Ac(j,U,ia)}function p(j){return L(f("("),f(")"),j)}function v(j){return L(f("{"),f("}"),j)}function E(j){return L(f("<"),f(">"),j)}function T(j){return L(f("["),f("]"),j)}function W(j){return jb(j,Bc)}function Da(j){return jb(j,Cc)}function pa(j){return Ob(j,Bc)}function Qa(j){return Ob(j,Cc)}function yc(j){return A(O(j[0]),e(j[1]))}function zc(j){return Z(A(vb(j[0]),e(j[1])))}function Zb(j,U){return N("digits","<-",S,U)(Q,function(ia){return La(function(Wa,qc){return j*Wa+rb(Jb(qc))},
0,ia.digits)})}function tc(j,U,ia){return ac(j,U,ia)}function uc(j,U){return(U+i(Jb(j)))/10}function pc(j){return j<0?1/pc(-j):va(Math.pow(10,j))}function oc(j){return I(N("fract","<-",Rc)("expo","<-",Nb,1,Mc)(Q,function(U){return va(j+U.fract)*U.expo}),"<|>",N("expo","<-",Mc)(Q,function(U){return va(j)*U.expo}))}function mc(j){return N("f","<-",oc,j)(ua,aa.Right,"f")}function nc(j){return I(g,"$",Z,N(vb(j))(H,c.opLetter,"<?>","end of "+j))}function jc(j){return vc(fa(c.reservedOpNames),j)}function xa(j){function U(Wa){return!Wa.length?
e(null):A($b(ia(Wa[0]),""+j),U(Ta(Wa,1)))}function ia(Wa){return yb(Wa)?R(O(Wa.toLowerCase()),O(Wa.toUpperCase())):O(Wa)}return c.caseSensitive?vb(j):A(U(j),e(j))}function ob(j){return I(g,"$",Z,N(xa(j))(H,c.identLetter,"<?>","end of "+j))}function vc(j,U){function ia(Wa){if(!Wa.length)return false;var qc=Qb(Wa[0],U);return qc.LT?ia(Ta(Wa,1)):qc.EQ?true:qc.GT?false:null}return ia(j)}function xc(j){j=c.caseSensitive?j:j.toLowerCase();return vc(Sc,j)}if(!c.LanguageDef)throw"Type error: unexpected '"+
c.constructor.name+"', expecting 'GenLanguageDef.LanguageDef'";var kc=C(Ea(ea)),wc=N(Z(vb(c.commentLine)))(cb,Ea(function(j){return j!="\n"}))(e,null),sa=Pb(Ta(c.commentEnd+c.commentStart)),Kc=I(A(Z(vb(c.commentEnd)),e(null)),"<|>",A(C(Dc(sa)),l),"<|>",A(wb(sa),l),"<?>","end of comment"),Lc=I(A(Z(vb(c.commentEnd)),e(null)),"<|>",A(q,s),"<|>",A(C(Dc(sa)),s),"<|>",A(wb(sa),s),"<?>","end of comment");sa=c.nestedComments?Lc:Kc;var Ac=A(Z(vb(c.commentStart)),sa);sa=Ib(c.commentLine);var xb=Ib(c.commentStart),
Jc=h(sa&&xb?[cb,[kc,"<?>",""]]:sa?[cb,[kc,"<|>",Ac,"<?>",""]]:xb?[cb,[kc,"<|>",wc,"<?>",""]]:[cb,[kc,"<|>",wc,"<|>",Ac,"<?>",""]]),Cc=f(";"),Bc=f(",");kc=f(".");wc=f(":");sa=Gb(Ta("abfnrtv\\\"'"),Ta("a\u0008\u000c\n\r\t\u000b\\\"'"));xb=Gb(["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","SUB","ESC","DEL"].concat(["BS","HT","LF","VT","FF","CR","SO","SI","EM","FS","GS","RS","US","SP"]),["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","DLE","DC1",
"DC2","DC3","DC4","NAK","SYN","ETB","CAN","SUB","ESC","DEL"].concat(["BS","HT","LF","VT","FF","CR","SO","SI","EM","FS","GS","RS","US","SP"]));sa=ta(ra(yc,sa));var Kb=ta(ra(zc,xb));xb=Ea(function(j){return j!='"'&&j!="\\"&&j>"\u0016"});var bc=O("&"),rc=N(S,Ec)(O("\\"),"<?>","end of string gap"),cc=N("code","<-",tc,"<|>",A(O("o"),Zb(8,Fc)),"<|>",A(O("x"),Zb(16,Gc)))(Q(function(j){return toEnum(va(j.code))})),Sb=N(O("^"))("code","<-",Nc)(Q(function(j){return toEnum(fromEnum(j.code)-fromEnum("A"))}));
Kb=I(sa,"<|>",cc,"<|>",Kb,"<|>",Sb,"<?>","escape code");sa=A(O("\\"),Kb);cc=Ea(function(j){return j!="'"&&j!="\\"&&j>"\u0016"});sa=I(cc,"<|>",sa,"<?>","literal character");sa=I(g,[L,O("'"),[O("'"),"<?>","end of character"],sa],"<?>","character");bc=N(O("\\"))(A(rc,e(u.Nothing)),"<|>",A(bc,e(u.Nothing)),"<|>",N("esc","<-",Kb)(ua,u.Just,"esc"));xb=I(N("c","<-",xb)(ua,u.Just,"c"),"<|>",bc,"<?>","string character");xb=I(g,[N("str","<-",L,O('"'),[O('"'),"<?>","end of string"],[F,xb])(Q,function(j){return Ca(Y(tb)(wa,
Y(Na)),"",j.str)}),"<?>","literal string"]);var ac=Zb(10,Hc);bc=N(wb,"xX")(Zb,16,Gc);rc=N(wb,"oO")(Zb,8,Fc);var Rc=I(N(O("."))("digits","<-",S,Hc,"<?>","fraction")(Q,function(j){return Ca(uc,0,j.digits)}),"<?>","fraction");Kb=I([O("-"),">>",e,lc],"<|>",[O("+"),">>",e,wa],"<|>",e,wa);var Mc=I(N(wb,"eE")("f","<-",Kb)("e","<-",ac,"<?>","exponent")(ua,pc,"f","e"),"<?>","exponent");cc=N("n","<-",ac)(function(j,U,ia){return oc(j.n)(j,U,ia)});Sb=N("n","<-",ac)(function(j,U,ia){return Nb(aa.Left(j.n),mc(j.n))(j,
U,ia)});var Tb=I(N("n","<-",bc,"<|>",rc)(ua,aa.Left,"n"),"<|>",Sb,"<|>",mc(0),"<|>",e,aa.Left(0));Sb=I(A(O("0"),Tb),"<|>",Sb);Tb=I(N(O,"0")(bc,"<|>",rc,"<|>",ac,"<|>",e,0),"<?>","");Tb=R(Tb,ac);var sc=N("f","<-",g,Kb)("n","<-",Tb)(Q,function(j){return j.f(j.n)});Kb=I(g,Sb,"<?>","number").resolve();cc=I(g,cc,"<?>","float").resolve();Sb=I(g,sc,"<?>","integer").resolve();Tb=I(g,Tb,"<?>","natural").resolve();sc=I(N("c","<-",c.opStart)("cs","<-",F,c.opLetter)(ua,Xb,"c","cs"),"<?>","operator");sc=I(g,"$",
Z,N("name","<-",sc)(function(j,U,ia){return(jc(j.name)?G("reserved operator "+j.name):e(j.name))(j,U,ia)}));var Ic=I(N("c","<-",c.identStart)("cs","<-",F,c.identLetter)(ua,Xb,"c","cs"),"<?>","identifier");Ic=I(g,"$",Z,N("name","<-",Ic)(function(j,U,ia){return(xc(j.name)?G("reserved word "+j.name):e(j.name))(j,U,ia)}));var Oc=fa(c.reservedNames),Sc=c.caseSensitive?Oc:ra(function(j){return j.toLowerCase()},Oc);return Ka.TokenParser(ga,{identifier:Ic,reserved:ob,operator:sc,reservedOp:nc,charLiteral:sa,
stringLiteral:xb,natural:Tb,integer:Sb,float_:cc,naturalOrFloat:Kb,decimal:ac,hexadecimal:bc,octal:rc,symbol:f,lexeme:g,whiteSpace:Jc,parens:p,braces:v,angles:E,brackets:T,squares:T,semi:Cc,comma:Bc,colon:wc,dot:kc,semiSep:Da,semiSep1:Qa,commaSep:W,commaSep1:pa})}var Y=NS.Haskell.curry,qa=NS.Haskell.const_,sb=NS.Haskell.isArray,Ta=NS.Haskell.slice,La=NS.Haskell.foldl,Ca=NS.Haskell.foldr,ra=NS.Haskell.map,Gb=NS.Haskell.zip,fa=NS.Haskell.isort,Pb=NS.Haskell.nub,tb=NS.Haskell.maybe,Qb=NS.Haskell.compare,
Ma=NS.Haskell.compose,gb=NS.Haskell.call,wa=NS.Haskell.id,na=NS.Haskell.flip,Na=NS.Haskell.cons,Xb=NS.Haskell.consJoin,mb=NS.Haskell.replicate,lc=NS.Haskell.negate,Ib=NS.Haskell.null_,kb=NS.Haskell.elem,ea=NS.Haskell.isSpace,Va=NS.Haskell.isUpper,ma=NS.Haskell.isLower,yb=NS.Haskell.isAlpha,ya=NS.Haskell.isAlphaNum,Fa=NS.Haskell.isDigit,Oa=NS.Haskell.isHexDigit,ic=NS.Haskell.isOctDigit,Jb=NS.Haskell.digitToInt,Pa=NS.Haskell.extend,ja=NS.Haskell.namespace,rb=NS.Haskell.toInteger,va=NS.Haskell.fromInteger,
i=NS.Haskell.fromIntegral,Ba=NS.Haskell.typeOf,$=NS.Haskell.data,ga=NS.Haskell.record,ha=NS.Haskell.instance,ka=NS.Haskell.getInstance,oa=NS.Haskell.operators,a=NS.Haskell.infix,b=NS.Haskell.infixl,d=NS.Haskell.infixr,h=NS.Haskell.resolve,m=NS.Haskell.exl,B=NS.Haskell.exs,u=NS.Haskell.Maybe,aa=NS.Haskell.Either,K=NS.Haskell.Monad,Ha=NS.Haskell.Scope,ba;y.prototype={memoize:false,scrollTo:function(c){this.index=c;this.length=this.input.length-c;return this},scroll:function(c){this.index+=c;this.length-=
c;return this},dropped:0,at:function(c){return this.input.charAt(this.index+c)},substring:function(c,f){return this.input.substring(c+this.index,(f||this.length)+this.index)},substr:function(c,f){return this.input.substring(c+this.index,f||this.length)},toString:function(){var c=this.substring(0);return"PS at "+this.index+" "+(c.length?'"'+c+'"':"Empty")},getCached:function(c){if(this.memoize)if(c=this.cache[c])if(c=c[this.index]){this.index=c.index;this.length=c.length;return c}},putCached:function(c,
f,g){if(!this.memoize)return false;g.index=this.index;g.length=this.length;var l=this.cache[c];l||(l=this.cache[c]={});l[f]=g},sourceLine:function(c){return(c=this.input.substring(0,c).match(/(\r\n)|\r|\n/g))?c.length:0}};var Ia=P(ba),Ja=da,ub=zb,nb=ub,Yb=0,Hb=function(c,f){function g(l,s,q){return{func:c,args:[l,s,function(p){return p.success?f(l,s,q):q(p)}]}}g.constructor=J;return g},A=function(){function c(g,l,s){g=new Ha(g);for(var q=1,p=f.length,v=f[0];q<p;++q)v=Hb(v,f[q]);return v(g,l,s)}var f=
ra(za,arguments);c.constructor=J;return c},ua=Ma(Q,Aa),Rb=Lb,Ua=Bb,e=Sa,k=e;Ma=hb;var r=Hb,n=R,F=Wb(false),S=Wb(true),Z=ib(function(c,f,g,l){f=Pa({},f);if(f.success)return f;g.scrollTo(l);f.ast=ba;return f}),cb=function(c){return ib(function(f,g){g=Pa({},g);g.ast=ba;return g})(F(c),null)},O=Db(function(c,f){if(f.length>0&&f.at(0)==c){f.scroll(1);return P(c)}return Xa(c)}),Ea=Db(function(c,f){var g=f.at(0);if(f.length>0&&c(g)){f.scroll(1);return P(g)}return Xa(g)}),vb=function(c){return ib(function(f,
g,l,s){g=Pa({},g);g.ast=g.ast.join("");if(g.success)delete g.expecting;else g.expecting={at:s,expecting:c};if(!g.ast.length)g.ast=ba;return g})(ec(ra(O,c)),null)},$b=ib(function(c,f,g,l){if(!f.success){f=Pa({},f);f.expecting={at:l,expecting:c}}return f}),Tc=Db(function(c,f){var g;if(typeof c=="string")if(f.substring(0,c.length)==c){f.scroll(c.length);g=P(c)}else g=Xa(c);else if(c.exec){var l=new RegExp("^"+c.source);g=f.substring(0);l=(l=(l=l.exec(g))&&l[0])&&l.length;g=g.substr(0,l);if(l){f.scroll(l);
g=P(g)}else g=Xa(c.source)}return g});Pa(oa,{"<-":{func:M,fixity:d(-1)},">>=":{func:Ga,fixity:b(1)},"=<<":{func:na(Ga),fixity:d(1)},">>":{func:r,fixity:b(1)},"*>":{func:r,fixity:b(4)},"<*":{func:Ub,fixity:b(4)},"<$>":{func:Ma,fixity:b(4)},"<*>":{func:dc,fixity:b(4)},"<**>":{func:Y(Cb)(na(gb)),fixity:b(4)},"<$":{func:function(c,f){return Ub(k(value),f)},fixity:b(4)},"<|>":{func:R,fixity:d(1)},"<?>":{func:$b,fixity:a(0)}});ha(K,J,function(){return{">>=":Ga,">>":Hb,do_:A,return_:Sa,fail:da,run:t}});
var N=ka(K,J).do$,I=m(J);ja("Text_Parsec_Prim",{sequence:Eb,run:t,Parser:J,ParseState:y,ps:pb,toParser:za,unexpected:G,parsecMap:Ma,fmap:Ma,liftM:hb,liftM2:Cb,liftM3:Mb,liftA:Ma,liftA2:Cb,liftA3:Mb,ap:dc,parserBind:Ga,parserReturn:Sa,return_:e,pure:k,parserFail:da,fail:Ja,parserZero:zb,mzero:ub,empty:nb,parserPlus:R,parserPlusN:Vb,mplus:n,do_:A,do$:N,do2:Hb,bind:M,ret:Q,withBound:Aa,returnCall:ua,getPosition:Lb,setPosition:Bb,getParserState:Rb,setParserState:Ua,tokens:ec,many:F,many1:S,string:vb,
char_:O,satisfy:Ea,label:$b,try_:Z,skipMany:cb,match:Tc,withScope:V,ex:I});ja("Text_Parsec_Combinator",{choice:ta,count:z,between:L,option:Nb,optionMaybe:ca,optional:Za,skipMany1:C,sepBy:jb,sepBy1:Ob,endBy:fc,endBy1:$a,sepEndBy:la,sepEndBy1:Fb,chainl:db,chainl1:qb,chainr:gc,chainr1:o,eof:X,notFollowedBy:H,manyTill:w,lookAhead:lb,anyToken:hc});$(eb,["AssocNone","AssocLeft","AssocRight"]);$(fb,[["Infix",J,eb],["Prefix",J],["Postfix",J]]);ja("Text_Parsec_Expr",{Assoc:eb,Operator:fb,buildExpressionParser:D});
var wb=function(c){return $b(Ea(function(f){return kb(f,c)}),"oneOf("+c+")")},Dc=function(c){return $b(Ea(function(f){return!kb(f,c)}),"noneOf("+c+")")},Ec=I(Ea,ea,"<?>","space").resolve();gb=I(cb,Ec,"<?>","white space").resolve();na=I(O,"\n","<?>","new-line").resolve();ha=I(O,"\t","<?>","tab").resolve();var Nc=I(Ea,Va,"<?>","uppercase letter").resolve();ma=I(Ea,ma,"<?>","lowercase letter").resolve();ya=I(Ea,ya,"<?>","letter or digit").resolve();Va=I(Ea,yb,"<?>","letter").resolve();var Hc=I(Ea,Fa,
"<?>","digit").resolve(),Gc=I(Ea,Oa,"<?>","hexadecimal digit").resolve(),Fc=I(Ea,ic,"<?>","octal digit").resolve();qa=I(Ea,qa(true)).resolve();ja("Text_Parsec_Char",{oneOf:wb,noneOf:Dc,space:Ec,spaces:gb,newline:na,tab:ha,upper:Nc,lower:ma,alphaNum:ya,letter:Va,digit:Hc,hexDigit:Gc,octDigit:Fc,anyChar:qa});$(ab,[["LanguageDef",{commentStart:String,commentEnd:String,commentLine:String,nestedComments:Boolean,identStart:J,identLetter:J,opStart:J,opLetter:J,reservedNames:Array,reservedOpNames:Array,caseSensitive:Boolean}]]);
$(Ka,[["TokenParser",{identifier:J,reserved:Function,operator:J,reservedOp:Function,charLiteral:J,stringLiteral:J,natural:J,integer:J,float_:J,naturalOrFloat:J,decimal:J,hexadecimal:J,octal:J,symbol:Function,lexeme:Function,whiteSpace:J,parens:Function,braces:Function,angles:Function,brackets:Function,squares:Function,semi:J,comma:J,colon:J,dot:J,semiSep:Function,semiSep1:Function,commaSep:Function,commaSep1:Function}]]);ja("Text_Parsec_Token",{GenLanguageDef:ab,GenTokenParser:Ka,makeTokenParser:bb});
Fa=wb(":!#$%&*+./<=>?@\\^|-~");$=ab.LanguageDef(ga,{commentStart:"",commentEnd:"",commentLine:"",nestedComments:true,identStart:B(Va,"<|>",O("_")),identLetter:B(ya,"<|>",wb("_'")),opStart:Fa,opLetter:Fa,reservedOpNames:[],reservedNames:[],caseSensitive:true});qa=ab.LanguageDef(ga,{commentStart:"{-",commentEnd:"-}",commentLine:"--",nestedComments:true,identStart:Va,identLetter:I(ya,"<|>",wb,"_'").resolve(),opStart:Fa,opLetter:Fa,reservedOpNames:[],reservedNames:[],caseSensitive:true});Fa=ab.LanguageDef(ga,
{commentStart:"/*",commentEnd:"*/",commentLine:"//",nestedComments:true,identStart:Va,identLetter:B(ya,"<|>",wb,"_'"),opStart:Fa,opLetter:Fa,reservedOpNames:[],reservedNames:[],caseSensitive:false});Oa=qa.update({reservedOpNames:["::","..","=","\\","|","<-","->","@","~","=>"],reservedNames:["let","in","case","of","if","then","else","data","type","class","default","deriving","do","import","infix","infixl","infixr","instance","module","newtype","where","primitive"]});var Pc=Oa.update({identLetter:B(Oa.identLetter,
"<|>",O("#")),reservedNames:Oa.reservedNames.concat(["foreign","import","export","primitive","_ccall_","_casm_","forall"])}),Qc=Fa.update({reservedNames:["case","class","default","extends","import","in","let","new","of","package"],caseSensitive:true});ja("Text_Parsec_Language",{emptyDef:$,haskellStyle:qa,javaStyle:Fa,haskellDef:Pc,mondrianDef:Qc,getHaskell:function(){return bb(Pc)},getMondrian:function(){return bb(Qc)}})})();(function(){namespace("Text_Parsec");importSubmodules("Text_Parsec",["Prim",
"Char","Combinator","Token","Language","Expr"])})();(function(){function y(){}function pb(){}function P(){}function Xa(e){if(!(e instanceof P))throw"Type error: expecting type of 'Id' instead of "+e.constructor;return e.Id?e[1]:null}function G(){}function da(){}function zb(){}function za(){}function Ab(){}function Ya(){}function t(){}function Ra(){}function J(){}function Ga(){}function M(){}function Q(){}function Aa(e,k){for(var r=!!k.charAt,n=0,F=k.length;n<F;++n)if(!e(r?k.charAt(n):k[n]))break;
return lc(k,n)}function Lb(e,k,r){return function(n,F,S){return(F.sourceLine(n[e])==F.sourceLine(n[k])?db(la(C.Just,r),z(C.Nothing)):z(C.Nothing))(n,F,S)}}function Bb(e,k,r){return function(n,F,S){return(F.sourceLine(n[e])==F.sourceLine(n[k])?r:Ob("end of line"))(n,F,S)}}function Sa(e,k,r){var n=k.input.substring(0,k.index-k.dropped).match(/\s*$/);n=n&&/\n|\r/.test(n[0]);var F;if(!n){var S=k.at(0);if(S==""||S=="}")n=true;else if(S==";")F=n=true}return(n?F?i.semi:z(null):gc("end of statement"))(e,
k,r)}function dc(e){return e==" "||e=="\t"}function hb(e){return function(k,r,n){return Cb(e)(k,r,n)}}function Cb(e){return Y([D(e),">>",z,""],"<|>",[o(Ka,[fb,"\\'"])("cs","<-",hb(e))(X,function(k){return"'"+k.cs})],"<|>",[o(D("\\"))("c","<-",nb,"<|>",Yb,"<|>",Hb,"<|>",D("\r"),"<|>",D("\n"))("cs","<-",hb(e))(X,function(k){return k.c=="\r"||k.c=="\n"?Va(k.c,Aa(dc,k.cs)):Va(k.c,k.cs)})],"<|>",[$a,Va,Gb,hb(e)])}function Mb(e,k,r){return k>=1?Mb(e,k/10,r):(e+k)*Math.pow(10,r)}function Ub(e){return Y(e,
">>=",[z,".",C.Just])}function R(e,k){return qb(hc("pos",w),hc("e",k),X(function(r){return e(r.pos,r.e)}))}function Vb(e){function k(r,n){return t.DotRef(r,e,n)}return Y([i.reservedOp("."),">>",R,k,a],"<?>","property.ref")}function ec(e){function k(r,n){return t.CallExpr(r,e,n)}return Y([i.parens,"$",R,k,[ka,va(tb),i.comma]],"<?>","(function application)")}function Wb(e){function k(r,n){return t.BracketRef(r,e,n)}return Y([i.brackets,"$",R,k,ka],"<?>","[property-ref]")}function Db(e){if(e.Just){e=
e[0];return Y(o("e_","<-",Vb(e),"<|>",Wb(e))(function(k,r,n){return Db(C.Just(k.e_))(k,r,n)}),"<|>",z(e))}if(e.Nothing)return o("e","<-",ha,"<?>","expression (3)")(function(k,r,n){return Db(C.Just(k.e))(k,r,n)})}function ib(e){if(e.Just){e=e[0];return Y(o("e_","<-",Vb(e),"<|>",ec(e),"<|>",Wb(e))(function(k,r,n){return ib(C.Just(k.e_))(k,r,n)}),"<|>",z(e))}if(e.Nothing)return o("e","<-",ha,"<?>","expression (3)")(function(k,r,n){return ib(C.Just(k.e))(k,r,n)})}function V(e,k){e=o("pos","<-",w)(i.reservedOp(e))(X,
function(r){return function(n,F){return t.InfixExpr(r.pos,k,n,F)}});return Xb.Infix(e,Na.AssocLeft)}function Eb(e,k){if(k.VarRef)if(k[1].Id)return z(Ya.LVar(k[0],k[1][1]));if(k.DotRef)if(k[2].Id)return z(Ya.LDot(k[0],k[1],k[2][1]));if(k.BracketRef)return z(Ya.LBracket(k[0],k[1],k[2]));return gc("expeceted l-value at "+e)}function ta(e,k){return function(r){return t.UnaryAssignExpr(e,zb[k],r)}}function Nb(e,k){return function(r,n,F){var S=n.substring(0,2);if(S=="--"||S=="++"){S=n.input.substring(0,
n.index-n.dropped).match(/\s*$/);return(S&&/\n|\r/.test(S[0])?k:e)(r,n,F)}else return k(r,n,F)}}var ca=NS.Haskell_ADT.data,Za=NS.Haskell_ADT.ADT;Za=NS.Haskell_ADT.record;var L=NS.Haskell_ADT.accessor;L=NS.Haskell_ADT.accessors;L=NS.Haskell_DataTypes.Unit;L=NS.Haskell_DataTypes.Tuple;var C=NS.Haskell_DataTypes.Maybe;L=NS.Haskell_DataTypes.Ordering;L=NS.Haskell_DataTypes.Either;L=NS.Haskell_DataTypes.Eq;L=NS.Haskell_DataTypes.Ord;L=NS.Haskell_DataTypes.Functor;L=NS.Haskell_DataTypes.Monad;L=NS.Haskell_DataTypes.Scope;
L=NS.Haskell_DataTypes.Show;var jb=NS.Text_Parsec.sequence,Ob=NS.Text_Parsec.unexpected,Fb=NS.Text_Parsec.fmap,la=NS.Text_Parsec.liftM,$a=NS.Text_Parsec.liftM2,fc=NS.Text_Parsec.parserBind,z=NS.Text_Parsec.return_,gc=NS.Text_Parsec.fail,db=NS.Text_Parsec.parserPlus,qb=NS.Text_Parsec.do_,o=NS.Text_Parsec.do$,hc=NS.Text_Parsec.bind,X=NS.Text_Parsec.ret,H=NS.Text_Parsec.returnCall,w=NS.Text_Parsec.getPosition,lb=NS.Text_Parsec.many,eb=NS.Text_Parsec.many1,fb=NS.Text_Parsec.string,D=NS.Text_Parsec.char_,
ab=NS.Text_Parsec.label,Ka=NS.Text_Parsec.try_,bb=NS.Text_Parsec.withScope,Y=NS.Text_Parsec.ex,qa=NS.Text_Parsec.oneOf,sb=NS.Text_Parsec.noneOf,Ta=NS.Text_Parsec.spaces,La=NS.Text_Parsec.alphaNum,Ca=NS.Text_Parsec.letter,ra=NS.Text_Parsec.hexDigit,Gb=NS.Text_Parsec.anyChar,fa=NS.Text_Parsec.option,Pb=NS.Text_Parsec.optionMaybe,tb=NS.Text_Parsec.sepBy,Qb=NS.Text_Parsec.sepBy1,Ma=NS.Text_Parsec.sepEndBy,gb=NS.Text_Parsec.notFollowedBy,wa=NS.Text_Parsec.GenLanguageDef,na=NS.Text_Parsec.makeTokenParser,
Na=NS.Text_Parsec.Assoc,Xb=NS.Text_Parsec.Operator,mb=NS.Text_Parsec.buildExpressionParser,lc=NS.Haskell.slice,Ib=NS.Haskell.map,kb=NS.Haskell.maybe,ea=NS.Haskell.id,Va=NS.Haskell.cons,ma=NS.Haskell.negate,yb=NS.Haskell.elem,ya=NS.Haskell.namespace,Fa=NS.Haskell.fst,Oa=NS.Haskell.uncurry,ic=NS.Haskell.lookup,Jb=NS.Haskell.readHex,Pa=NS.Haskell.readOct,ja=NS.Haskell.chr,rb=NS.Haskell.round;ca=NS.Haskell.data;Za=NS.Haskell.ADT;Za=NS.Haskell.record;L=NS.Haskell.accessor;L=NS.Haskell.accessors;var va=
NS.Haskell.op;L=NS.Haskell.Unit;L=NS.Haskell.Tuple;C=NS.Haskell.Maybe;L=NS.Haskell.Ordering;L=NS.Haskell.Either;L=NS.Haskell.Eq;L=NS.Haskell.Ord;L=NS.Haskell.Functor;L=NS.Haskell.Monad;L=NS.Haskell.Scope;L=NS.Haskell.Show;ca(pb,[["Script","a",Array]]);ca(P,[["Id","a",String]]);ca(G,["OpLT","OpLEq","OpGT","OpGEq","OpIn","OpInstanceof","OpEq","OpNEq","OpStrictEq","OpStrictNEq","OpLAnd","OpLOr","OpMul","OpDiv","OpMod","OpSub","OpLShift","OpSpRShift","OpZfRShift","OpBAnd","OpBXor","OpBOr","OpAdd"]);ca(da,
["OpAssign","OpAssignAdd","OpAssignSub","OpAssignMul","OpAssignDiv","OpAssignMod","OpAssignLShift","OpAssignSpRShift","OpAssignZfRShift","OpAssignBAnd","OpAssignBXor","OpAssignBOr"]);ca(zb,["PrefixInc","PrefixDec","PostfixInc","PostfixDec"]);ca(za,["PrefixLNot","PrefixBNot","PrefixPlus","PrefixMinus","PrefixTypeof","PrefixVoid","PrefixDelete"]);ca(Ab,[["PropId","a",P],["PropString","a",String],["PropNum","a",Number]]);ca(Ya,[["LVar","a",String],["LDot","a",t,String],["LBracket","a",t,t]]);ca(t,[["StringLit",
"a",String],["RegexpLit","a",String,Boolean,Boolean],["NumLit","a",Number],["IntLit","a",Number],["BoolLit","a",Boolean],["NullLit","a"],["ArrayLit","a",Array],["ObjectLit","a",Array],["ThisRef","a"],["VarRef","a",P],["DotRef","a",t,P],["BracketRef","a",t,t],["NewExpr","a",t,Array],["PrefixExpr","a",za,t],["UnaryAssignExpr","a",zb,Ya],["InfixExpr","a",G,t,t],["CondExpr","a",t,t,t],["AssignExpr","a",da,Ya,t],["ParenExpr","a",t],["ListExpr","a",Array],["CallExpr","a",t,Array],["FuncExpr","a",C,Array,
y]]);ca(Ra,[["CaseClause","a",t,Array],["CaseDefault","a",Array]]);ca(J,[["CatchClause","a",P,y]]);ca(Ga,[["VarDecl","a",P,C]]);ca(M,["NoInit",["VarInit",Array],["ExprInit",t]]);ca(Q,[["ForInVar",P],["ForInNoVar",P]]);ca(y,[["BlockStmt","a",Array],["EmptyStmt","a"],["ExprStmt","a",t],["IfStmt","a",t,y,y],["IfSingleStmt","a",t,y],["SwitchStmt","a",t,Array],["WhileStmt","a",t,y],["DoWhileStmt","a",y,t],["BreakStmt","a",C],["ContinueStmt","a",C],["LabelledStmt","a",P,y],["ForInStmt","a",Q,t,y],["ForStmt",
"a",M,C,C,y],["TryStmt","a",y,Array,C],["ThrowStmt","a",t],["ReturnStmt","a",C],["WithStmt","a",t,y],["VarDeclStmt","a",Array],["FunctionStmt","a",P,Array,y]]);ya("BrownPLT_JavaScript_Syntax",{Expression:t,CaseClause:Ra,Statement:y,InfixOp:G,CatchClause:J,VarDecl:Ga,JavaScript:pb,AssignOp:da,Id:P,PrefixOp:za,Prop:Ab,ForInit:M,ForInInit:Q,unId:Xa,UnaryAssignOp:zb,LValue:Ya});ca=db(Ca,qa("$_"));La=wa.LanguageDef(Za,{commentStart:"/*",commentEnd:"*/",commentLine:"//",nestedComments:false,identStart:ca,
identLetter:db(La,qa("$_")),opStart:qa("{}<>()~.,?:|&^=!+-*/%!"),opLetter:qa("=<>|&+"),reservedOpNames:["|=","^=","&=","<<=",">>=",">>>=","+=","-=","*=","/=","%=","=",";",",","?",":","||","&&","|","^","&","===","==","=","!==","!=","<<","<=","<",">>>",">>",">=",">","++","--","+","-","*","/","%","!","~",".","[","]","{","}","(",")","instanceof","in"],reservedNames:["break","case","catch","const","continue","debugger","default","delete","do","else","enum","false","finally","for","function","if","instanceof",
"in","let","new","null","return","switch","this","throw","true","try","typeof","var","void","while","with"],caseSensitive:true});var i=na(La);ya("BrownPLT_JavaScript_Lexer",{lex:i});var Ba=bb(function(){return Ba}),$=bb(function(){return $}),ga=bb(function(){return ga}),ha=bb(function(){return ha}),ka=bb(function(){return ka}),oa=ka,a=$a(P.Id,w,i.identifier);La=o("pos","<-",w)(i.reserved,"if")("test","<-",ga,"<?>","parenthesized test-expression in if statement")("consequent","<-",$,"<?>","true-branch of if statement")(o(i.reserved,
"else")("alternate","<-",$)(X,function(e){return y.IfStmt(e.scope.pos,e.scope.test,e.scope.consequent,e.alternate)}),"<|>",H(y.IfSingleStmt,"pos","test","consequent"));na=o("pos","<-",w)(i.reserved,"default")(i.colon)("statements","<-",lb,$)(H,Ra.CaseDefault,"pos","statements");wa=o("pos","<-",w)(i.reserved,"case")("condition","<-",Ba)(i.colon)("actions","<-",lb,$)(H,Ra.CaseClause,"pos","condition","actions");wa=o("pos","<-",w)(i.reserved,"switch")("test","<-",ga)("clauses","<-",i.braces,"$",lb,"$",
na,"<|>",wa)(H,y.SwitchStmt,"pos","test","clauses");Za=o("pos","<-",w)(i.reserved,"while")("test","<-",ga,"<?>","parenthesized test-expression in while loop")("body","<-",$)(H,y.WhileStmt,"pos","test","body");na=o("pos","<-",w)("statements","<-",i.braces,[lb,$])(H,y.BlockStmt,"pos","statements");Ca=o("pos","<-",w)(i.reserved,"do")("body","<-",na)(i.reserved,"while","<?>","while at the end of a do block")("test","<-",ga,"<?>","parenthesized test-expression in do loop")(Sa)(H,y.DoWhileStmt,"pos","body",
"test");L=o("pos","<-",w)(i.reserved,"continue")("pos_","<-",w)("id","<-",Lb,"pos","pos_",a)(Sa)(H,y.ContinueStmt,"pos","id");var b=o("pos","<-",w)(i.reserved,"break")("pos_","<-",w)("id","<-",Lb,"pos","pos_",a)(Sa)(H,y.BreakStmt,"pos","id"),d=o("pos","<-",w)(i.semi)(H,y.EmptyStmt,"pos"),h=o("pos","<-",w)("label","<-",Ka,o("label","<-",a)(i.colon)(X,"label"))("statement","<-",$)(H,y.LabelledStmt,"pos","label","statement"),m=o("pos","<-",w)("expr","<-",Ba)(Sa)(H,y.ExprStmt,"pos","expr"),B=Y([i.reserved,
"var",">>",la,Q.ForInVar,a],"<|>",[la,Q.ForInNoVar,a]);B=o("pos","<-",w)("init_expr","<-",Ka,o(i.reserved,"for")(i.parens,o("init","<-",B)(i.reserved,"in")("expr","<-",ka)(X,function(e){return[e.init,e.expr]})))("body","<-",$)(X,function(e){return y.ForInStmt(e.pos,e.init_expr[0],e.init_expr[1],e.body)});var u=o("pos","<-",w)("id","<-",a)("init","<-",[i.reservedOp("="),">>",la,C.Just,ka],"<|>",z(C.Nothing))(H,Ga.VarDecl,"pos","id","init"),aa=o("pos","<-",w)(i.reserved,"var")("decls","<-",u,va(tb),
i.comma)(Sa)(H,y.VarDeclStmt,"pos","decls");u=Y([i.reserved,"var",">>",la,M.VarInit,[u,va(tb),i.comma]],"<|>",[la,M.ExprInit,Ba],"<|>",z(M.NoInit));u=o("pos","<-",w)(i.reserved,"for")(i.reservedOp("("))("init","<-",u)(i.semi)("test","<-",[la,C.Just,ka],"<|>",z(C.Nothing))(i.semi)("iter","<-",[la,C.Just,Ba],"<|>",z(C.Nothing))(i.reservedOp(")"),"<?>","closing paren")("stmt","<-",$)(H,y.ForStmt,"pos","init","test","iter","stmt");var K=o("pos","<-",w)(i.reserved,"catch")("id","<-",i.parens,a)("stmt",
"<-",$)(H,J.CatchClause,"pos","id","stmt");K=o(i.reserved,"try")("pos","<-",w)("guarded","<-",$)("catches","<-",lb,K)("finally","<-",[i.reserved,"finally",">>",la,C.Just,$],"<|>",z(C.Nothing))(H,y.TryStmt,"pos","guarded","catches","finally");var Ha=o("pos","<-",w)(i.reserved,"throw")("pos_","<-",w)("expr","<-",Bb,"pos","pos_",ka)(Sa)(H,y.ThrowStmt,"pos","expr"),ba=o("pos","<-",w)(i.reserved,"return")("pos_","<-",w)("expr","<-",Lb,"pos","pos_",Ba)(Sa)(H,y.ReturnStmt,"pos","expr"),Ia=o("pos","<-",w)(i.reserved,
"with")("context","<-",ga)("stmt","<-",$)(H,y.WithStmt,"pos","context","stmt"),Ja=o("pos","<-",w)("name","<-",Ka,[i.reserved,"function",">>",a])("args","<-",i.parens,[a,va(tb),i.comma])("body","<-",na,"<?>","function body in { ... }")(H,y.FunctionStmt,"pos","name","args","body");$=Y(La,"<|>",wa,"<|>",Za,"<|>",Ca,"<|>",L,"<|>",b,"<|>",na,"<|>",d,"<|>",B,"<|>",u,"<|>",K,"<|>",Ha,"<|>",ba,"<|>",Ia,"<|>",aa,"<|>",Ja,"<|>",h,"<|>",m,"<?>","statement");La=o("pos","<-",w)(i.reserved,"this")(H,t.ThisRef,
"pos");wa=o("pos","<-",w)(i.reserved,"null")(H,t.NullLit,"pos");Za=o("pos","<-",w)("true","<-",z,true)("false","<-",z,false)([i.reserved,"true",">>",H(t.BoolLit,"pos","true")],"<|>",[i.reserved,"false",">>",H(t.BoolLit,"pos","false")]);Ca=$a(t.VarRef,w,a);L=$a(t.ArrayLit,w,i.squares(Ma(ka,i.comma)));b=o("pos","<-",w)(i.reserved,"function")("name","<-",[a,">>=",z,".",C.Just],"<|>",z,C.Nothing)("args","<-",i.parens,[a,va(tb),i.comma])("body","<-",na)(H,t.FuncExpr,"pos","name","args","body");var ub=
[["'","'"],['"','"'],["\\","\\"],["b","\u0008"],["f","\u000c"],["n","\n"],["r","\r"],["t","\t"],["v","\u000b"],["/","/"],[" "," "],["0","\u0000"]];Ib=Ib(Fa,ub);var nb=o("c","<-",qa(Ib))(X,function(e){return ic(e.c,ub)[0]}),Yb=o(D,"x")("d1","<-",ra)("d2","<-",ra)(X,function(e){return ja(Jb(""+e.d1+e.d2))}),Hb=o(D,"u")(la,[ja,".",Jb],jb([ra,ra,ra,ra]));jb=o("pos","<-",w)("str","<-",i.lexeme,"$",[D("'"),">>=",Cb],"<|>",[D('"'),">>=",Cb])(H,t.StringLit,"pos","str");ra=o("flags","<-",lb,qa("mgi"))(X,function(e){return function(k){return k(yb("g",
e.flags),yb("i",e.flags))}});Y(D("\\"),">>",Gb).resolve();sb("/");sb=function(e,k,r){return A(e,k,r)};var A=Y([D("/"),">>",z,""],"<|>",o(D("\\"))("ch","<-",Gb)("rest","<-",sb)(X,function(e){return"\\"+e.ch+e.rest}),"<|>",[$a,Va,Gb,sb]);Ta=o("pos","<-",w)(D("/"))("pat","<-",A)("flags","<-",ra)(Ta)(X,function(e){return e.flags(function(k,r){return t.RegexpLit(e.pos,e.pat,k,r)})});Oa=o("name","<-",[la,Oa(Ab.PropString),[la,function(e){return[e[0],e[1]]},jb]],"<|>",[$a,Ab.PropId,w,a],"<|>",[$a,Ab.PropNum,
w,i.decimal])(i.colon)("val","<-",oa)(X,function(e){return[e.name,e.val]});Ma=o("pos","<-",w)("props","<-",i.braces,[Oa,va(Ma),i.comma],"<?>","object literal")(H,t.ObjectLit,"pos","props");Oa=o(Ka,fb("0x"))("digits","<-",eb,qa("0123456789abcdefABCDEF"))("hex","<-",H,Jb,"digits")(X,function(e){return[true,e.hex]});eb=o("digits","<-",Ka,"$",[D("0"),">>",[eb,qa("01234567"),"<|>",z("0")]],"<*",gb,qa(".89"))("oct","<-",H,Pa,"digits")(X,function(e){return[true,e.oct]});Fb=o(qa,"eE")([D("+"),">>",i.decimal],
"<|>",[D("-"),">>",ma,va(Fb),i.decimal],"<|>",i.decimal);fa=Y(o("whole","<-",i.decimal)("mfrac","<-",fa,C.Nothing,[Ub,[D("."),">>",i.decimal]])("mexp","<-",fa,C.Nothing,[Ub,Fb])(X,function(e){return e.mfrac==C.Nothing&&e.mexp==C.Nothing?[true,e.whole]:[false,Mb(e.whole,kb(0,ea,e.mfrac),kb(0,ea,e.mexp))]}),"<|>",o("frac","<-",D("."),">>",i.decimal)("exp","<-",fa,0,Fb)(X,function(e){return[false,Mb(0,e.frac,e.exp)]}));fa=o("pos","<-",w)("isint_num","<-",i.lexeme,"$",Oa,"<|>",eb,"<|>",fa)(gb,ca,"<?>",
"whitespace")(X,function(e){var k=e.isint_num[1];return e.isint_num[0]?t.IntLit(e.pos,rb(k)):t.NumLit(e.pos,k)});ga=R(t.ParenExpr,i.parens(Ba));Y(La,"<|>",wa,"<|>",Za,"<|>",jb,"<|>",L,"<|>",ga,"<|>",ha,"<|>",fa,"<|>",Ta,"<|>",Ma,"<|>",Ca);fa=Y(La,"<|>",wa,"<|>",Za,"<|>",jb,"<|>",L,"<|>",ga,"<|>",b,"<|>",fa,"<|>",Ta,"<|>",Ma,"<|>",Ca);ha=Y(o("pos","<-",w)(i.reserved,"new")("constructor_","<-",Db,C.Nothing)("arguments","<-",[Ka,[i.parens,[ka,va(tb),i.comma]]],"<|>",z([]))(H,t.NewExpr,"pos","constructor_",
"arguments"),"<|>",fa);var ua=o("pos","<-",w)("op","<-",Pb,"$",[i.reservedOp("!"),">>",z,za.PrefixLNot],"<|>",[i.reservedOp("~"),">>",z,za.PrefixBNot],"<|>",[Ka,[i.lexeme,"$",D("-"),">>",gb,D("-")],">>",z,za.PrefixMinus],"<|>",[Ka,[i.lexeme,"$",D("+"),">>",gb,D("+")],">>",z,za.PrefixPlus],"<|>",[i.reserved,"typeof",">>",z,za.PrefixTypeof],"<|>",[i.reserved,"void",">>",z,za.PrefixVoid],"<|>",[i.reserved,"delete",">>",z,za.PrefixDelete])(function(e,k,r){var n=e.op,F;if(n.Nothing)F=Ua;if(n.Just)F=o("innerExpr",
"<-",ua)(X,function(S){return t.PrefixExpr(e.pos,n[0],S.innerExpr)});return F(e,k,r)});gb=[[V("*",G.OpMul),V("/",G.OpDiv),V("%",G.OpMod)],[V("+",G.OpAdd),V("-",G.OpSub)],[V("<<",G.OpLShift),V(">>",G.OpSpRShift),V(">>>",G.OpZfRShift)],[V("<",G.OpLT),V("<=",G.OpLEq),V(">",G.OpGT),V(">=",G.OpGEq),V("instanceof",G.OpInstanceof),V("in",G.OpIn)],[V("&",G.OpBAnd)],[V("^",G.OpBXor)],[V("|",G.OpBOr)],[V("&&",G.OpLAnd)],[V("||",G.OpLOr)],[V("==",G.OpEq),V("!=",G.OpNEq),V("===",G.OpStrictEq),V("!==",G.OpStrictNEq)]].reverse();
ab=ab(mb(gb,ua),"simple expression");var Rb=o("p","<-",w)("e","<-",ib,C.Nothing)(function(e,k,r){return Eb(e.p,e.e)(e,k,r)}),Ua=fc(w,function(e){function k(Z){return qb(i.reservedOp("++"),la(ta(e,"PostfixInc"),Eb(e,Z)))}function r(Z){return qb(i.reservedOp("--"),la(ta(e,"PostfixDec"),Eb(e,Z)))}var n=qb(i.reservedOp("++"),la(ta(e,"PrefixInc"),Rb)),F=qb(i.reservedOp("--"),la(ta(e,"PrefixDec"),Rb)),S=fc(ib(C.Nothing),function(Z){return Nb(db(k(Z),db(r(Z),z(Z))),z(Z))});return db(n,db(F,S))});mb=o(i.reservedOp("?"))("l",
"<-",oa)(i.colon)("r","<-",oa)(X,function(e){return[e.l,e.r]});Pb=o("e","<-",ab)("e_","<-",Pb,mb)(function(e,k,r){var n=e.e_,F=e.e,S;if(n.Nothing)S=z(e.e);if(n.Just){var Z=n[0][0],cb=n[0][1];S=o("p","<-",w)(X,function(O){return t.CondExpr(O.p,F,Z,cb)})}return S(e,k,r)});ab=Y([i.reservedOp("="),">>",z,da.OpAssign],"<|>",[i.reservedOp("+="),">>",z,da.OpAssignAdd],"<|>",[i.reservedOp("-="),">>",z,da.OpAssignSub],"<|>",[i.reservedOp("*="),">>",z,da.OpAssignMul],"<|>",[i.reservedOp("/="),">>",z,da.OpAssignDiv],
"<|>",[i.reservedOp("%="),">>",z,da.OpAssignMod],"<|>",[i.reservedOp("<<="),">>",z,da.OpAssignLShift],"<|>",[i.reservedOp(">>="),">>",z,da.OpAssignSpRShift],"<|>",[i.reservedOp(">>>="),">>",z,da.OpAssignZfRShift],"<|>",[i.reservedOp("&="),">>",z,da.OpAssignBAnd],"<|>",[i.reservedOp("^="),">>",z,da.OpAssignBXor],"<|>",[i.reservedOp("|="),">>",z,da.OpAssignBOr]);ka=oa=o("p","<-",w)("lhs","<-",Pb)(o("op","<-",ab)("lhs","<-",bb,function(e){e.p=e.scope.p;return Eb(e.scope.p,e.scope.lhs)})("rhs","<-",bb,
function(){return oa})(H,t.AssignExpr,"p","op","lhs","rhs"),"<|>",X,"lhs");Ba=$a(t.ListExpr,w,Qb(oa,i.comma));H=o(i.whiteSpace)($a,pb.Script,w,lb($));ya("BrownPLT_JavaScript_Parser",{parseScript:H,parseExpression:ka,parseSimpleExpr_:fa,parseBlockStmt:na,parseStatement:$,assignExpr:oa})})();(function(){namespace("BrownPLT_JavaScript");importSubmodules("BrownPLT_JavaScript",["Lexer","Syntax","Parser"])})();(function(){function y(){pb(P,y.toString(),function(G){Xa(G.state.length?"failed":"ok");typeof console!=
"undefined"&&console.log(G.ast)})}var pb=NS.Text_Parsec_Prim.run,P=NS.BrownPLT_JavaScript.parseScript,Xa=typeof console!="undefined"?console.log:typeof print!="undefined"?print:function(G){alert(G)};y()})()})();
