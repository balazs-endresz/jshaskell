/*

 JSParsec - A parser combinator library for JavaScript

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.


 The initial implementation of some combinators,
 and the memoization technique is derived from:
 http://www.bluishcoder.co.nz/2007/10/javascript-parser-combinators.html

 Most functions should behave like their counterparts in Parsec 3:
 http://www.haskell.org/haskellwiki/Parsec

 ------------------------------------------------------------


 JSHaskell - Some Haskell language features for JavaScript

 http://code.google.com/p/jshaskell/

 Copyright (c) 2010 Balazs Endresz (balazs.endresz@gmail.com)
 Dual licensed under the MIT and GPL licenses.

 ------------------------------------------------------------

*/
(function(){(function(){function ca(a,c){return ka[a]=c||{}}function cb(a,c){for(var h=ka[a],k=0,m=c.length;k<m;++k){var u=ka[a+"_"+c[k]];for(var w in u)h[w]=u[w]}}function Z(a){return db.call(a)=="[object Array]"}function J(a){return a!==fa}function eb(a,c){return a===c}function fb(a,c){return a!==c}function yb(a,c){return a<c}function gb(a,c){return a<=c}function v(a,c){return a>c}function ta(a,c){return a>=c}function A(a){return-a}function D(a){return a===true?false:a===false?true:U(D)}function la(a){var c=
a.constructor;if(c)return c;a=typeof a;return a=="string"?String:a=="number"?Number:a=="boolean"?Boolean:a=="function"?Function:fa}function hb(a){function c(){var h=ma(arguments);return h.length>=(a._length===fa?a.length:a._length)?a.apply(null,h):function(){return c.apply(null,h.concat(ma(arguments)))}}return c}function zb(a){return function(){return a}}function ib(a){var c=ma(arguments,1);return function(){return a.apply(null,c)}}function jb(){function a(c){return!c?[]:[[c.name||c._name||c,c.arguments]].concat(a(c.caller))}
return a(arguments.callee.caller)}function U(a){a=(a instanceof Function?a.name||a._name:null)||a||"Unspecified error";var c=new Error(a);try{c.stackTrace=jb()}catch(h){}c.message=a;throw c;}function kb(a,c){for(var h in c)a[h]=c[h];return a}function Ja(a,c){if(c.indexOf)return c.indexOf(a);var h=c.length;if(!h)return-1;for(var k=0;k<h;k++)if(c[k]===a)return k;return-1}function lb(a,c){if(c.lastIndexOf)return c.lastIndexOf(a);var h=c.length;if(!h)return-1;for(h=h-1;h>-1;--h)if(c[h]===a)return h;return-1}
function H(a){if(a.sort)return a.sort();return ma(a).sort().join("")}function Nb(a,c){for(var h=[],k=0,m=c.length;k<m;++k)h[k]=a(c[k]);return h}function Ab(a,c){for(var h=[],k=0,m=c.length;k<m;++k)a(c[k])&&h.push(c[k]);return h}function Bb(a,c){return function(){return a(c.apply(null,arguments))}}function Ra(a,c){return function(h){var k=ma(arguments,1);k.unshift(c(h));return a.apply(null,k)}}function Sa(a){return function(c,h){return a(h,c)}}function Cb(a,c){if(typeof a=="string"&&typeof c=="string")return a+
c;return[a].concat(c)}function Db(a,c){if(typeof a=="string"&&typeof c=="string")return a+c;return a+c.join("")}function na(a){return!a.length}function Ta(a,c){var h=c.constructor==Array;return a.constructor==Array?a.concat(h?c:c.split("")):a.concat(h?c.join(""):c)}function Eb(a,c){return(c.indexOf?c.indexOf(a):Ja(a,c))!=-1}function Ua(a){return parseInt(a.join?a.join(""):a,16)}function ua(a){return parseInt(a.join?a.join(""):a,8)}function va(a){a=parseInt(a,16);return isNaN(a)?U(va):a}function Ka(a,
c){return{indexOf:function(h){return h>=a&&h<=c?true:-1},toString:function(){return"range("+a+", "+c+")"}}}function Va(a,c){function h(){try{var m=c;do a=a()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()();while(--m);setTimeout(h,1)}catch(u){}}if(!c||c==Infinity){try{for(;a=a()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()(););
}catch(k){}return a}h()}function Fb(a){return["l",a]}function Aa(a){return["r",a]}function mb(a){return["x",a]}function nb(a){if(a)if(!a._String){var c=La[a];if(a._Op&&!c)return"l";return c&&(c.fixity[0]||"l")}}function Ob(a){if(a)if(!a._String){var c=La[a];if(a._Op&&!c)return 9;return c&&(J(c.fixity[1])?c.fixity[1]:9)}}function ob(){}function pb(a,c,h){var k;if(a[c]._Op){delete a[c]._Op;k=a[c]}else k=La[a[c]].func;k=k(a[c-1],a[c+1]);a.splice(c-1,3,k);return $(a,h)}function Gb(a){if(typeof a=="string"){a=
new String(a);a._String=true;return a}else{a._Array=true;return a}}function Ma(a){a._Op=true;return a}function $(a,c){a=Na(function(E){if(!E)return E;if(E._Array){delete E._Array;return E}return E.constructor==Array?$(E,c):E.CallStream?E.resolve(c):E},a);if(c)a=Na(function(E){return E instanceof ob?c:E},a);for(var h=[],k=[],m=0,u=a.length;m<u;++m){var w=a[m],R=false;if(La[w])R=true;if(w&&w._String){R=false;w=w.toString()}if(w&&w._Op)R=true;if(!R&&m!=u-1)h.push(w);else{m==u-1&&h.push(w);h=h.length>
1?h[0].apply(null,h.slice(1)):h[0];k.push(h);m!=u-1&&k.push(w);h=[]}}a=k;k=Na(nb,a);u=Na(Ob,a);w=Hb(J,u).sort().pop();m=Ja(w,u);u=lb(w,u);return k[m]=="l"?pb(a,m,c):k[u]=="r"?pb(a,u,c):k[m]=="x"?pb(a,m,c):a[0]}function Oa(a){return function(){function c(){return m.apply(null,arguments)}function h(){return(u?m:h.resolve()).apply(null,arguments)}var k=arguments,m,u;h.resolve=function(w){if(u)return m;m=$(k,w||c);k=null;u=true;return m};h.CallStream=true;h.constructor=a;return h}}function L(){return $(ma(arguments))}
function Ib(a){this.scope=a}function Pb(a){return function(){function c(){return m.apply(null,arguments)}function h(w){if(u||w instanceof Ib)return(u?m:h.resolve()).apply(null,arguments);k.push($(arguments,c));return h}var k=[],m,u;k.push($(arguments,c));h.resolve=function(){if(u)return m;m=a.do_.apply(null,k);u=true;k=null;return m};h.CallStream=true;h.constructor=a._type;return h}}function Ba(){this.keys=[];this.values=[]}function da(a,c){var h={};h._context=[];h._name=a;h._dict=new Ba;h.context=
function(){this._context=ma(arguments);delete h.context;return this};h.types=function(k){this._fnTypes=k;delete h.types;return this};h.impl=function(k){this._default=k;for(var m in h._fnTypes)(function(u,w){h[u]=w!==fa&&w.constructor!=Array?(typeof k=="function"?k():k)[u]:function(){var R=arguments,E;if(w===fa||w===Ca)U("There's no type signature for "+h._name+"."+u+", it can be accessed only by: getInstance("+h._name+", SomeType)."+u);var P,Da=Hb(function(V,oa){oa=w[oa];if(P||oa==Ca)return P=true;
V=la(V);if(oa==c){E=E||V;return E==V}else return V==oa},R);!P&&Da.length!=w.length-1&&U("Type error in "+h._name+"."+u);(Da=h._dict.get(E))||U("No "+h._name+" instance for "+(E.name||E._name));return Da[u].apply(null,R)}})(m,h._fnTypes[m]);delete h.impl;return this};return h}function S(a,c,h){Na(function(w){if(!w._dict.get(c))throw"No "+(w._name||"")+" instance for "+(c.name||c._name);},a._context);var k={};k._type=c;a._dict.put(c,k);h=typeof h=="function"?h(k):h||{};var m=a._default;m=typeof m==
"function"?m(k):m;for(var u in a._fnTypes)k[u]=h[u]||m[u];return k}function ga(a,c){return a._dict.get(c)}function W(a,c,h){return a._dict.get(la(h))[c]}function e(a,c){return c?c[a]:function(h){return h[a]}}function f(){}function j(){}function r(a){return function(){var c=[],h=this._recordset;if(h&&h.constructor!=Array){for(var k in h){var m=a?h[k].name||h[k]:this[k];if(!a&&m instanceof Function)m=m.constructor!=Function?m.constructor.name:"Function("+m.name+")";c.push(k+(a?" :: ":" = ")+m)}h=replicate(this._dataConstructor.length+
2," ").join("");c="{"+c.join("\n"+h+",")+"\n"+h+"}"}else{for(k=0;k in this;k++)c.push(a?h[k].name||h[k]:this[k]);c=c.join(" ")}return"("+this._dataConstructor+(c?" ":"")+c+")"}}function K(a,c,h,k,m){U("Type error: expecting "+a.name+" instead of "+c.name+" in the argument '"+h+"' of "+k+"."+m)}function pa(a,c){function h(E,P){function Da(ac,Wa){var qa=ac instanceof f,ra=new a,Xa,Ea;ra.constructor=a;ra._recordset=V&&P[0]||P;ra._dataConstructor=E;ra[E]=true;if(qa)for(var sa in Wa){qa=Wa[sa];V||U("Records are not defined for "+
k+"."+E);sa in oa||U("The accessor '"+sa+"' is not defined for "+k+"."+E);Ea=oa[sa];if(typeof Ea!="string"){Xa=la(qa);Xa!=Ea&&K(Ea,Xa,sa,k,E)}ra[sa]=qa;ra[Pa[sa]]=qa}else{sa=arguments;for(var Fa=0,Ya=sa.length;Fa<Ya;++Fa){qa=sa[Fa];Ea=P[Fa];if(typeof Ea!="string"){Xa=la(qa);Xa!=Ea&&K(Ea,Xa,Fa,k,E)}ra[Fa]=qa;if(V)ra[qb[Fa]]=qa}}ra.update=function(Jb){var Qb={};for(var wa in oa)Qb[wa]=wa in Jb?Jb[wa]:this[wa];return Da(bc,Qb)};return ra}var V=P&&typeof P[0]=="object",oa=V&&P[0];if(V){var Za=0,xa,Pa=
{},qb={};for(xa in oa){var Kb=xa.charAt(0);if(Kb=="_"||Kb==Kb.toUpperCase())throw k+"."+R+"."+xa+": record names can't start with underscore or uppercase letters";if(xa in{update:1})throw k+"."+R+"."+xa+": record name is invalid";Pa[xa]=Za;qb[Za]=xa;Za++}}return Da}var k=a.name;if(a._constructors)throw"Type constructor has been already defined: '"+k+"'";a._constructors=c;a.prototype=new j;for(var m=0,u=c.length;m<u;++m){var w=typeof c[m]!="object",R=w?c[m]:c[m][0];if(R in a)throw"The name of the data constructor ("+
k+"."+R+") is invalid!";a[R]=w?h(R)():h(R,ma(c[m],1));if(!w)a[R]._length=c[m].length-1}}var M=function(){return this}()||window,ka=M.NS||(M.NS={}),fa,db={}.toString,rb=[].slice,ha=[].map,Rb=[].filter;(function(){return this}).toString().indexOf("this");(function(){var a={9:1,d:1,b:1,0:1,a:1,c:1},c=[9,"d","b",0,"a","c"],h=0;for(var k in a)if(k!=c[h++])return false;return true})();M.global=M;M.namespace=ca;M.importSubmodules=cb;M=function(a){return a};var cc=hb(function(a,c){return a(c)}),ma="a"[0]?
function(a,c){return rb.call(a,c||0)}:function(a,c){if(typeof a=="string"){a=a.split("");if(!c)return a}return rb.call(a,c||0)},Na=ha?function(a,c){return ha.call(c,a)}:function(a,c){for(var h=[],k=0,m=c.length;k<m;++k)h[k]=a(c[k],k,c);return h},Hb=Rb?function(a,c){return Rb.call(c,a)}:function(a,c){for(var h=[],k=0,m=c.length;k<m;++k)a(c[k],k,c)&&h.push(c[k]);return h};ca("Haskell_Main",{curry:hb,const_:zb,isArray:Z,isDefined:J,slice:ma,map:Nb,imap:Na,filter:Ab,ifilter:Hb,indexOf:Ja,lastIndexOf:lb,
isort:H,compose:Bb,compose1:Ra,call:cc,id:M,flip:Sa,cons:Cb,consJoin:Db,negate:A,null_:na,elem:Eb,digitToInt:va,range:Ka,extend:kb,namespace:ca,toInteger:parseInt,fromInteger:M,fromIntegral:M,readHex:Ua,readOct:ua,chr:String.fromCharCode,round:Math.round,typeOf:la,strictEq:eb,strictNe:fb,lt:yb,le:gb,gt:v,ge:ta,not:D,negate:A,evalThunks:Va});var La={$:{func:cc,fixity:Aa(0)},".":{func:Ra,fixity:Aa(9)},":":{func:Cb,fixity:Aa(5)},"++":{func:Ta,fixity:Aa(5)}};M=new ob;ca("Haskell_Expression",{operators:La,
infix:mb,infixl:Fb,infixr:Aa,op:Ma,no:Gb,resolve:$,recurse:M,Recurse:ob,exl:Oa,exs:L});ca("Haskell_Do",{createDo:Pb,Scope:Ib});Ba.prototype.put=function(a,c){this.keys.push(a);this.values.push(c)};Ba.prototype.get=function(a){a=Ja(a,this.keys);if(a!=-1)return this.values[a]};var Ca={};ca("Haskell_TypeClass",{typeclass:da,VARARG:Ca,instance:S,getInstance:ga,asTypeOf:W});var bc=new f;j.prototype.toString=r();j.prototype.dataConstructorToString=r(true);j.prototype.update=ib(U);ca("Haskell_DataType",
{data:pa,ADT:j,record:bc,accessor:e,accessors:{}})})();(function(){namespace("Haskell");importSubmodules("Haskell",["Main","DataType","TypeClass","Expression","Do"])})();(function(){function ca(e){e.constructor=da["Tuple"+e.length];return e}function cb(){}function Z(){}function J(){}function eb(){}function fb(e){var f=stringAsArray||typeof arr!="string"?e[0]:e.charAt(0);e=Ua(e,1);var j=[f,e];j.head=f;j.tail=e;j.constructor=da.Tuple2;return j}function yb(e,f){var j=f.length;if(!j)return Z.Nothing;
for(var r=Ib(S,Aa(f[0])),K=0;K<j;++K)if(r.eq(f[K],e))return Z.Just(K);return Z.Nothing}function gb(e,f){var j=f.length;if(!j)return Z.Nothing;for(var r=0;r<j;++r)if(f[r][0]===e)return Z.Just(f[r][1]);return Z.Nothing}function v(e){function f(j,r){j=ga.compare(j,r);return j.LT?-1:j.GT?1:j.EQ?0:error(v)}if(e.sort)return e.sort(f);return Ua(e).sort(f).join("")}function ta(e){function f(j,r){var K=j.constructor==Array;x=K?j[0]:j.charAt(0);xs=K?j.slice(1):j.substr(1);return!j.length?[]:Va(x,r)?f(xs,r):
Ka(x,f(xs,Ka(x,r)))}return f(e,[])}function A(e,f,j){if(j.Nothing)return e;if(j.Just)return f(j[0])}function D(e,f){return e===f?J.EQ:e<=f?J.LT:J.GT}function la(e,f){if(f.length)if(e(f[0])){e=la(e,Ua(f,1));f=[Ka(f[0],e[0]),e[1]]}else f=[[],f];else f=[f,f];f.constructor=da.Tuple2;return f}function hb(e){return e[0]}function zb(e){return e[1]}function ib(e){return function(f){return e(f[0],f[1])}}function jb(e,f,j){return e(j)?j:jb(e,f,f(j))}function U(e){return function(){return rhs(U(e))}}function kb(e){return function(f){return f(f)}(function(f){return function(){return e(f(f)).apply(null,
arguments)}})}function Ja(e){return/^\s$/.test(e)}function lb(e){return e.toUpperCase()==e}function H(e){return e.toLowerCase()==e}function Nb(e){return/^\w$/.test(e)}function Ab(e){return/^\w$/.test(e)&&/^\D$/.test(e)}function Bb(e){return/^\d$/.test(e)}function Ra(e){return/^[0-9A-Fa-f]$/.test(e)}function Sa(e){return/^[0-7]$/.test(e)}function Cb(e,f,j){for(var r=0,K=j.length;r<K;++r)f=e(f,j[r]);return f}function Db(e,f,j){for(var r=j.length-1;r>-1;--r)f=e(j[r],f);return f}function na(e,f){for(var j=
[],r=0,K=Math.min(e.length,f.length);r<K;++r)j[r]=[e[r],f[r]];return j}function Ta(e,f){for(var j=[],r=0;r<e;++r)j[r]=f;return j}var Eb=NS.Haskell.const_,Ua=NS.Haskell.slice,ua=NS.Haskell.map,va=NS.Haskell.imap,Ka=NS.Haskell.cons,Va=NS.Haskell.elem,Fb=NS.Haskell.namespace,Aa=NS.Haskell.typeOf,mb=NS.Haskell.strictEq,nb=NS.Haskell.strictNe,Ob=NS.Haskell.lt,ob=NS.Haskell.le,pb=NS.Haskell.gt,Gb=NS.Haskell.ge,Ma=NS.Haskell.data,$=NS.Haskell.typeclass,Oa=NS.Haskell.VARARG,L=NS.Haskell.instance,Ib=NS.Haskell.getInstance,
Pb=NS.Haskell.createDo,Ba=NS.Haskell.Scope,da={};va(function(e){var f="Tuple"+e;da[f]=function(){};da[f]._name=f;da["tuple"+e]=function(j){j.constructor=da[f];return j}},[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]);da.tuple=ca;Ma(cb,["Unit"]);Ma(Z,[["Just","a"],"Nothing"]);Ma(J,["LT","EQ","GT"]);Ma(eb,[["Left","a"],["Right","b"]]);var S=$("Eq","a").types({eq:["a","a",Boolean],ne:["a","a",Boolean]}).impl(function(e){return{eq:function(f,j){return!e.ne(f,j)},ne:function(f,j){return!e.eq(f,j)}}});L(S,Number,
{eq:mb,ne:nb});L(S,String,{eq:mb,ne:nb});L(S,Boolean,{eq:mb,ne:nb});L(S,RegExp,{eq:function(e,f){return e.source===f.source&&e.global===f.global&&e.ignoreCase===f.ignoreCase&&e.multiline===f.multiline}});L(S,Array,{eq:function(e,f){var j=e.length;if(j!=f.length)return false;for(var r=0;r<j;++r)if(!S.eq(e[r],f[r]))return false;return true}});L(S,Object,{eq:function(e,f){var j,r={};for(j in e)r[j]=true;for(j in f)r[j]=true;for(j in r)if(!S.eq(e[j],f[j]))return false;return true}});L(S,J,{eq:function(e,
f){return e.EQ&&f.EQ?true:e.LT&&f.LT?true:e.GT&&f.GT?true:false}});var ga=$("Ord","a").context(S).types({compare:["a","a",J],"<":["a","a",Boolean],"<=":["a","a",Boolean],">":["a","a",Boolean],">=":["a","a",Boolean],max:["a","a","a"],min:["a","a","a"]}).impl(function(e){return{compare:function(f,j){return S.eq(f,j)?J.EQ:e["<="](f,j)?J.LT:J.GT},"<":function(f,j){return e.compare(f,j).LT?true:false},"<=":function(f,j){return e.compare(f,j).GT?false:true},">":function(f,j){return e.compare(f,j).GT?true:
false},">=":function(f,j){return e.compare(f,j).LT?false:true},max:function(f,j){return e["<="](f,j)?j:f},min:function(f,j){return e["<="](f,j)?f:j}}});L(ga,Boolean,{compare:function(e,f){return e===true&&f===false?J.LT:e===false&&f===true?J.GT:J.EQ}});L(ga,Number,{compare:function(e,f){return e===f?J.EQ:e<=f?J.LT:J.GT},"<":Ob,"<=":ob,">":pb,">=":Gb,max:function(e,f){return e<=f?f:e},min:function(e,f){return e<=f?e:f}});L(ga,J,{"<=":function(e,f){return e.LT?true:f.LT?false:e.EQ?true:f.EQ?false:e.GT&&
f.GT?true:error()}});va=$("Functor","f").types({fmap:[Function,"f","f"],"<$":["a","f","f"]}).impl(function(e){return{"<$":function(f,j){return e.fmap(Eb(f),j)}}});Oa=$("Monad","m").types({">>=":["m",Function,"m"],">>":["m","m","m"],return_:["a","m"],fail:[String,"m"],do_:Oa,do$:Oa,run:Oa}).impl(function(e){return{">>":function(f,j){f=e[">>="](f,Eb(j));f.constructor=e._type;return f},fail:function(f){return error(f)},do_:function(){function f(K){for(var pa=new Ba(K),M=1,ka=j.length,fa=j[0];M<ka;++M)fa=
r(fa,j[M]);M=_slice.call(arguments,1);M.unshift(pa);return fa.apply(null,M)}var j=arguments,r=e[">>"];f.constructor=e._type;return f},run:function(f){var j=Ua(arguments,1);j.unshift(new Ba);return f.apply(null,j)},do$:Pb(e)}});var W=$("Show","a").types({show:["a",String]}).impl({show:function(e){return e.toString()}});L(W,Number);L(W,Boolean);L(W,RegExp);L(W,Function,{show:function(e){var f=e.name||e._name||"\u03bb";if(e.constructor)return f+" :: "+e.constructor.name;e=(e=e.toString().match(/\([^\)]*\)/))&&
e[0]||"";return f+e}});L(W,String,{show:function(e){return'"'+e.toString()+'"'}});L(W,Array,{show:function(e){return typeof e[0]==String?'"'+e.join("")+'"':"["+ua(W.show,e).join(", ")+"]"}});L(W,Object,{show:function(e){var f=[];for(var j in e)f.push("  "+j+": "+W.show(e[j]));return"{\n"+e.join(",\n")+"\n}"}});Fb("Prelude",{Unit:cb,Tuple:da,Maybe:Z,Ordering:J,Either:eb,Eq:S,Ord:ga,Functor:va,Monad:Oa,Show:W,foldl:Cb,foldr:Db,zip:na,replicate:Ta,sort:v,nub:ta,maybe:A,lookup:gb,span:la,elemIndex:yb,
uncons:fb,compare:D,fst:hb,snd:zb,uncurry:ib,until:jb,fix:kb,fix_:U,isSpace:Ja,isUpper:lb,isLower:H,isAlpha:Ab,isAlphaNum:Nb,isDigit:Bb,isHexDigit:Ra,isOctDigit:Sa})})();(function(){function ca(b,d){this.input=b;this.index=d||0;this.length=b.length-this.index;this.cache={};return this}function cb(b){return new ca(b)}function Z(b){return function(d,g,l){return l({ast:null,success:false,expecting:{unexpected:b}})}}function J(b){return function(d,g,l){return l({success:false,expecting:b})}}function eb(b,
d,g){return g({success:false})}function fb(b){return typeof b=="string"?Ga(b):r(b)?V(b):b}function yb(b,d,g,l,o){var p=d instanceof ca?d:cb(d);h(function(){return b(new xa,p,function(n){n.state=p;delete n.index;delete n.length;if(n.success){delete n.error;delete n.expecting}else{n.error=gb(n.expecting,n.state);l&&l(n.error)}g(n)})},o)}function gb(b,d,g,l){g=g===undefined?d.index:g;if(typeof b=="string"){var o=d.input.split("\n"),p=o.length,n=d.input.substr(g).split("\n").length;p=p-n+1;o=g-o.splice(0,
p-1).join("\n").length;d=l||d.input.substr(g,b.length).substr(0,6);return'Unexpected "'+(d.length?d:"end of input")+(l?"":'", expecting "'+b)+'" at line '+p+" char "+o}if(r(b)){b=pa(function(q){return typeof q=="object"?q.expecting:q},b);return gb(b.join('" or "'),d)}else if(typeof b=="object")return gb(b.expecting,d,b.at,b.unexpected)}function v(){}function ta(b,d){return function(g,l,o){return function(){return b(g,l,function(p){return p.success?function(){return d(p.ast)(g,l,o)}:o(p)})}}}function A(b,
d){if(b=="scope")throw"Can't use 'scope' as an identifier!";return function(g,l,o){return function(){return d(g,l,function(p){if(p.success)g[b]=p.ast;return o(p)})}}}function D(b,d){d&&K(arguments);return function(g,l,o){return function(){return function(){var p;if(typeof b=="string"){if(!(b in g))throw'Not in scope: "'+b+'"';p=g[b]}else p=b(g);return o({ast:p,success:true})}}}}function la(b){var d=K(arguments,1);return function(g){return b.apply(null,pa(function(l){return g[l]},d))}}function hb(b,
d,g){return g({ast:d.index,success:true})}function zb(b){var d=typeof b;return function(g,l,o){l.scrollTo(d=="string"?g[b]:b);return o({success:true})}}function ib(b){return function(d,g,l){return l({ast:b,success:true})}}function jb(b,d){return s(A("a",b),A("b",d),D(function(g){return g.a(g.b)}))}function U(b,d){return s(A("x1",d),ia(b,"x1"))}function kb(b,d,g){return s(A("x1",d),A("x2",g),ia(b,"x1","x2"))}function Ja(b,d,g,l){return s(A("x1",d),A("x2",g),A("x3",l),ia(b,"x1","x2","x3"))}function lb(b,
d){return s(A("a",b),d,D("a"))}function H(b,d){function g(l,o,p){return function(){return b(l,o,function(n){function q(y){var G=y.expecting;if(G)if(G.constructor==Array)C=C.concat(G);else C.push(G);y.expecting=y.success?aa:C}var C=[];q(n);return n.ast!==aa?function(){return p(n)}:function(){return d(l,o,function(y){q(y);return p(y)})}})}}g.constructor=v;return g}function Nb(){var b=pa(fb,arguments);return function(d,g,l){for(var o=1,p=b.length,n=b[0];o<p;++o)n=H(n,b[o]);return n(d,g,l)}}function Ab(b){return function(d,
g,l){function o(C){return function(y,G,X){return function(){return C(y,G,function(O){p++;if(!O.success)return X(O);O.ast!==aa&&n.push(O.ast);return p<q?o(b[p])(y,G,X):X(O)})}}}var p=0,n=[],q=b.length;return function(){return o(b[p])(d,g,function(C){var y=C.success;return l({ast:n,success:y,expecting:y?aa:C.expecting})})}}}function Bb(b){return function(d){return function(g,l,o){function p(C){return function(y,G,X){return function(){return C(y,G,function(O){if(!O.success)return X(O);n=true;O.ast!==
aa&&q.push(O.ast);return p(C)(y,G,X)})}}}var n=false,q=[];return function(){return p(d)(g,l,function(C){var y=!b||n&&b;return o({ast:y?q:aa,success:y,expecting:y?aa:C.expecting})})}}}}function Ra(b){return function(d){var g=vc++,l=function(o,p,n){o=p.index;var q=p.getCached(g);if(q!==aa)return n(q);q=b(d,p,o);p.putCached(g,o,q);return n(q)};l.constructor=v;return l}}function Sa(b){return function(d,g){var l=vc++,o=function(p,n,q){var C=n.index,y=n.getCached(l);if(y!==aa)return q(y);return function(){return d(p,
n,function(G){G=b(g,G,n,C);n.putCached(l,C,G);return q(G)})}};o.constructor=v;return o}}function Cb(b){return function(d,g,l){return b(d)(d,g,l)}}function Db(b){function d(g,l){return s(A("x",g),A("xs",l),D(la(ha,"x","xs")))}return Wa(d,z([]),b)}function na(b){return Wa(H,ic,b)}function Ta(b,d){return H(d,z(b))}function Eb(b){return Ta(Pa.Nothing,U(Pa.Just,b))}function Ua(b){return H(s(b,z(null)),z(null))}function ua(b,d,g){return s(b,A("x",g),d,D("x"))}function va(b){return s(b,$a(b))}function Ka(b,
d){return H(Va(b,d),z([]))}function Va(b,d){return s(A("x",b),A("xs",sb(s(d,b))),ia(ha,"x","xs"))}function Fb(b,d){return s(A("x",b),H(s(d,A("xs",function(g,l,o){return Aa(b,d)(g,l,o)}),D(function(g){return ha(g.scope.x,g.xs)})),D(function(g){return[g.x]})))}function Aa(b,d){return H(Fb(b,d),z([]))}function mb(b,d){return Sb(s(A("x",b),d,D("x")))}function nb(b,d){return sb(s(A("x",b),d,D("x")))}function Ob(b,d){return b<=0?z([]):Db(ra(b,d))}function ob(b,d,g){return H(Ma(b,d),z(g))}function pb(b,
d,g){return H(Gb(b,d),z(g))}function Gb(b,d){function g(l){var o=s(A("f",d),A("y",b),function(p,n,q){return g(p.f(l,p.y))(p,n,q)});return H(o,z(l))}return ta(b,g)}function Ma(b,d){function g(o){var p=s(A("f",d),A("y",l),D(function(n){return n.f(o,n.y)}));return H(p,z(o))}var l=ta(b,g);return l}function $(b,d,g){b=d.at(0);if(b.length){d.scroll(1);return g(make_result(b))}return g(_fail("anyToken"))}function Oa(b,d,g){return g(make_result(aa,!d.length,d.length?"end of input":aa))}function L(b){return ja(H(ta(ja(b),
Z),z(null)))}function Ib(b,d){function g(o,p,n){return l(o,p,n)}var l=H(s(d,z([])),s(A("x",b),A("xs",g),ia(ha,"x","xs")));return l}function Pb(b){return s(A("state",wc),A("x",b),xc("state"),D("x"))}function Ba(){}function da(){}function S(b,d){function g(n,q){return function(C,y,G){return n(C[q])(C,y,G)}}function l(n,q){var C=n[0],y=q[0],G=q[1],X=q[2],O=q[3];q=q[4];if(n.Infix){var ba=n[1];if(ba.AssocNone)return[y,G,ha(C,X),O,q];if(ba.AssocLeft)return[y,ha(C,G),X,O,q];if(ba.AssocRight)return[ha(C,
y),G,X,O,q]}if(n.Prefix)return[y,G,X,ha(C,O),q];if(n.Postfix)return[y,G,X,O,ha(C,q)]}function o(n,q){return ja(s(q,yc("ambiguous use of a "+n+" associative operator")))}function p(n,q){function C(T){return t(B("f","<-",dc)("y","<-",B("z","<-",Lb)(g,y,"z"))(D,function(ya){return ya.f(T,ya.y)}),"<|>",Tb,"<|>",Ub)}function y(T){return H(C(T),z(T))}function G(T){return t(B("f","<-",ec)("y","<-",Lb)(function(ya,fc,jc){return X(ya.f(T,ya.y))(ya,fc,jc)}),"<|>",Vb,"<|>",Ub)}function X(T){return H(G(T),z(T))}
function O(T){return B("f","<-",Wb)("y","<-",Lb)(Vb,"<|>",Tb,"<|>",Ub,"<|>",D,function(ya){return ya.f(T,ya.y)})}var ba=Wa(l,[[],[],[],[],[]],q),kc=ba[1],lc=ba[2],tb=ba[3];q=ba[4];var dc=na(ba[0]),ec=na(kc),Wb=na(lc);ba=ub(na(tb),"");q=ub(na(q),"");var Vb=o("right",dc),Tb=o("left",ec),Ub=o("non",Wb);q=H(q,z(db));ba=H(ba,z(db));var Lb=B("pre","<-",ba)("x","<-",n)("post","<-",q)(D,function(T){return T.post(T.pre(T.x))});return B("x","<-",Lb)(g,C,"x","<|>",g,G,"x","<|>",g,O,"x","<|>",D,"x","<?>","operator").resolve()}
return ac(p,d,b)}function ga(){}function W(){}function e(b){function d(i){return g(Ga(i))}function g(i){return s(A("x",i),zc,D("x"))}function l(i,F,N){return Ac(i,F,N)}function o(i,F,N){return Bc(i,F,N)}function p(i,F,N){return mc(i,F,N)}function n(i){return ua(d("("),d(")"),i)}function q(i){return ua(d("{"),d("}"),i)}function C(i){return ua(d("<"),d(">"),i)}function y(i){return ua(d("["),d("]"),i)}function G(i){return Ka(i,nc)}function X(i){return Ka(i,oc)}function O(i){return Va(i,nc)}function ba(i){return Va(i,
oc)}function kc(i){return s(I(i[0]),z(i[1]))}function lc(i){return ja(s(Ga(i[0]),z(i[1])))}function tb(i,F){return B("digits","<-",Sb,F)(D,function(N){return ac(function(ea,Xb){return i*ea+bc(Hb(Xb))},0,N.digits)})}function dc(i,F,N){return vb(i,F,N)}function ec(i,F){return(F+c(Hb(i)))/10}function Wb(i){return i<0?1/Wb(-i):a(Math.pow(10,i))}function Vb(i){return t(B("fract","<-",Jc)("expo","<-",Ta,1,Cc)(D,function(F){return a(i+F.fract)*F.expo}),"<|>",B("expo","<-",Cc)(D,function(F){return a(i)*F.expo}))}
function Tb(i){return B("f","<-",Vb,i)(ia,qb.Right,"f")}function Ub(i){return t(g,"$",ja,B(Ga(i))(L,b.opLetter,"<?>","end of "+i))}function Lb(i){return fc(M(b.reservedOpNames),i)}function T(i){function F(ea){return!ea.length?z(null):s(ub(N(ea[0]),""+i),F(K(ea,1)))}function N(ea){return Qb(ea)?H(I(ea.toLowerCase()),I(ea.toUpperCase())):I(ea)}return b.caseSensitive?Ga(i):s(F(i),z(i))}function ya(i){return t(g,"$",ja,B(T(i))(L,b.identLetter,"<?>","end of "+i))}function fc(i,F){function N(ea){if(!ea.length)return false;
var Xb=sa(ea[0],F);return Xb.LT?N(K(ea,1)):Xb.EQ?true:Xb.GT?false:null}return N(i)}function jc(i){i=b.caseSensitive?i:i.toLowerCase();return fc(Kc,i)}if(!b.LanguageDef)throw"Type error: unexpected '"+b.constructor.name+"', expecting 'GenLanguageDef.LanguageDef'";var Mb=va(Y(Fa)),gc=B(ja(Ga(b.commentLine)))($a,Y(function(i){return i!="\n"}))(z,null),Q=Xa(K(b.commentEnd+b.commentStart)),Ac=t(s(ja(Ga(b.commentEnd)),z(null)),"<|>",s(va(pc(Q)),l),"<|>",s(Ha(Q),l),"<?>","end of comment"),Bc=t(s(ja(Ga(b.commentEnd)),
z(null)),"<|>",s(p,o),"<|>",s(va(pc(Q)),o),"<|>",s(Ha(Q),o),"<?>","end of comment");Q=b.nestedComments?Bc:Ac;var mc=s(ja(Ga(b.commentStart)),Q);Q=ma(b.commentLine);var Ia=ma(b.commentStart),zc=V(Q&&Ia?[$a,[Mb,"<?>",""]]:Q?[$a,[Mb,"<|>",mc,"<?>",""]]:Ia?[$a,[Mb,"<|>",gc,"<?>",""]]:[$a,[Mb,"<|>",gc,"<|>",mc,"<?>",""]]),oc=d(";"),nc=d(",");Mb=d(".");gc=d(":");Q=qa(K("abfnrtv\\\"'"),K("a\u0008\u000c\n\r\t\u000b\\\"'"));Ia=qa(["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","DLE","DC1","DC2","DC3","DC4",
"NAK","SYN","ETB","CAN","SUB","ESC","DEL"].concat(["BS","HT","LF","VT","FF","CR","SO","SI","EM","FS","GS","RS","US","SP"]),["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","SUB","ESC","DEL"].concat(["BS","HT","LF","VT","FF","CR","SO","SI","EM","FS","GS","RS","US","SP"]));Q=na(pa(kc,Q));var Qa=na(pa(lc,Ia));Ia=Y(function(i){return i!='"'&&i!="\\"&&i>"\u0016"});var wb=I("&"),Yb=B(Sb,qc)(I("\\"),"<?>","end of string gap"),xb=B("code","<-",dc,"<|>",
s(I("o"),tb(8,rc)),"<|>",s(I("x"),tb(16,sc)))(D(function(i){return toEnum(a(i.code))})),ab=B(I("^"))("code","<-",Dc)(D(function(i){return toEnum(fromEnum(i.code)-fromEnum("A"))}));Qa=t(Q,"<|>",xb,"<|>",Qa,"<|>",ab,"<?>","escape code");Q=s(I("\\"),Qa);xb=Y(function(i){return i!="'"&&i!="\\"&&i>"\u0016"});Q=t(xb,"<|>",Q,"<?>","literal character");Q=t(g,[ua,I("'"),[I("'"),"<?>","end of character"],Q],"<?>","character");wb=B(I("\\"))(s(Yb,z(Pa.Nothing)),"<|>",s(wb,z(Pa.Nothing)),"<|>",B("esc","<-",Qa)(ia,
Pa.Just,"esc"));Ia=t(B("c","<-",Ia)(ia,Pa.Just,"c"),"<|>",wb,"<?>","string character");Ia=t(g,[B("str","<-",ua,I('"'),[I('"'),"<?>","end of string"],[sb,Ia])(D,function(i){return Wa(f(Ea)(db,f(ha)),"",i.str)}),"<?>","literal string"]);var vb=tb(10,tc);wb=B(Ha,"xX")(tb,16,sc);Yb=B(Ha,"oO")(tb,8,rc);var Jc=t(B(I("."))("digits","<-",Sb,tc,"<?>","fraction")(D,function(i){return Wa(ec,0,i.digits)}),"<?>","fraction");Qa=t([I("-"),">>",z,cc],"<|>",[I("+"),">>",z,db],"<|>",z,db);var Cc=t(B(Ha,"eE")("f","<-",
Qa)("e","<-",vb,"<?>","exponent")(ia,Wb,"f","e"),"<?>","exponent");xb=B("n","<-",vb)(function(i,F,N){return Vb(i.n)(i,F,N)});ab=B("n","<-",vb)(function(i,F,N){return Ta(qb.Left(i.n),Tb(i.n))(i,F,N)});var bb=t(B("n","<-",wb,"<|>",Yb)(ia,qb.Left,"n"),"<|>",ab,"<|>",Tb(0),"<|>",z,qb.Left(0));ab=t(s(I("0"),bb),"<|>",ab);bb=t(B(I,"0")(wb,"<|>",Yb,"<|>",vb,"<|>",z,0),"<?>","");bb=H(bb,vb);var Zb=B("f","<-",g,Qa)("n","<-",bb)(D,function(i){return i.f(i.n)});Qa=t(g,ab,"<?>","number").resolve();xb=t(g,xb,
"<?>","float").resolve();ab=t(g,Zb,"<?>","integer").resolve();bb=t(g,bb,"<?>","natural").resolve();Zb=t(B("c","<-",b.opStart)("cs","<-",sb,b.opLetter)(ia,Rb,"c","cs"),"<?>","operator");Zb=t(g,"$",ja,B("name","<-",Zb)(function(i,F,N){return(Lb(i.name)?Z("reserved operator "+i.name):z(i.name))(i,F,N)}));var uc=t(B("c","<-",b.identStart)("cs","<-",sb,b.identLetter)(ia,Rb,"c","cs"),"<?>","identifier");uc=t(g,"$",ja,B("name","<-",uc)(function(i,F,N){return(jc(i.name)?Z("reserved word "+i.name):z(i.name))(i,
F,N)}));var Ec=M(b.reservedNames),Kc=b.caseSensitive?Ec:pa(function(i){return i.toLowerCase()},Ec);return W.TokenParser(m,{identifier:uc,reserved:ya,operator:Zb,reservedOp:Ub,charLiteral:Q,stringLiteral:Ia,natural:bb,integer:ab,float_:xb,naturalOrFloat:Qa,decimal:vb,hexadecimal:wb,octal:Yb,symbol:d,lexeme:g,whiteSpace:zc,parens:n,braces:q,angles:C,brackets:y,squares:y,semi:oc,comma:nc,colon:gc,dot:Mb,semiSep:X,semiSep1:ba,commaSep:G,commaSep1:O})}var f=NS.Haskell.curry,j=NS.Haskell.const_,r=NS.Haskell.isArray,
K=NS.Haskell.slice,pa=NS.Haskell.map,M=NS.Haskell.isort,ka=NS.Haskell.compose,fa=NS.Haskell.call,db=NS.Haskell.id,rb=NS.Haskell.flip,ha=NS.Haskell.cons,Rb=NS.Haskell.consJoin,cc=NS.Haskell.negate,ma=NS.Haskell.null_,Na=NS.Haskell.elem,Hb=NS.Haskell.digitToInt,La=NS.Haskell.extend,Ca=NS.Haskell.namespace,bc=NS.Haskell.toInteger,a=NS.Haskell.fromInteger,c=NS.Haskell.fromIntegral,h=NS.Haskell.evalThunks,k=NS.Haskell.data,m=NS.Haskell.record,u=NS.Haskell.instance,w=NS.Haskell.getInstance,R=NS.Haskell.operators,
E=NS.Haskell.infix,P=NS.Haskell.infixl,Da=NS.Haskell.infixr,V=NS.Haskell.resolve,oa=NS.Haskell.exl,Za=NS.Haskell.exs,xa=NS.Haskell.Scope,Pa=NS.Prelude.Maybe,qb=NS.Prelude.Either,Kb=NS.Prelude.Monad,ac=NS.Prelude.foldl,Wa=NS.Prelude.foldr,qa=NS.Prelude.zip,ra=NS.Prelude.replicate,Xa=NS.Prelude.nub,Ea=NS.Prelude.maybe,sa=NS.Prelude.compare,Fa=NS.Prelude.isSpace,Ya=NS.Prelude.isUpper,Jb=NS.Prelude.isLower,Qb=NS.Prelude.isAlpha,wa=NS.Prelude.isAlphaNum,za=NS.Prelude.isDigit,$b=NS.Prelude.isHexDigit,Lc=
NS.Prelude.isOctDigit,aa;ca.prototype={memoize:false,scrollTo:function(b){this.index=b;this.length=this.input.length-b;return this},scroll:function(b){this.index+=b;this.length-=b;return this},dropped:0,at:function(b){return this.input.charAt(this.index+b)},substring:function(b,d){return this.input.substring(b+this.index,(d||this.length)+this.index)},substr:function(b,d){return this.input.substring(b+this.index,d||this.length)},toString:function(){var b=this.substring(0);return"PS at "+this.index+
" "+(b.length?'"'+b+'"':"Empty")},getCached:function(b){if(this.memoize)if(b=this.cache[b])if(b=b[this.index]){this.index=b.index;this.length=b.length;return b}},putCached:function(b,d,g){if(!this.memoize)return false;g.index=this.index;g.length=this.length;var l=this.cache[b];l||(l=this.cache[b]={});l[d]=g},sourceLine:function(b){return(b=this.input.substring(0,b).match(/(\r\n)|\r|\n/g))?b.length:0}};var yc=J,ic=eb,Mc=ic,vc=0,hc=function(b,d){function g(l,o,p){return function(){return b(l,o,function(n){return n.success?
d(l,o,p):p(n)})}}g.constructor=v;return g},s=function(){function b(g,l,o){g=new xa(g);for(var p=1,n=d.length,q=d[0];p<n;++p)q=hc(q,d[p]);return q(g,l,o)}var d=pa(fb,arguments);b.constructor=v;return b},ia=ka(D,la),wc=hb,xc=zb,z=ib,Fc=z;ka=U;var Gc=hc,Nc=H,sb=Bb(false),Sb=Bb(true),ja=Sa(function(b,d,g,l){if(d.success)return d;g.scrollTo(l);return{ast:aa,success:false,expecting:d.expecting}}),$a=function(b){return Sa(function(d,g){return{ast:aa,success:g.success,expecting:g.expecting}})(sb(b),null)},
I=Ra(function(b,d){if(d.length>0&&d.at(0)==b){d.scroll(1);return{ast:b,success:true}}return{success:false,expecting:b}}),Y=Ra(function(b,d){var g=d.at(0);if(d.length>0&&b(g)){d.scroll(1);return{ast:g,success:true}}return{success:false,expecting:g}}),Ga=function(b){return Sa(function(d,g,l,o){d=g.ast.join("");return{ast:d.length?d:aa,success:g.success,expecting:g.success?aa:{at:o,expecting:b}}})(Ab(pa(I,b)),null)},ub=Sa(function(b,d,g,l){return d.success?d:{ast:d.ast,success:false,expecting:{at:l,
expecting:b}}}),Oc=Ra(function(b,d){if(typeof b=="string")if(d.substring(0,b.length)==b){d.scroll(b.length);return{ast:b,success:true}}else return{success:false,expecting:b};else if(b.exec){var g=new RegExp("^"+b.source),l=d.substring(0);g=(g=(g=g.exec(l))&&g[0])&&g.length;l=l.substr(0,g);if(g){d.scroll(g);return{ast:l,success:true}}else return{success:false,expecting:b.source}}});La(R,{"<-":{func:A,fixity:Da(-1)},">>=":{func:ta,fixity:P(1)},"=<<":{func:rb(ta),fixity:Da(1)},">>":{func:Gc,fixity:P(1)},
"*>":{func:Gc,fixity:P(4)},"<*":{func:lb,fixity:P(4)},"<$>":{func:ka,fixity:P(4)},"<*>":{func:jb,fixity:P(4)},"<**>":{func:f(kb)(rb(fa)),fixity:P(4)},"<$":{func:function(b,d){return lb(Fc(value),d)},fixity:P(4)},"<|>":{func:H,fixity:Da(1)},"<?>":{func:ub,fixity:E(0)}});u(Kb,v,function(){return{">>=":ta,">>":hc,do_:s,return_:ib,fail:J,run:yb,do$:function(){function b(p,n,q){return l(p,n,q)}function d(p,n,q){if(o||p instanceof xa)return(o?l:d.resolve())(p,n,q);g.push(V(arguments,b));return d}var g=
[],l,o;g.push(V(arguments,b));d.resolve=function(){if(o)return l;l=s.apply(null,g);o=true;g=null;return l};d.CallStream=true;d.constructor=v;return d}}});var B=w(Kb,v).do$,t=oa(v);Ca("Text_Parsec_Prim",{sequence:Db,run:yb,Parser:v,ParseState:ca,ps:cb,toParser:fb,unexpected:Z,parsecMap:ka,fmap:ka,liftM:U,liftM2:kb,liftM3:Ja,liftA:ka,liftA2:kb,liftA3:Ja,ap:jb,parserBind:ta,parserReturn:ib,return_:z,pure:Fc,parserFail:J,fail:yc,parserZero:eb,mzero:ic,empty:Mc,parserPlus:H,parserPlusN:Nb,mplus:Nc,do_:s,
do$:B,do2:hc,bind:A,ret:D,withBound:la,returnCall:ia,getPosition:hb,setPosition:zb,getParserState:wc,setParserState:xc,tokens:Ab,many:sb,many1:Sb,string:Ga,char_:I,satisfy:Y,label:ub,try_:ja,skipMany:$a,match:Oc,withScope:Cb,ex:t});Ca("Text_Parsec_Combinator",{choice:na,count:Ob,between:ua,option:Ta,optionMaybe:Eb,optional:Ua,skipMany1:va,sepBy:Ka,sepBy1:Va,endBy:nb,endBy1:mb,sepEndBy:Aa,sepEndBy1:Fb,chainl:pb,chainl1:Gb,chainr:ob,chainr1:Ma,eof:Oa,notFollowedBy:L,manyTill:Ib,lookAhead:Pb,anyToken:$});
k(Ba,["AssocNone","AssocLeft","AssocRight"]);k(da,[["Infix",v,Ba],["Prefix",v],["Postfix",v]]);Ca("Text_Parsec_Expr",{Assoc:Ba,Operator:da,buildExpressionParser:S});var Ha=function(b){return ub(Y(function(d){return Na(d,b)}),"oneOf("+b+")")},pc=function(b){return ub(Y(function(d){return!Na(d,b)}),"noneOf("+b+")")},qc=t(Y,Fa,"<?>","space").resolve();fa=t($a,qc,"<?>","white space").resolve();rb=t(I,"\n","<?>","new-line").resolve();La=t(I,"\t","<?>","tab").resolve();var Dc=t(Y,Ya,"<?>","uppercase letter").resolve();
Jb=t(Y,Jb,"<?>","lowercase letter").resolve();wa=t(Y,wa,"<?>","letter or digit").resolve();Ya=t(Y,Qb,"<?>","letter").resolve();var tc=t(Y,za,"<?>","digit").resolve(),sc=t(Y,$b,"<?>","hexadecimal digit").resolve(),rc=t(Y,Lc,"<?>","octal digit").resolve();j=t(Y,j(true)).resolve();Ca("Text_Parsec_Char",{oneOf:Ha,noneOf:pc,space:qc,spaces:fa,newline:rb,tab:La,upper:Dc,lower:Jb,alphaNum:wa,letter:Ya,digit:tc,hexDigit:sc,octDigit:rc,anyChar:j});k(ga,[["LanguageDef",{commentStart:String,commentEnd:String,
commentLine:String,nestedComments:Boolean,identStart:v,identLetter:v,opStart:v,opLetter:v,reservedNames:Array,reservedOpNames:Array,caseSensitive:Boolean}]]);k(W,[["TokenParser",{identifier:v,reserved:Function,operator:v,reservedOp:Function,charLiteral:v,stringLiteral:v,natural:v,integer:v,float_:v,naturalOrFloat:v,decimal:v,hexadecimal:v,octal:v,symbol:Function,lexeme:Function,whiteSpace:v,parens:Function,braces:Function,angles:Function,brackets:Function,squares:Function,semi:v,comma:v,colon:v,dot:v,
semiSep:Function,semiSep1:Function,commaSep:Function,commaSep1:Function}]]);Ca("Text_Parsec_Token",{GenLanguageDef:ga,GenTokenParser:W,makeTokenParser:e});za=Ha(":!#$%&*+./<=>?@\\^|-~");k=ga.LanguageDef(m,{commentStart:"",commentEnd:"",commentLine:"",nestedComments:true,identStart:Za(Ya,"<|>",I("_")),identLetter:Za(wa,"<|>",Ha("_'")),opStart:za,opLetter:za,reservedOpNames:[],reservedNames:[],caseSensitive:true});j=ga.LanguageDef(m,{commentStart:"{-",commentEnd:"-}",commentLine:"--",nestedComments:true,
identStart:Ya,identLetter:t(wa,"<|>",Ha,"_'").resolve(),opStart:za,opLetter:za,reservedOpNames:[],reservedNames:[],caseSensitive:true});za=ga.LanguageDef(m,{commentStart:"/*",commentEnd:"*/",commentLine:"//",nestedComments:true,identStart:Ya,identLetter:Za(wa,"<|>",Ha,"_'"),opStart:za,opLetter:za,reservedOpNames:[],reservedNames:[],caseSensitive:false});$b=j.update({reservedOpNames:["::","..","=","\\","|","<-","->","@","~","=>"],reservedNames:["let","in","case","of","if","then","else","data","type",
"class","default","deriving","do","import","infix","infixl","infixr","instance","module","newtype","where","primitive"]});var Hc=$b.update({identLetter:Za($b.identLetter,"<|>",I("#")),reservedNames:$b.reservedNames.concat(["foreign","import","export","primitive","_ccall_","_casm_","forall"])}),Ic=za.update({reservedNames:["case","class","default","extends","import","in","let","new","of","package"],caseSensitive:true});Ca("Text_Parsec_Language",{emptyDef:k,haskellStyle:j,javaStyle:za,haskellDef:Hc,
mondrianDef:Ic,getHaskell:function(){return e(Hc)},getMondrian:function(){return e(Ic)}})})();(function(){namespace("Text_Parsec");importSubmodules("Text_Parsec",["Prim","Char","Combinator","Token","Language","Expr"])})()})();
